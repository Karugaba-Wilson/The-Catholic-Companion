<!-- Auto-deploy test -->
<p>Firebase auto-deploy is working!</p>
<!DOCTYPE html>
<html lang="en" class=""> <!-- NEW: class for dark mode -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Catholic Companion</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-primary: #1C3A5A; /* Deep Navy Blue */
            --color-secondary: #FFD700; /* Gold */
            --color-bg: #F4F7F9; /* Off-White Background */
            --color-text-primary: #1C3A5A;
            --color-text-secondary: #4b5563; /* gray-600 */
            --color-card-bg: #ffffff;
            --color-border: #e5e7eb; /* gray-200 */
        }
        /* NEW: Dark mode overrides for better readability */
        html.dark .mass-section {
            border-top-color: var(--color-primary);
        }
        html.dark .mass-section-title {
            color: var(--color-primary);
        }
        html.dark {
            --color-primary: #A8C7FA; /* Light Blue for dark mode */
            --color-secondary: #FFD700; /* Gold */
            --color-bg: #111827; /* gray-900 */
            --color-text-primary: #F9FAFB; /* gray-50 */
            --color-text-secondary: #9CA3AF; /* gray-400 */
            --color-card-bg: #1F2937; /* gray-800 */
            --color-border: #374151; /* gray-700 */
        }
        html.dark .settings-modal-content,
        html.dark .auth-modal-content {
            background-color: var(--color-card-bg);
            border: 1px solid var(--color-border);
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        /* SECTION 1: Header/Navigation Styles */
        .nav-link {
            transition: all 0.2s;
            padding-left: 0.75rem;
            padding-right: 0.75rem;
        }
        .nav-link:hover {
            color: var(--color-text-primary);
            background-color: #f0f4f7;
        }
        /* NEW: Style for when the dropdown is open */
        .nav-link.open {
            background-color: #e5e7eb; /* gray-200 */
        }
        .nav-link.active {
            border-bottom: 3px solid var(--color-secondary);
            color: var(--color-text-primary);
        }
        .color-circle {
            display: inline-block;
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 50%;
            margin-left: 0.5rem;
            box-shadow: 0 0 3px rgba(0,0,0,0.3);
        }
        /* Liturgical Colors */
        .color-green { background-color: #38a169; }
        .color-red { background-color: #e53e3e; }
        .color-white { background-color: #ffffff; border: 1px solid #ddd; } 
        .color-violet { background-color: #7c3aed; }
        
        /* SECTION 2: Content Truncation & Sidebar Styles */
        .content-container {
            /* Fixed height for content preview on home page */
            max-height: 120px; 
            overflow: hidden;
            position: relative;
        }
        /* Fade effect for truncated content */
        .content-container::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px; /* Height of the fade */
            background: linear-gradient(to top, var(--color-bg), rgba(244, 247, 249, 0)); /* Matches var(--color-bg) */
            pointer-events: none;
        }
        .sidebar-link {
            cursor: pointer;
            transition: background-color 0.15s;
        }
        .sidebar-link:hover, .prayer-link-item:hover {
            color: #1e40af; /* blue-700 equivalent */
            background-color: #e5e7eb; /* gray-200 equivalent */
        }

        /* NEW Styles for Rosary Mystery Modal */
        #mystery-modal {
            position: fixed;
            inset: 0;
            z-index: 5000;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease-in-out, visibility 0.2s;
        }
        #mystery-modal.show {
            opacity: 1;
            visibility: visible;
        }
        #mystery-modal-content {
            background-color: var(--color-card-bg);
            padding: 1.5rem; /* p-6 */
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-lg */
            width: 90%;
            max-width: 500px;
            transform: scale(0.95);
            transition: transform 0.2s ease-in-out;
        }
        #mystery-modal.show #mystery-modal-content {
            transform: scale(1);
        }

        /* NEW Styles for Full-Screen Rosary Player */
        #rosary-player-modal {
            position: fixed;
            inset: 0;
            z-index: 6000; /* Higher than the mystery modal */
            background-color: var(--color-bg);
            display: flex;
            flex-direction: column;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out;
        }
        #rosary-player-modal.show {
            opacity: 1;
            visibility: visible;
        }

        /* NEW SVG Rosary Styles */
        .rosary-svg-container {
            flex-shrink: 0;
            padding: 0.5rem 1rem;
            text-align: center;
        }
        .rosary-svg {
            width: 100%;
            max-width: 380px;
            height: auto;
            margin: 0 auto;
        }
        .rosary-svg .bead {
            fill: #D1D5DB; /* gray-300 */
            stroke: #6B7280; /* gray-500 */
            stroke-width: 1;
            transition: all 0.2s ease-in-out;
            transform-origin: center center;
        }
        .rosary-svg .bead.active {
            fill: var(--color-primary);
            stroke: var(--color-primary-hover, #1a2c47);
            transform: scale(1.15);
            -webkit-transform: scale(1.15);
        }
        .rosary-svg .cross {
            fill: #9CA3AF; /* gray-400 */
            stroke: #4B5563; /* gray-600 */
            stroke-width: 1;
            transition: all 0.2s ease-in-out;
            transform-origin: center center;
        }
        .rosary-svg .cross.active {
            fill: var(--color-primary);
            stroke: var(--color-primary-hover, #1a2c47);
            transform: scale(1.1);
            -webkit-transform: scale(1.1);
        }
        .rosary-svg .centerpiece {
            fill: #9CA3AF; /* gray-400 */
            stroke: #4B5563; /* gray-600 */
            stroke-width: 1;
        }
        .rosary-svg .chain {
            fill: none;
            stroke: #B0B0B0;
            stroke-width: 0.5;
        }

        /* NEW Styles for Rosary Navigation Modal */
        #rosary-nav-modal {
            position: fixed;
            inset: 0;
            z-index: 7000; /* Higher than player modal */
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease-in-out, visibility 0.2s;
        }
        #rosary-nav-modal.show {
            opacity: 1;
            visibility: visible;
        }
        #rosary-nav-modal-content {
            transform: scale(1);
        }
        .rosary-nav-link {
            display: block;
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            transition: background-color 0.15s;
            cursor: pointer;
            font-size: 0.875rem;
            color: #374151; /* gray-700 */
        } 
        .prayer-link-item:hover {
            background-color: #f3f4f6; /* gray-100 */
            color: var(--color-primary);
        }
        .rosary-nav-link.active {
            background-color: #dbeafe; /* blue-100 */
            color: #1d4ed8; /* blue-700 */
            font-weight: 600;
        }

        /* NEW Styles for "More" Dropdown */
        .dropdown-link {
            display: block;
            padding: 0.5rem 0.75rem; /* 8px 12px */
            border-radius: 0.375rem; /* rounded-md */
            transition: background-color 0.15s;
        }
        .dropdown-link:hover {
            background-color: #f3f4f6; /* gray-100 */
        }
        /* NEW: Scrollable Dropdown */
        .dropdown-scrollable {
            max-height: 70vh; /* 70% of the viewport height */
            overflow-y: auto;
        }

        /* NEW Styles for User Dropdown */
        .user-dropdown-link {
            display: flex;
            align-items: center;
            padding: 0.5rem 0.75rem; /* 8px 12px */
            border-radius: 0.375rem; /* rounded-md */
            transition: background-color 0.15s;
            font-size: 0.875rem; /* text-sm */
            color: #374151; /* gray-700 */
            cursor: pointer;
        }
        .user-dropdown-link:hover {
            background-color: #f3f4f6; /* gray-100 */
            color: var(--color-primary);
        }
        .user-dropdown-link svg {
            margin-right: 0.75rem; /* mr-3 */
        }
        
        /* NEW Styles for Order of Mass Page */
        .mass-section {
            background-color: var(--color-card-bg);
            padding: 1.5rem; /* p-6 */
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* shadow-lg */
            border-top: 4px solid #0284c7; /* border-sky-600 */
        }
        .mass-section-title {
            font-size: 1.5rem; /* text-2xl */ 
            font-weight: 700; /* font-bold */
            color: #0369a1; /* text-sky-700 */
            margin-bottom: 1rem; /* mb-4 */
            border-bottom: 1px solid var(--color-border);
            padding-bottom: 0.5rem; /* pb-2 */
        }
        .mass-prayer-body {
            font-size: 1rem; /* text-base */
            color: var(--color-text-secondary);
            line-height: 1.625; /* leading-relaxed */
        }
        .mass-prayer-body p {
            margin-bottom: 0.75rem;
        }
        .mass-prayer-title {
            font-size: 1.125rem; /* text-lg */
            font-weight: 600; /* font-semibold */ 
            color: var(--color-text-primary);
            margin-bottom: 0.5rem; /* mb-2 */
        }
        .mass-prayer-text {
            font-style: italic; 
            color: #4b5563; /* text-gray-600 */
            padding-left: 1rem;
            border-left: 3px solid #e0f2fe; /* sky-100 */
        }

        /* NEW Styles for Saints Page */
        .saints-header-controls {
            background-color: #f9fafb; /* gray-50 */
            padding: 0.75rem 1rem;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 2px 4px rgba(0,0,0,0.05); 
            border: 1px solid #e5e7eb; /* gray-200 */
        }
        .saints-control-btn {
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem; /* rounded-lg */
            transition: all 0.2s;
            color: #4b5563; /* gray-600 */
        }
        .saints-control-btn:hover {
            background-color: #e5e7eb; /* gray-200 */
            color: var(--color-primary);
        }
        .saints-control-btn.active {
            background-color: var(--color-primary);
            color: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .saint-card {
            background-color: var(--color-card-bg);
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            overflow: hidden;
            transition: all 0.2s ease-in-out; 
            border: 1px solid #e5e7eb; /* gray-200 */
        }
        .saint-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
        }
        .saint-card-img {
            width: 100%;
            object-fit: cover;
            background-color: #e5e7eb; /* gray-200 */
        }
        .saint-card-bio {
            display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;
        }

        /* NEW Styles for Devotion/Prayer Links */
        .devotion-link-item, .prayer-link-item {
            display: block;
            padding: 0.75rem 1rem;
            background-color: var(--color-card-bg);
            border: 1px solid var(--color-border);
            border-radius: 0.5rem; /* rounded-lg */
            color: var(--color-text-secondary);
            font-weight: 500; /* font-medium */
            transition: all 0.15s ease-in-out;
            cursor: pointer;
            text-align: left;
        }
        .devotion-link-item:hover, .prayer-link-item:hover {
            background-color: #f3f4f6; /* gray-100 */
            color: var(--color-text-primary);
            border-color: #d1d5db; /* gray-300 */
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); /* shadow */
            transform: translateY(-1px);
        }

        /* NEW Styles for Prayer Text Modal */
        #prayer-modal {
            position: fixed;
            inset: 0;
            z-index: 5500; /* Between mystery and rosary player */
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease-in-out, visibility 0.2s;
        }
        #prayer-modal.show {
            opacity: 1;
            visibility: visible;
        }
        #prayer-modal-content {
            background-color: var(--color-card-bg);
            padding: 1.5rem; /* p-6 */
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-lg */
            width: 90%;
            max-width: 600px; /* A bit wider for text */
            transform: scale(0.95);
            transition: transform 0.2s ease-in-out;
        }
        #prayer-modal.show #prayer-modal-content {
            transform: scale(1);
        }

        /* NEW Styles for Generic Settings Modal */
        .settings-modal {
            position: fixed;
            inset: 0;
            z-index: 9000;
            background-color: rgba(0, 0, 0, 0.5);
            display: none; /* Hidden by default, shown with JS */
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
        }
        .settings-modal.show {
            display: flex;
            opacity: 1;
        }
        .settings-modal-content {
            background-color: var(--color-bg);
            padding: 0; /* No padding on the container */
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-lg */
            width: 90%;
            max-width: 650px;
            transform: scale(0.95);
            transition: transform 0.2s ease-in-out;
            display: flex;
            flex-direction: column;
            max-height: 90vh;
        }
        .settings-modal.show .settings-modal-content {
            transform: scale(1);
        }



        /* NEW Styles for Global Audio Player */
        #global-audio-player {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 9000;
            background-color: #1f2937; /* gray-800 */
            padding: 0.75rem 1rem;
            box-shadow: 0 -4px 10px rgba(0,0,0,0.3);
            display: none; /* Hidden by default */
            align-items: center;
            gap: 0.75rem;
        }
        #global-audio-player audio {
            width: 100%;
            flex-grow: 1;
        }

        /* NEW Styles for Post-Content Section (Home Calendar & Quick Actions) */
        .action-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            background-color: var(--color-card-bg);
            border: 1px solid var(--color-border);
            border-radius: 0.75rem; /* rounded-xl */
            text-align: center;
            font-weight: 600;
            color: var(--color-text-primary);
            transition: all 0.2s ease-in-out; 
        }
        .action-button:hover {
            background-color: #f0f4f7;
            border-color: #d1d5db; /* gray-300 */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transform: translateY(-2px);
        }
        .action-button svg {
            width: 2rem; /* w-8 */
            height: 2rem; /* h-8 */
            margin-bottom: 0.5rem; /* mb-2 */
        }

        /* NEW: Login/Signup Modal Styles */
        .auth-modal {
            position: fixed; inset: 0; z-index: 9500;
            background-color: rgba(0, 0, 0, 0.5);
            display: none; align-items: center; justify-content: center;
            opacity: 0; transition: opacity 0.2s ease-in-out;
        }
        .auth-modal.show { display: flex; opacity: 1; }
        .auth-modal-content {
            background-color: var(--color-card-bg);
            padding: 1.5rem; border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
            width: 90%; max-width: 450px;
            transform: scale(0.95); transition: transform 0.2s ease-in-out;
        }
        .auth-modal.show .auth-modal-content { transform: scale(1); }
        .auth-input {
            width: 100%; padding: 0.5rem 0.75rem;
            border: 1px solid var(--color-border);
            border-radius: 0.375rem;
            background-color: var(--color-bg);
            color: var(--color-text-primary);
        }

    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Section One: Header Title and Date (Scrollable) -->
    <header id="scrollable-header" class="bg-white shadow-sm" style="background-color: var(--color-card-bg);">
        
        <!-- Title and Notifications -->
        <div class="p-4 pb-1 md:p-6 md:pb-1 border-b border-gray-100 flex justify-between items-center gap-4" style="background-color: var(--color-card-bg); border-color: var(--color-border);">
            <div class="container mx-auto text-center">
                <a href="#" onclick="switchPage('home'); return false;" class="flex justify-center items-center gap-3 cursor-pointer">
                    <!-- NEW: SVG Logo -->
                    <svg id="logo" class="w-10 h-10 sm:w-12 sm:h-12 text-sky-700" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 16.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L11 17.07V18.93zM17.96 15.5c-.23.64-.53 1.25-.9 1.79l-5.18-5.18 6.52-1.55c.31.8.46 1.65.46 2.52 0 1.03-.27 2-.7 2.86zm-6.09-8.33l5.18 5.18c.37-.54.67-1.15.9-1.79l-6.52 1.55c-.31-.8-.46-1.65-.46-2.52 0-1.03.27-2 .7-2.86zM12 4.07c3.95.49 7 3.85 7 7.93 0 .62-.08 1.21-.21 1.79L12 6.93V4.07z"/>
                    </svg>
                    <span class="text-3xl sm:text-4xl font-extrabold leading-tight" style="color: var(--color-text-primary);">The Catholic Companion</span>
                </a>
                <p class="text-xs sm:text-sm font-medium text-gray-500 tracking-wider mt-1">Your daily guidance for prayer and devotion</p>
            </div>
            
            <!-- Notifications Button -->
            <button aria-label="Notifications" onclick="toggleNotificationsPanel()" class="flex-shrink-0 p-3 transition duration-150 text-gray-600 hover:text-red-700 relative">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg>
                <span id="notification-badge" class="absolute top-1 right-1 inline-flex items-center justify-center px-2 py-0.5 text-xs font-semibold leading-none text-red-100 transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full" style="display: none;"></span>
            </button>
        </div>

        <!-- NEW: Notifications Panel -->
        <div id="notifications-panel" class="absolute top-20 right-4 sm:right-8 z-[8000] w-80 bg-white rounded-lg shadow-2xl border border-gray-200 hidden" style="background-color: var(--color-card-bg); border-color: var(--color-border);">
            <!-- Panel content will be injected by JavaScript -->
        </div>

        <!-- Date and Liturgical Details Block (Scrollable) -->
        <!-- MOVED: This block is now below the navigation bar -->
    </header>

    <!-- Navigation Bar (MOVED OUTSIDE of header to be properly sticky) -->
    <nav class="sticky top-0 z-40 flex items-stretch justify-center border-b border-gray-200 w-full bg-white shadow-lg" style="background-color: var(--color-card-bg); border-color: var(--color-border);">
        <div class="flex flex-wrap flex-grow justify-around items-center w-full px-2">
            <button class="nav-link py-3 px-3 sm:px-4 text-sm sm:text-base font-semibold whitespace-nowrap text-center active" data-page="home" onclick="switchPage('home')">Home</button> <!-- NEW: Added flex-wrap -->
            <button class="nav-link py-3 px-3 sm:px-4 text-sm sm:text-base font-semibold whitespace-nowrap" data-page="reflections" onclick="switchPage('reflections')">Reflections</button>
            <button class="nav-link py-3 px-3 sm:px-4 text-sm sm:text-base font-semibold whitespace-nowrap" data-page="readings" onclick="switchPage('readings')">Readings</button>
            <button class="nav-link py-3 px-3 sm:px-4 text-sm sm:text-base font-semibold whitespace-nowrap" data-page="devotions" onclick="switchPage('devotions')">Devotions</button>
            <button class="nav-link py-3 px-3 sm:px-4 text-sm sm:text-base font-semibold whitespace-nowrap" data-page="novenas" onclick="switchPage('novenas')">Novenas</button>
            <button class="nav-link py-3 px-3 sm:px-4 text-sm sm:text-base font-semibold whitespace-nowrap" data-page="prayers" onclick="switchPage('prayers')">Prayers</button>
            <button class="nav-link py-3 px-3 sm:px-4 text-sm sm:text-base font-semibold whitespace-nowrap" data-page="saints" onclick="switchPage('saints')">Saints</button>
            
            <!-- NEW: "More" Button with Dropdown -->
            <div class="relative group">
                <!-- This button now just acts as the hover target -->
                <button class="nav-link py-3 px-3 sm:px-4 text-sm sm:text-base font-semibold whitespace-nowrap flex items-center" data-page="more" onclick="switchPage('more')">
                    More
                    <!-- Add a small caret icon -->
                    <svg class="w-4 h-4 inline-block ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <!-- The Dropdown Menu -->
                <div class="absolute z-50 left-1/2 transform -translate-x-1/2 mt-0 w-64 bg-white rounded-lg shadow-xl hidden group-hover:block transition-all duration-150 ease-in-out opacity-0 group-hover:opacity-100 scale-95 group-hover:scale-100" style="background-color: var(--color-card-bg);">
                    <div class="p-2 space-y-1 dropdown-scrollable">
                        <!-- NEW: Direct list of links -->
                        <a href="#" onclick="currentlyLoadedDate = new Date(); switchPage('ordermass'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13M3.25 9.75h17.5M3.25 15.75h17.5"></path></svg>
                            Mass Today
                        </a>
                        <a href="#" onclick="switchPage('ordermass_general'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 3l-5 5-5-5"></path></svg>
                            Order of Mass
                        </a>
                        <a href="#" onclick="showToast('Liturgy of the Hours is coming soon!'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            Liturgy of the Hours
                        </a>
                        <a href="#" onclick="switchPage('liturgical_calendar'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                            Liturgical Calendar
                        </a>
                        <a href="#" onclick="switchPage('christian_art'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l-1-1m5.293-5.293a1 1 0 010 1.414L15 14.414m-2.586-2.586a2 2 0 00-2.828 0L4 16"></path></svg>
                            Christian Art
                        </a>
                        <a href="#" onclick="showToast('Spiritual Reading is coming soon!'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-12v4m-2-2h4m5 10v4m-2-2h4"></path></svg>
                            Spiritual Reading
                        </a>
                        <a href="#" onclick="showToast('Catechism is coming soon!'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l-4 4-4-4M6 16l-4-4 4-4"></path></svg>
                            Catechism
                        </a>
                        <!-- NEW LINK -->
                        <a href="#" onclick="switchPage('doctrine_summary'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path></svg>
                            Summary of Christian Doctrine
                        </a>
                        <!-- NEW LINK -->
                        <a href="#" onclick="switchPage('litanies'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3"></path></svg>
                            Treasury of Litanies
                        </a>
                        <a href="#" onclick="switchPage('articles'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                            Articles
                        </a>
                        <a href="#" onclick="switchPage('books_encyclicals'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13M3.25 9.75h17.5M3.25 15.75h17.5"></path></svg>
                            Books & Encyclicals
                        </a>
                        <a href="#" onclick="switchPage('popes'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                            Popes
                        </a>
                        <a href="#" onclick="switchPage('vocation'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.539 1.118l-3.975-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.196-1.539-1.118l1.518-4.674a1 1 0 00-.363-1.118L2.05 10.1c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg>
                            Vocation Promotion
                        </a>
                        <a href="#" onclick="switchPage('news'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 12h6m-3-4h3"></path></svg>
                            News
                        </a>
                        <a href="#" onclick="showToast('Monthly Quiz is coming soon!'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>
                            Monthly Quiz
                        </a>
                         <a href="#" onclick="showToast('Question & Answer is coming soon!'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.79 4 4 0 1.933-1.566 3.5-3.5 3.5a1.5 1.5 0 01-1.5-1.5c0-.966.6-1.811 1.5-2.206l-1.667-3.293zM12 18.75A1.25 1.25 0 1012 21.25a1.25 1.25 0 000-2.5z"></path></svg>
                            Question & Answer
                        </a>
                        <a href="#" onclick="showToast('Other Resources are coming soon!'); return false;" class="dropdown-link flex items-center font-medium text-gray-700">
                            <svg class="w-5 h-5 mr-2 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            Other Resources
                        </a>
                        
                        <div class="border-t my-1"></div>
                        <!-- A link to the main 'more' page -->
                        <a href="#" onclick="switchPage('more'); return false;" class="dropdown-link text-center">
                            <span class="font-semibold text-gray-700 text-sm">View All Resources</span>
                        </a>
                    </div>
                </div>
            </div>

            <button class="nav-link py-3 px-3 sm:px-4 text-sm sm:text-base font-semibold whitespace-nowrap" data-page="about" onclick="switchPage('about')">About</button>

            <!-- NEW: User Account Dropdown (MOVED INSIDE) -->
            <div id="user-account-area" class="relative">
                <button id="user-dropdown-button" aria-label="User Account and Settings" onclick="toggleUserDropdown()" class="nav-link py-3 px-3 sm:px-4 text-sm sm:text-base font-semibold whitespace-nowrap flex items-center">
                    <!-- User avatar will be dynamically inserted here -->
                    <img id="user-avatar-nav" src="https://www.gravatar.com/avatar/default?d=mp" alt="User Avatar" class="w-6 h-6 rounded-full mr-2">
                    <span id="user-name-nav">Wilson K.</span>
                </button>
                <!-- The User Dropdown Menu -->
                <div id="user-dropdown-menu" class="absolute z-50 right-0 mt-2 w-64 bg-white rounded-lg shadow-xl hidden transition-all duration-150 ease-in-out" style="background-color: var(--color-card-bg);">
                    <div class="p-2 space-y-1">
                        <div class="px-2 py-2">
                            <p id="user-dropdown-name" class="text-sm font-semibold text-gray-800">Wilson Karugaba</p>
                            <p id="user-dropdown-email" class="text-xs text-gray-500 truncate">fr.wilson.karugaba@email.com</p>
                        </div>
                        <div class="border-t my-1"></div>
                        <!-- NEW: Favourite Links -->
                        <a href="#" onclick="switchPage('my_prayers'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg> My Favourite Prayers</a>
                        <a href="#" onclick="switchPage('my_saints'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.539 1.118l-3.975-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.196-1.539-1.118l1.518-4.674a1 1 0 00-.363-1.118L2.05 10.1c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg> My Favourite Saints</a>
                        <a href="#" onclick="switchPage('my_requests'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a2 2 0 01-2-2V10a2 2 0 012-2h8z"></path></svg> My Prayer Requests</a>
                        <div class="border-t my-1"></div>
                        <!-- END NEW -->
                        <a href="#" onclick="openSettingsModal('profile-settings-modal'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> Profile Settings</a>
                        <a href="#" onclick="openSettingsModal('account-security-modal'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg> Account & Security</a>
                        <a href="#" onclick="openSettingsModal('email-preferences-modal'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg> Email Preferences</a>
                        <a href="#" onclick="openSettingsModal('appearance-modal'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg> Appearance</a>
                        <a href="#" onclick="openSettingsModal('notifications-modal'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 00-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg> Reminders & Notifications</a>
                        <a href="#" onclick="openSettingsModal('content-layout-modal'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path></svg> Content & Layout</a>
                        <!-- NEW: Admin Dashboard Link -->
                        <a id="admin-dashboard-link" href="#" onclick="switchPage('admin_dashboard'); return false;" class="user-dropdown-link" style="display: none;"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2a4 4 0 00-4-4H3V7h2a4 4 0 004-4V3a2 2 0 012-2h2a2 2 0 012 2v2a4 4 0 004 4h2v4h-2a4 4 0 00-4 4v2a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg> Admin Dashboard</a>
                        <div class="border-t my-1"></div>
                        <a href="#" onclick="handleSignOut()" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg> Sign Out</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- NEW POSITION: Date and Liturgical Details Block -->
    <div id="date-liturgy-block" class="mt-0 w-full px-4 py-2 text-center font-medium text-gray-700 bg-gray-100 border-b border-gray-200" style="background-color: var(--color-bg); border-color: var(--color-border); color: var(--color-text-secondary);">
        <p id="date-of-day" class="font-bold text-gray-800 text-lg"></p>
        <div id="liturgical-details" class="mt-1 text-sm text-gray-600">
            <!-- Liturgical details are injected here by JavaScript -->
        </div>
    </div>


    <!-- Section Two: Main Content Area -->
    <main id="page-content" class="flex-grow container mx-auto p-4 md:p-8">
        
        <!-- Main Content Grid: This div holds the layout for either Home (grid) or Full Page (single column) -->
        <div id="main-content-grid" class="grid gap-6 md:grid-cols-4 grid-home">

            <!-- LEFT COLUMN (Main Content - 75% on Desktop or 100% on Full-Page View) -->
            <div id="left-column" class="md:col-span-3 space-y-6">

                <!-- 1. Today's Reflection (Redesigned for Home View) -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-violet-600" style="background-color: var(--color-card-bg);">
                    <div class="text-center mb-4">
                        <h2 class="text-xl font-semibold text-gray-800">Today's Reflection</h2>
                        <div id="reflection-home-title" class="text-2xl font-bold mt-1 text-violet-700">
                            <!-- Reflection Title goes here -->
                        </div>
                    </div>
                    <div id="reflection-content" class="content-container mt-3 text-gray-600 leading-relaxed text-base">
                        <p id="reflection-text">
                            <!-- Two lines of content will be injected here -->
                        </p>
                    </div>
                    <div class="mt-4 border-t pt-4 text-center">
                        <a href="#" onclick="switchPage('reflections'); return false;" class="text-sm font-semibold text-violet-600 hover:text-violet-700 cursor-pointer transition duration-150">
                            Read More
                        </a>
                    </div>
                </section>

                <!-- 2. Today's Readings -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-amber-600" style="background-color: var(--color-card-bg);">
                    <h2 class="text-2xl font-semibold text-gray-800 flex items-center justify-between">
                        Today's Readings
                    </h2>
                    <div id="readings-content" class="content-container mt-3 text-gray-600 leading-relaxed">
                        <!-- Readings are injected here -->
                    </div>
                    <div class="mt-4 border-t pt-4">
                        <a href="#" onclick="switchPage('readings'); return false;" class="text-sm font-semibold text-amber-600 hover:text-amber-700 cursor-pointer transition duration-150">
                            View All Readings for Today
                        </a>
                    </div>
                </section>

                <!-- 3. Mass Today (Now points to the 'More' tab) -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-sky-600" style="background-color: var(--color-card-bg);">
                    <h2 class="text-2xl font-semibold text-gray-800 flex items-center justify-between" id="mass-today-title">
                        Mass Today
                    </h2>
                    <div id="mass-content" class="content-container mt-3 text-gray-600 leading-relaxed">
                        <p id="mass-prayers-summary">
                            <!-- Summary of prayers/order injected here -->
                        </p>
                    </div>
                    <div class="mt-4 border-t pt-4 space-y-2">
                        <!-- This link takes the user to the 'More' tab where Mass is fully implemented -->
                        <a href="#" onclick="currentlyLoadedDate = new Date(); switchPage('ordermass'); return false;" class="text-sm font-semibold text-sky-600 hover:text-sky-700 cursor-pointer transition duration-150 block">
                            View Full Order of Mass for Today
                        </a>
                    </div>
                </section>

                <!-- 4. Daily Verse (One element, clearly displayed) -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-emerald-600" style="background-color: var(--color-card-bg);">
                    <h2 class="text-2xl font-semibold text-gray-800">Daily Verse</h2>
                    <div class="mt-3 text-gray-600 text-lg leading-relaxed" id="daily-verse">
                        <!-- Content is always fully displayed -->
                    </div>
                </section>

                <!-- 5. Daily Prayer (Header changed, footnote removed) -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-red-600" style="background-color: var(--color-card-bg);">
                    <h2 class="text-2xl font-semibold text-gray-800">Daily Prayer</h2>
                    <div class="mt-3 text-gray-600 leading-relaxed" id="daily-prayer">
                        <!-- Collect of the Day is injected here -->
                    </div>
                </section>

                <!-- NEW POSITION: Quick Actions (formerly Post-Content Section) -->
                <section id="post-content-section" class="mt-8">
                    <div class="grid grid-cols-1 lg:grid-cols-1 gap-8">
            
                        <!-- Quick Actions (MERGED from old "Explore" section) -->
                        <div class="lg:col-span-1">
                            <h3 class="text-2xl font-bold mb-4 border-b pb-2 text-center" style="color: var(--color-text-primary); border-color: var(--color-border);">Quick Actions</h3>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <a href="#" onclick="launchRosaryPlayer()" class="action-button">
                                    <svg class="text-blue-500" fill="currentColor" viewBox="0 0 20 20"><path d="M12.395 1.05a1 1 0 00-.796 0L4.5 3.5v13.5a1 1 0 001.5.866l5-3.333a1 1 0 011 0l5 3.333a1 1 0 001.5-.866V3.5a1 1 0 00-.595-.95l-7.5-2.5zM11 13.5L7 16V4.5l4-1.333V13.5z"></path></svg>
                                    <span>Pray Today's Rosary</span>
                                </a>
                                <a href="#" onclick="showToast('Divine Mercy Chaplet is coming soon!')" class="action-button">
                                    <svg class="text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                                    <span>Pray Divine Mercy</span>
                                </a>
                                <a href="#" onclick="openPrayer(event, 'Angelus')" class="action-button">
                                    <svg class="text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 00-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg>
                                    <span>Pray the Angelus</span>
                                </a>
                                <a href="#" onclick="switchPage('readings')" class="action-button">
                                    <svg class="text-green-500" fill="currentColor" viewBox="0 0 20 20"><path d="M10 12a2 2 0 100-4 2 2 0 000 4z"></path><path fill-rule="evenodd" d="M3 10a7 7 0 1114 0 7 7 0 01-14 0zm7-9a9 9 0 00-9 9 9 9 0 0018 0 9 9 0 00-9-9z" clip-rule="evenodd"></path></svg>
                                    <span>Read Today's Gospel</span>
                                </a>
                                <!-- NEW: Order of Mass -->
                                <a href="#" onclick="showToast('Liturgy of the Hours is coming soon!')" class="action-button">
                                    <svg class="text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                    <span>Pray Today's Liturgy of Hours</span>
                                </a>
                                <!-- NEW: Morning Prayer -->
                                <a href="#" onclick="showToast('Morning Prayer is coming soon!')" class="action-button">
                                    <svg class="text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                                    <span>Today's Morning Prayer</span>
                                </a>
                                <!-- NEW: Evening Prayer -->
                                <a href="#" onclick="showToast('Evening Prayer is coming soon!')" class="action-button">
                                    <svg class="text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                                    <span>Today's Evening Prayer</span>
                                </a>
                                <!-- END NEW -->
                                <a href="#" onclick="switchPage('ordermass_general'); return false;" class="action-button">
                                    <svg class="text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 3l-5 5-5-5"></path></svg>
                                    <span>Order of Mass</span>
                                </a>
                                <a href="#" onclick="switchPage('novenas')" class="action-button">
                                    <svg class="text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                    <span>Start a Novena</span>
                                </a>
                                <a href="#" onclick="switchPage('saints')" class="action-button">
                                    <svg class="text-pink-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                                    <span>Saint of the Day</span>
                                </a>
                                <!-- NEW: Bible Gateway -->
                                <a href="https://www.biblegateway.com/" target="_blank" rel="noopener noreferrer" class="action-button">
                                    <svg class="text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13M3.25 9.75h17.5M3.25 15.75h17.5"></path></svg>
                                    <span>Bible Gateway</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </section>

            </div>

            <!-- RIGHT COLUMN (Sidebar/Utility - Visible only on Home View) -->
            <aside id="right-column" class="md:col-span-1 space-y-6">

                <!-- 1. Search Bar -->
                <div class="p-4 rounded-xl shadow-md" style="background-color: var(--color-card-bg);">
                    <div class="relative flex items-center">
                        <input id="home-search-input" type="search" placeholder="Search the whole website..." class="w-full py-2 pl-10 pr-10 text-sm border border-gray-300 rounded-lg focus:ring-violet-500 focus:border-violet-500">
                        <div class="absolute inset-y-0 left-0 flex items-center pl-3">
                            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2004/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                        </div>
                        <button onclick="performSearch('home-search-input')" class="absolute inset-y-0 right-0 flex items-center pr-3" aria-label="Search">
                            <svg class="w-5 h-5 text-gray-500 hover:text-violet-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path></svg>
                        </button>
                    </div>
                </div>

                <!-- NEW: Prominent Donate Button -->
                <div class="p-4 rounded-xl shadow-md border-t-4 border-green-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2 text-center">Support Our Mission</h3>
                    <p class="text-xs text-center text-gray-500 mb-3">Your generosity helps keep this resource available and growing.</p>
                    <button onclick="showToast('Donation link coming soon!')" class="w-full mt-2 py-2 text-base font-bold text-white bg-green-600 rounded-lg hover:bg-green-700 transition duration-150 shadow-lg transform hover:scale-105">
                        Support Us (Donate)
                    </button>
                </div>
                
                <!-- 2. The Companion Community Title (REVISED AND REDUCED) -->
                <div class="bg-gray-100 p-3 rounded-xl text-center shadow-inner border-b-2 border-gray-300" style="background-color: var(--color-bg);">
                    <h2 class="text-base font-semibold" style="color: var(--color-text-primary);">The Companion Community</h2>
                </div>

                <!-- 3. Send Prayer Request (Separated) -->
                <div class="p-4 rounded-xl shadow-md border-t-4 border-red-400" style="background-color: var(--color-card-bg);">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2 text-center">Send Prayer Request</h3>
                    <textarea rows="2" placeholder="Submit a personal prayer request..." class="w-full p-2 text-xs border border-gray-300 rounded-lg focus:ring-red-500 focus:border-red-500"></textarea>
                    <button class="w-full mt-2 py-1.5 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition duration-150 shadow-md">
                        Submit Request
                    </button>
                    <!-- Font size changed from text-xs to text-sm -->
                    <a href="#" class="block mt-3 text-sm text-red-600 hover:text-red-700 font-medium text-center">View All Prayer Requests</a>
                </div>

                <!-- 4. Start Conversation (Separated) -->
                <div class="p-4 rounded-xl shadow-md border-t-4 border-violet-400" style="background-color: var(--color-card-bg);">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2 text-center">Start Conversation</h3>
                    <textarea rows="2" placeholder="Ask a faith question or start a discussion..." class="w-full p-2 text-xs border border-gray-300 rounded-lg focus:ring-violet-500 focus:border-violet-500"></textarea>
                    <button class="w-full mt-2 py-1.5 text-sm font-medium text-white bg-violet-600 rounded-lg hover:bg-violet-700 transition duration-150 shadow-md">
                        Start Discussion
                    </button>
                    <!-- Font size changed from text-xs to text-sm -->
                    <a href="#" class="block mt-3 text-sm text-violet-600 hover:text-violet-700 font-medium text-center">View All Discussions</a>
                </div>

                <!-- 5. Quick Access Links -->
                <div class="p-4 rounded-xl shadow-md" style="background-color: var(--color-card-bg);">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3 text-center">Quick Access</h3>
                    <ul class="text-sm space-y-1">
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="switchPage('home')">Home</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="switchPage('home')">About Today</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="switchPage('reflections')">Reflections</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="switchPage('readings')">Readings</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="switchPage('devotions')">Devotions</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="switchPage('novenas')">Novenas</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="switchPage('prayers')">Prayers</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="switchPage('saints')">Saints Calendar</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="currentlyLoadedDate = new Date(); switchPage('ordermass');">Order of Mass</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="console.log('Liturgy of Hours page')">Liturgy of the Hours</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="showToast('Spiritual Reading page is coming soon!')">Spiritual Reading</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="console.log('Catechism page')">Catechism</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="console.log('Q&A page')">Question & Answer</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="switchPage('liturgical_calendar')">Liturgical Calendar</li>
                        <li class="p-1 rounded-lg sidebar-link font-semibold text-gray-800" onclick="console.log('Other Resources page')">Other Resources</li>
                    </ul>
                </div>

                <!-- 6. Utility Buttons (Subscriptions/Emails) -->
                <div class="p-4 rounded-xl shadow-md space-y-3" style="background-color: var(--color-card-bg);">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2 text-center">Settings</h3>
                    <!-- Added text-sm class -->
                    <button class="flex items-center w-full p-2 text-sm font-medium text-gray-700 bg-gray-50 rounded-lg hover:bg-gray-100 transition duration-150">
                        <svg class="w-4 h-4 mr-2 text-violet-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 3a1 1 0 011 1v2a1 1 0 11-2 0V4a1 1 0 011-1zM5.5 8a1 1 0 011-1h7a1 1 0 011 1v7a1 1 0 01-1 1h-7a1 1 0 01-1-1V8z"></path></svg>
                        Manage Subscription
                    </button>
                    <!-- Added text-sm class for uniform button size -->
                    <button class="flex items-center w-full p-2 text-sm font-medium text-gray-700 bg-gray-50 rounded-lg hover:bg-gray-100 transition duration-150">
                        <svg class="w-4 h-4 mr-2 text-violet-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path></svg>
                        Daily Emails Preferences
                    </button>
                </div>

            </aside>
        </div>
        
    </main>


    <!-- NEW: Footer -->
    <footer class="bg-gray-800 text-white pt-10 pb-6 mt-8">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-8 mb-8">
                <!-- About & Language -->
                <div class="col-span-2 lg:col-span-1">
                    <h4 class="font-bold text-lg mb-3">The Catholic Companion</h4>
                    <p class="text-sm text-gray-400 mb-4">Your daily guidance for prayer and devotion. A resource to enrich your spiritual life.</p>
                    <h4 class="font-semibold mb-2 text-base">Language</h4>
                    <select class="bg-gray-700 border border-gray-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                        <option selected>English</option>
                        <option disabled>Espaol (coming soon)</option>
                        <option disabled>Franais (coming soon)</option>
                        <option disabled>Latin (coming soon)</option>
                    </select>
                </div>
                <!-- Quick Links -->
                <div>
                    <h4 class="font-semibold mb-3">Navigate</h4>
                    <ul class="space-y-2 text-sm text-gray-300">
                        <li><a href="#" onclick="switchPage('about')" class="hover:text-white">About Us</a></li>
                        <li><a href="#" onclick="showToast('Contact page coming soon!')" class="hover:text-white">Contact Us</a></li>
                        <li><a href="#" onclick="showToast('Privacy Policy coming soon!')" class="hover:text-white">Privacy Policy</a></li>
                        <li><a href="#" onclick="showToast('Acknowledgements coming soon!')" class="hover:text-white">Sources & Acknowledgements</a></li>
                    </ul>
                </div>
                <!-- Engage -->
                <div>
                    <h4 class="font-semibold mb-3">Engage</h4>
                    <ul class="space-y-2 text-sm text-gray-300">
                        <li><a href="#" onclick="showToast('Donation link coming soon!')" class="hover:text-white">Support Us (Donate)</a></li>
                        <li><a href="#" onclick="showToast('App link coming soon!')" class="hover:text-white">Get the App</a></li>
                        <li><a href="#" onclick="showToast('Advertisement info coming soon!')" class="hover:text-white">Advertise With Us</a></li>
                    </ul>
                </div>
                <!-- Follow Us -->
                <div class="col-span-2 md:col-span-1">
                    <h4 class="font-semibold mb-3">Follow Us</h4>
                    <div class="flex flex-wrap gap-4">
                        <a href="#" aria-label="Facebook" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path></svg></a>
                        <a href="#" aria-label="Twitter" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616v.064c0 2.298 1.634 4.212 3.791 4.649-.69.188-1.43.238-2.18.188.598 1.956 2.343 3.379 4.422 3.419-1.799 1.407-4.069 2.245-6.516 2.245-.423 0-.84-.023-1.254-.074 2.325 1.496 5.093 2.372 8.062 2.372 9.673 0 14.975-8.003 14.975-14.975 0-.227-.005-.453-.014-.678.98-.708 1.829-1.592 2.516-2.608z"></path></svg></a>
                        <a href="#" aria-label="Instagram" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.85s-.011 3.584-.069 4.85c-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07s-3.584-.012-4.85-.07c-3.252-.148-4.771-1.691-4.919-4.919-.058-1.265-.069-1.645-.069-4.85s.011-3.584.069-4.85c.149-3.225 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.85-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.667.072 4.947c.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072s3.667-.014 4.947-.072c4.358-.2 6.78-2.618 6.98-6.98.059-1.281.073-1.689.073-4.948s-.014-3.667-.072-4.947c-.2-4.358-2.618-6.78-6.98-6.98-1.281-.058-1.689-.072-4.948-.072zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.162 6.162 6.162 6.162-2.759 6.162-6.162-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4s1.791-4 4-4 4 1.79 4 4-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.441 1.441 1.441 1.441-.645 1.441-1.441-.645-1.44-1.441-1.44z"></path></svg></a>
                        <a href="#" aria-label="YouTube" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path></svg></a>
                        <a href="#" aria-label="LinkedIn" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg></a>
                    </div>
                    <h4 class="font-semibold mb-3 mt-4">Share</h4>
                    <div class="flex flex-wrap gap-4">
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.thecatholiccompanion.com" target="_blank" rel="noopener noreferrer" aria-label="Share on Facebook" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path></svg></a>
                        <a href="https://twitter.com/intent/tweet?url=https://www.thecatholiccompanion.com&text=Check%20out%20The%20Catholic%20Companion" target="_blank" rel="noopener noreferrer" aria-label="Share on Twitter" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616v.064c0 2.298 1.634 4.212 3.791 4.649-.69.188-1.43.238-2.18.188.598 1.956 2.343 3.379 4.422 3.419-1.799 1.407-4.069 2.245-6.516 2.245-.423 0-.84-.023-1.254-.074 2.325 1.496 5.093 2.372 8.062 2.372 9.673 0 14.975-8.003 14.975-14.975 0-.227-.005-.453-.014-.678.98-.708 1.829-1.592 2.516-2.608z"></path></svg></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20The%20Catholic%20Companion%20https://www.thecatholiccompanion.com" target="_blank" rel="noopener noreferrer" aria-label="Share on WhatsApp" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.38 1.25 4.81L2 22l5.42-1.41c1.37.71 2.93 1.12 4.62 1.12h.01c5.46 0 9.91-4.45 9.91-9.91s-4.45-9.91-9.91-9.91zM17.23 15.3c-.27-.14-1.61-.79-1.86-.88-.25-.09-.43-.14-.61.14-.18.27-.7.88-.86 1.06-.16.18-.32.2-.59.07-.27-.14-1.14-.42-2.17-1.34-.81-.72-1.36-1.61-1.52-1.88-.16-.27-.02-.42.12-.56.13-.13.27-.32.41-.48.14-.16.18-.27.27-.45.09-.18.05-.36-.02-.5-.07-.14-.61-1.47-.83-2.01-.22-.54-.45-.47-.61-.47-.16 0-.34-.02-.52-.02-.18 0-.48.07-.73.34-.25.27-.95.93-.95 2.27 0 1.34.97 2.63 1.11 2.81.14.18 1.96 2.99 4.75 4.2.63.28 1.12.45 1.51.58.59.19 1.13.16 1.56.1.48-.07 1.61-.66 1.83-1.28.23-.62.23-1.15.16-1.28-.07-.13-.25-.2-.52-.34z"/></svg></a>
                        <a href="https://t.me/share/url?url=https://www.thecatholiccompanion.com&text=Check%20out%20The%20Catholic%20Companion" target="_blank" rel="noopener noreferrer" aria-label="Share on Telegram" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M21.8 4.6c-.3-.2-.7-.2-1 0L3.1 11.4c-.4.2-.6.6-.5 1s.5.7.9.7l4.9.9 1.1 5.1c.1.5.5.8 1 .8.2 0 .3 0 .5-.1l2.3-1.1 4.5 3.3c.3.2.7.3 1 .1.3-.2.5-.5.5-.9V5.6c0-.4-.2-.7-.5-1zM7.6 12.8l10-6.7-8.2 7.9-1.8-.3zM16.4 18l-4.2-3.1 6.1-5.8-1.9 8.9z"/></svg></a>
                        <a href="mailto:?subject=The%20Catholic%20Companion&body=Check%20out%20this%20website%20for%20daily%20prayer%20and%20devotion:%20https://www.thecatholiccompanion.com" aria-label="Share via Email" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-2 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z"/></svg></a>
                        <a href="sms:?&body=Check%20out%20The%20Catholic%20Companion:%20https://www.thecatholiccompanion.com" aria-label="Share via SMS" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM9 11H7V9h2v2zm4 0h-2V9h2v2zm4 0h-2V9h2v2z"/></svg></a>
                    </div>
                </div>
                <!-- Share -->
                <div class="col-span-2 md:col-span-1">
                    <h4 class="font-semibold mb-3">Recent Articles</h4>
                    <ul class="space-y-2 text-sm text-gray-300">
                        <li><a href="#" onclick="showToast('Article coming soon!')" class="hover:text-white">Understanding the Eucharist</a></li>
                        <li><a href="#" onclick="showToast('Article coming soon!')" class="hover:text-white">The Role of Mary in the Church</a></li>
                        <li><a href="#" onclick="showToast('Article coming soon!')" class="hover:text-white">A Guide to Lenten Practices</a></li>
                    </ul>
                    <h4 class="font-semibold mb-3 mt-4">Monthly Quiz</h4>
                    <a href="#" onclick="showToast('Monthly Quiz is coming soon!')" class="hover:text-white text-sm">Take this month's quiz!</a>
                </div>
            </div>
            <hr class="my-6 border-gray-600">
            <div class="text-center text-sm text-gray-400">
                <p>&copy; <span id="year"></span> The Catholic Companion. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Notification Toast -->
    <div id="notification-toast" class="fixed bottom-10 right-10 bg-gray-800 text-white p-4 rounded-lg shadow-xl transition-all duration-300 ease-in-out transform" style="opacity: 0; visibility: hidden; transform: translateX(100%); z-index: 100;">
        This feature is coming soon!
    </div>

    <!-- NEW: Cookie Consent Banner -->
    <div id="cookie-consent-banner" class="fixed bottom-0 left-0 right-0 bg-gray-900 bg-opacity-90 text-white p-4 flex flex-col sm:flex-row items-center justify-between gap-4 z-[9998]" style="display: none;">
        <p class="text-sm text-center sm:text-left">This website uses cookies to ensure you get the best experience. By continuing to use this site, you agree to our use of cookies. <a href="#" onclick="showToast('Privacy Policy coming soon!')" class="font-semibold underline hover:text-gray-300">Learn More</a></p>
        <div class="flex gap-2 flex-shrink-0">
            <button onclick="handleCookieConsent(false)" class="px-4 py-2 text-sm font-medium bg-gray-600 hover:bg-gray-500 rounded-lg transition">Decline</button>
            <button onclick="handleCookieConsent(true)" class="px-4 py-2 text-sm font-medium bg-blue-600 hover:bg-blue-500 rounded-lg transition">Accept</button>
        </div>
    </div>

    <!-- NEW: Scroll to Top Button -->
    <button id="scroll-to-top" onclick="scrollToTop()" class="fixed bottom-5 right-5 bg-gray-800 text-white w-12 h-12 rounded-full shadow-lg flex items-center justify-center transition-opacity duration-300 opacity-0 z-[9997]" style="visibility: hidden;">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path></svg>
    </button>

    <!-- NEW Rosary Mystery Modal -->
    <div id="mystery-modal" onclick="closeRosaryMysteryModal()">
        <div id="mystery-modal-content" onclick="event.stopPropagation()" style="background-color: var(--color-card-bg);">
            <div class="flex justify-between items-center mb-4">
                <h3 id="mystery-modal-title" class="text-xl font-bold" style="color: var(--color-primary);"></h3>
                <button onclick="closeRosaryMysteryModal()" class="text-gray-400 hover:text-gray-600 transition text-3xl leading-none">&times;</button>
            </div>
            <div id="mystery-modal-body">
                <!-- Mysteries will be injected here -->
            </div>
        </div>
    </div>

    <!-- NEW Prayer Text Modal -->
    <div id="prayer-modal" onclick="closePrayerModal()">
        <div id="prayer-modal-content" onclick="event.stopPropagation()" style="background-color: var(--color-card-bg);">
            <div class="flex justify-between items-center mb-4">
                <h3 id="prayer-modal-title" class="text-xl font-bold" style="color: var(--color-primary);"></h3>
                <button onclick="closePrayerModal()" class="text-gray-400 hover:text-gray-600 transition text-3xl leading-none">&times;</button>
            </div>
            <!-- Body is scrollable for long prayers -->
            <div id="prayer-modal-body" class="max-h-[70vh] overflow-y-auto pr-2">
                <!-- Prayer text will be injected here -->
            </div>
            <!-- NEW: Favorite Button -->
            <div class="mt-4 pt-4 border-t" style="border-color: var(--color-border);">
                <button id="prayer-modal-favorite-btn" onclick="toggleFavoritePrayer()" class="flex items-center text-sm font-semibold text-gray-600 hover:text-yellow-500 transition">
                    <svg id="prayer-modal-favorite-icon" class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.539 1.118l-3.975-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.196-1.539-1.118l1.518-4.674a1 1 0 00-.363-1.118L2.05 10.1c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg>
                    Add to Favorites
                </button>
            </div>
        </div>
    </div>

    <!-- NEW Full Screen Rosary Player Modal -->
    <div id="rosary-player-modal">
        <!-- 1. Modal Header -->
        <div class="flex-shrink-0 flex justify-between items-center p-3 border-b border-gray-200 bg-white" style="background-color: var(--color-card-bg); border-color: var(--color-border);">
            <button onclick="closeRosaryPlayer()" class="p-2 rounded-lg text-gray-500 hover:bg-gray-100 hover:text-gray-800 transition">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>

            <!-- NEW: Jump to Menu Button -->
            <button onclick="openRosaryNav()" class="p-2 rounded-lg text-gray-500 hover:bg-gray-100 hover:text-gray-800 transition">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
            </button>
            
            <h2 id="rosary-player-title" class="text-lg font-semibold font-serif text-center" style="color: var(--color-text-primary);">
                Praying the Rosary
            </h2>

            <!-- UPDATED: Audio Button -->
            <button onclick="toggleGlobalAudioPlayer()" class="p-2 rounded-lg text-gray-500 hover:bg-gray-100 hover:text-gray-800 transition">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072M8.464 15.536a5 5 0 010-7.072m12.728 10.606A11 11 0 115.717 5.717m14.142 14.142a11 11 0 01-16.97 0"></path></svg>
            </button>
        </div>

        <!-- 2. SVG Rosary Diagram (REMOVED) -->
        <!-- The entire 'rosary-svg-container' div has been deleted -->

        <!-- 3. Prayer Text Area -->
        <div id="rosary-player-content" class="flex-grow p-4 md:p-6 bg-white overflow-y-auto" style="background-color: var(--color-card-bg);">
            <!-- Content injected by renderRosaryPlayer() -->
            <p class="text-gray-500 text-center p-8">Loading player...</p>
        </div>

        <!-- 4. Modal Footer Navigation -->
        <div class="flex-shrink-0 flex justify-between items-center p-3 border-t border-gray-200 bg-gray-50" style="background-color: var(--color-bg); border-color: var(--color-border);">
            <button id="rosary-modal-prev" onclick="rosaryPrev()" class="px-6 py-3 rounded-lg bg-gray-200 text-gray-700 font-medium hover:bg-gray-300 transition disabled:opacity-50 disabled:cursor-not-allowed">
                Previous
            </button>
            <!-- REMOVED: "rosary-player-bead-name" span -->
            <button id="rosary-modal-next" onclick="rosaryNext()" class="px-6 py-3 rounded-lg text-white font-medium transition disabled:opacity-50 disabled:cursor-not-allowed" style="background-color: var(--color-primary); color: white;">
                Next
            </button>
        </div>
    </div>

    <!-- NEW Rosary Navigation Modal -->
    <div id="rosary-nav-modal" onclick="closeRosaryNav()">
        <div id="rosary-nav-modal-content" onclick="event.stopPropagation()" style="background-color: var(--color-card-bg);">
            <div class="flex justify-between items-center mb-4">
                <h3 id="rosary-nav-title" class="text-xl font-bold" style="color: var(--color-primary);">Jump to Prayer</h3>
                <button onclick="closeRosaryNav()" class="text-gray-400 hover:text-gray-600 transition text-3xl leading-none">&times;</button>
            </div>
            <div id="rosary-nav-body" class="space-y-3">
                <!-- Navigation links will be injected here -->
            </div>
        </div>
    </div>

    <!-- NEW Global Audio Player -->
    <div id="global-audio-player">
        <audio controls id="rosary-audio-element">
            <!-- Audio source will be set dynamically by JavaScript -->
            <source id="rosary-audio-source" src="" type="audio/mpeg">
            Your browser does not support the audio element.
        </audio>
        <button onclick="closeGlobalAudioPlayer()" class="p-2 rounded-full text-gray-400 hover:bg-gray-700 hover:text-white transition">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </button>
    </div>

    <!-- NEW: ALL SETTINGS MODALS -->
    <div id="settings-modals-container">
        <!-- Profile Settings Modal -->
        <div id="profile-settings-modal" class="settings-modal" onclick="closeAllSettingsModals()">
            <div class="settings-modal-content" onclick="event.stopPropagation()" style="background-color: var(--color-card-bg);">
                <div class="flex justify-between items-center p-4 border-b bg-white rounded-t-xl">
                    <h3 class="text-lg font-semibold text-gray-800">Profile Settings</h3>
                    <button onclick="closeAllSettingsModals()" class="text-gray-400 hover:text-gray-600">&times;</button>
                </div>
                <div class="p-6 overflow-y-auto">
                    <div class="space-y-4">
                        <div>
                            <label for="profile-name" class="block text-sm font-medium text-gray-700">Full Name</label>
                            <input type="text" id="profile-name" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3">
                        </div>
                        <div>
                            <label for="profile-email" class="block text-sm font-medium text-gray-700">Email Address</label>
                            <input type="email" id="profile-email" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Profile Photo</label>
                            <div class="mt-2 flex items-center gap-4">
                                <img id="profile-photo-preview" src="" alt="Current avatar" class="h-16 w-16 rounded-full object-cover">
                                <input type="file" id="profile-photo-upload" class="hidden" accept="image/*" onchange="previewProfilePhoto(event)">
                                <button onclick="document.getElementById('profile-photo-upload').click()" class="px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50">Change</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end p-4 border-t bg-white rounded-b-xl">
                    <button onclick="saveProfileSettings()" class="px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700">Save Changes</button>
                </div>
            </div>
        </div>

        <!-- Account & Security Modal -->
        <div id="account-security-modal" class="settings-modal" onclick="closeAllSettingsModals()">
            <div class="settings-modal-content" onclick="event.stopPropagation()" style="background-color: var(--color-card-bg);">
                <div class="flex justify-between items-center p-4 border-b bg-white rounded-t-xl">
                    <h3 class="text-lg font-semibold text-gray-800">Account & Security</h3>
                    <button onclick="closeAllSettingsModals()" class="text-gray-400 hover:text-gray-600">&times;</button>
                </div>
                <div class="p-6 overflow-y-auto">
                    <div class="space-y-4">
                        <p class="text-sm text-gray-600">For a real website, you would manage your password and two-factor authentication here.</p>
                        <button class="w-full text-left px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50">Change Password</button>
                        <button class="w-full text-left px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50">Enable Two-Factor Authentication</button>
                    </div>
                </div>
                <div class="flex justify-end p-4 border-t bg-white rounded-b-xl">
                    <button onclick="closeAllSettingsModals()" class="px-4 py-2 text-sm font-semibold text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300">Close</button>
                </div>
            </div>
        </div>

        <!-- Email Preferences Modal -->
        <div id="email-preferences-modal" class="settings-modal" onclick="closeAllSettingsModals()">
            <div class="settings-modal-content" onclick="event.stopPropagation()" style="background-color: var(--color-card-bg);">
                <div class="flex justify-between items-center p-4 border-b bg-white rounded-t-xl">
                    <h3 class="text-lg font-semibold text-gray-800">Email Preferences</h3>
                    <button onclick="closeAllSettingsModals()" class="text-gray-400 hover:text-gray-600">&times;</button>
                </div>
                <div class="p-6 overflow-y-auto">
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <input id="email-daily" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded mt-1">
                            <div class="ml-3 text-sm">
                                <label for="email-daily" class="font-medium text-gray-700">Daily Readings & Reflection</label>
                                <p class="text-gray-500">Get the day's content delivered to your inbox each morning.</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <input id="email-weekly" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded mt-1">
                            <div class="ml-3 text-sm">
                                <label for="email-weekly" class="font-medium text-gray-700">Weekly Digest</label>
                                <p class="text-gray-500">A summary of the week's new articles and community highlights.</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <input id="email-announcements" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded mt-1">
                            <div class="ml-3 text-sm">
                                <label for="email-announcements" class="font-medium text-gray-700">Special Announcements</label>
                                <p class="text-gray-500">Receive emails about major liturgical seasons, new features, and donation drives.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end p-4 border-t bg-white rounded-b-xl">
                    <button onclick="saveEmailPreferences()" class="px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700">Save Changes</button>
                </div>
            </div>
        </div>

        <!-- Appearance Modal -->
        <div id="appearance-modal" class="settings-modal" onclick="closeAllSettingsModals()">
            <div class="settings-modal-content" onclick="event.stopPropagation()" style="background-color: var(--color-card-bg);">
                <div class="flex justify-between items-center p-4 border-b bg-white rounded-t-xl">
                    <h3 class="text-lg font-semibold text-gray-800">Appearance</h3>
                    <button onclick="closeAllSettingsModals()" class="text-gray-400 hover:text-gray-600">&times;</button>
                </div>
                <div class="p-6 overflow-y-auto">
                    <div class="space-y-2">
                        <label class="flex items-center p-3 border rounded-md cursor-pointer hover:bg-gray-100" style="border-color: var(--color-border);">
                            <input type="radio" name="theme" value="light" class="h-4 w-4 text-blue-600 border-gray-300">
                            <span class="ml-3 font-medium text-gray-700">Light Theme</span>
                        </label>
                        <label class="flex items-center p-3 border rounded-md cursor-pointer hover:bg-gray-100" style="border-color: var(--color-border);">
                            <input type="radio" name="theme" value="dark" class="h-4 w-4 text-blue-600 border-gray-300">
                            <span class="ml-3 font-medium text-gray-700">Dark Theme</span>
                        </label>
                        <label class="flex items-center p-3 border rounded-md cursor-pointer hover:bg-gray-100">
                            <input type="radio" name="theme" value="system" class="h-4 w-4 text-blue-600 border-gray-300">
                            <span class="ml-3 font-medium text-gray-700">Use System Setting</span>
                        </label>
                    </div>
                </div>
                <div class="flex justify-end p-4 border-t bg-white rounded-b-xl">
                    <button onclick="saveAppearanceSettings()" class="px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700">Save Changes</button>
                </div>
            </div>
        </div>

        <!-- Notifications Modal -->
        <div id="notifications-modal" class="settings-modal" onclick="closeAllSettingsModals()">
            <div class="settings-modal-content" onclick="event.stopPropagation()" style="background-color: var(--color-card-bg);">
                <div class="flex justify-between items-center p-4 border-b bg-white rounded-t-xl">
                    <h3 class="text-lg font-semibold text-gray-800">Reminders & Notifications</h3>
                    <button onclick="closeAllSettingsModals()" class="text-gray-400 hover:text-gray-600">&times;</button>
                </div>
                <div class="p-6 overflow-y-auto">
                    <div class="space-y-6">
                        <!-- Morning/Evening Prayer -->
                        <div class="flex items-center justify-between">
                            <div class="text-sm"><label for="notif-morning-prayer" class="font-medium text-gray-700">Morning & Evening Prayer</label><p class="text-gray-500">Reminders for daily prayer.</p></div>
                            <div class="flex items-center gap-2">
                                <input type="time" id="notif-morning-time" class="auth-input w-28 text-xs p-1">
                                <input type="time" id="notif-evening-time" class="auth-input w-28 text-xs p-1">
                            </div>
                        </div>
                        <!-- Angelus -->
                        <div class="flex items-center justify-between">
                            <div class="text-sm"><label for="notif-angelus" class="font-medium text-gray-700">Angelus Reminder</label><p class="text-gray-500">Typically prayed at 6am, noon, and 6pm.</p></div>
                            <div class="flex items-center gap-2">
                                <input type="time" id="notif-angelus-time" class="auth-input w-28 text-xs p-1" value="12:00">
                            </div>
                        </div>
                        <!-- Divine Mercy -->
                        <div class="flex items-center justify-between">
                            <div class="text-sm"><label for="notif-divine-mercy" class="font-medium text-gray-700">Divine Mercy Reminder</label><p class="text-gray-500">The Hour of Great Mercy.</p></div>
                            <div class="flex items-center gap-2">
                                <input type="time" id="notif-divine-mercy-time" class="auth-input w-28 text-xs p-1" value="15:00">
                            </div>
                        </div>
                        <!-- Novena -->
                        <div class="flex items-start">
                            <input id="notif-novena" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded mt-1">
                            <div class="ml-3 text-sm"><label for="notif-novena" class="font-medium text-gray-700">Active Novena Reminders</label><p class="text-gray-500">Get a daily reminder for any novena you start.</p></div>
                        </div>
                        <!-- Quiz -->
                        <div class="flex items-start">
                            <input id="notif-quiz" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded mt-1">
                            <div class="ml-3 text-sm"><label for="notif-quiz" class="font-medium text-gray-700">Monthly Quiz Reminder</label><p class="text-gray-500">Notify me when a new quiz is available.</p></div>
                        </div>
                        <div class="border-t my-2"></div>
                        <div class="flex items-start">
                            <input id="notif-new-content" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded mt-1">
                            <div class="ml-3 text-sm">
                                <label for="notif-new-content" class="font-medium text-gray-700">New Content Alerts</label>
                                <p class="text-gray-500">Show a notification when new reflections or articles are posted.</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <input id="notif-community" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded mt-1">
                            <div class="ml-3 text-sm">
                                <label for="notif-community" class="font-medium text-gray-700">Community Activity</label>
                                <p class="text-gray-500">Notify me about new prayer requests or discussion topics.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end p-4 border-t bg-white rounded-b-xl">
                    <button onclick="saveNotificationSettings()" class="px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700">Save Changes</button>
                </div>
            </div>
        </div>

        <!-- Content & Layout Modal -->
        <div id="content-layout-modal" class="settings-modal" onclick="closeAllSettingsModals()">
            <div class="settings-modal-content" onclick="event.stopPropagation()" style="background-color: var(--color-card-bg);">
                <div class="flex justify-between items-center p-4 border-b bg-white rounded-t-xl">
                    <h3 class="text-lg font-semibold text-gray-800">Content & Layout</h3>
                    <button onclick="closeAllSettingsModals()" class="text-gray-400 hover:text-gray-600">&times;</button>
                </div>
                <div class="p-6 overflow-y-auto">
                    <p class="text-sm text-gray-600 mb-4">Choose which sections to display on your home page. (This is a simulation - changes won't persist after refresh).</p>
                    <div class="space-y-4">
                        <div class="flex items-center">
                            <input id="layout-reflections" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded">
                            <label for="layout-reflections" class="ml-3 font-medium text-gray-700">Today's Reflection</label>
                        </div>
                        <div class="flex items-center">
                            <input id="layout-readings" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded">
                            <label for="layout-readings" class="ml-3 font-medium text-gray-700">Today's Readings</label>
                        </div>
                        <div class="flex items-center">
                            <input id="layout-mass" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded">
                            <label for="layout-mass" class="ml-3 font-medium text-gray-700">Mass Today</label>
                        </div>
                        <div class="flex items-center">
                            <input id="layout-verse" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded">
                            <label for="layout-verse" class="ml-3 font-medium text-gray-700">Daily Verse</label>
                        </div>
                        <div class="flex items-center">
                            <input id="layout-prayer" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded">
                            <label for="layout-prayer" class="ml-3 font-medium text-gray-700">Daily Prayer</label>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end p-4 border-t bg-white rounded-b-xl">
                    <button onclick="saveLayoutSettings()" class="px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW: Login and Sign Up Modals -->
    <div id="login-modal" class="auth-modal" onclick="closeAuthModals()">
        <div class="auth-modal-content" onclick="event.stopPropagation()">
            <h3 class="text-xl font-bold text-center mb-4" style="color: var(--color-text-primary);">Sign In</h3>
            <div class="space-y-4">
                <div>
                    <label for="login-email" class="block text-sm font-medium text-gray-700">Email or Phone</label>
                    <input type="text" id="login-email" class="auth-input mt-1">
                </div>
                <div>
                    <label for="login-password" class="block text-sm font-medium text-gray-700">Password</label>
                    <input type="password" id="login-password" class="auth-input mt-1">
                </div>
                <div class="flex items-center justify-between">
                    <div class="flex items-center"><input id="remember-me" type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded"><label for="remember-me" class="ml-2 block text-sm text-gray-900">Remember me</label></div>
                    <a href="#" class="text-sm text-blue-600 hover:underline">Forgot password?</a>
                </div>
                <button onclick="handleLogin()" class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700">Sign In</button>
                <p class="text-center text-sm">Don't have an account? <a href="#" onclick="openSignupModal()" class="font-medium text-blue-600 hover:underline">Sign Up</a></p>
            </div>
        </div>
    </div>

    <div id="signup-modal" class="auth-modal" onclick="closeAuthModals()">
        <div class="auth-modal-content" onclick="event.stopPropagation()">
            <h3 class="text-xl font-bold text-center mb-4" style="color: var(--color-text-primary);">Create Account</h3>
            <div class="space-y-3">
                <div class="grid grid-cols-3 gap-2">
                    <div class="col-span-1"><label for="signup-title" class="block text-sm font-medium text-gray-700">Title</label><select id="signup-title" class="auth-input mt-1"><option>Mr.</option><option>Mrs.</option><option>Miss</option><option>Bp.</option><option>Fr.</option><option>Dn.</option><option>Sem.</option><option>Cat.</option><option>Catechumen</option><option>Br.</option><option>Sr.</option></select></div>
                    <div class="col-span-2"><label for="signup-name" class="block text-sm font-medium text-gray-700">Full Name</label><input type="text" id="signup-name" class="auth-input mt-1"></div>
                </div>
                <div><label for="signup-dob" class="block text-sm font-medium text-gray-700">Date of Birth</label><input type="date" id="signup-dob" class="auth-input mt-1"></div>
                <div><label for="signup-parish" class="block text-sm font-medium text-gray-700">Parish</label><input type="text" id="signup-parish" class="auth-input mt-1"></div>
                <div><label for="signup-diocese" class="block text-sm font-medium text-gray-700">Diocese/Archdiocese & Country</label><input type="text" id="signup-diocese" placeholder="e.g., Kampala, Uganda" class="auth-input mt-1"></div>
                <div><label for="signup-email" class="block text-sm font-medium text-gray-700">Email or Phone</label><input type="text" id="signup-email" class="auth-input mt-1"></div>
                <div><label for="signup-password" class="block text-sm font-medium text-gray-700">Password</label><input type="password" id="signup-password" class="auth-input mt-1"></div>
                <button onclick="handleSignup()" class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700">Sign Up</button>
                <p class="text-center text-sm">Already have an account? <a href="#" onclick="openLoginModal()" class="font-medium text-blue-600 hover:underline">Sign In</a></p>
            </div>
        </div>
    </div>

    <!-- NEW: Novena Reminder Modal -->
    <div id="novena-reminder-modal" class="settings-modal" onclick="closeNovenaReminderModal()">
        <div class="settings-modal-content" style="max-width: 400px;" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center p-4 border-b bg-white rounded-t-xl">
                <h3 class="text-lg font-semibold text-gray-800">Set Novena Reminder</h3>
                <button onclick="closeNovenaReminderModal()" class="text-gray-400 hover:text-gray-600">&times;</button>
            </div>
            <div class="p-6">
                <p class="text-sm text-gray-600 mb-4">Set a daily time to be reminded to pray this novena.</p>
                <label for="novena-reminder-time" class="block text-sm font-medium text-gray-700">Reminder Time</label>
                <input type="time" id="novena-reminder-time" class="auth-input mt-1 w-full">
            </div>
            <div class="flex justify-end p-4 border-t bg-white rounded-b-xl">
                <button onclick="closeNovenaReminderModal()" class="px-4 py-2 text-sm font-semibold text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300 mr-2">Skip</button>
                <button onclick="saveNovenaReminder()" class="px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700">Set Reminder</button>
            </div>
        </div>
    </div>

    <!-- NEW: Firebase SDKs -->
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
      import { getFirestore, collection, getDocs, doc, getDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
      import { getAuth } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

      // --- 1. FIREBASE CONFIGURATION & INITIALIZATION ---
      // Your web app's Firebase configuration
      // IMPORTANT: For production, use Firebase Hosting environment variables or a secure backend to store this config.
      const firebaseConfig = {
        apiKey: "AIzaSyDF0FFN6NpN2b7xeB_wmnK1hI055IdL4jU",
        authDomain: "the-catholic-companion-db.firebaseapp.com",
        projectId: "the-catholic-companion-db",
        storageBucket: "the-catholic-companion-db.firebasestorage.app",
        messagingSenderId: "58414447046",
        appId: "1:58414447046:web:8a2657ac57694565561ac7"
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
      window.auth = getAuth(app); // Make auth globally available
      window.db = db; // Make db globally available

      // --- 2. GLOBAL DATA FETCHING ---
      // This function will run once when the module loads.
      async function loadGlobalData() {
        try {
            console.log("Fetching saints from Firestore...");
            const saintsCol = collection(db, "saints");
            const saintsSnapshot = await getDocs(saintsCol);
            const saintsFromDB = saintsSnapshot.docs.map(doc => doc.data());

            if (saintsFromDB.length > 0) {
                // Make the fetched saints data globally available
                window.saintsDB = saintsFromDB;
                console.log(`Successfully loaded ${saintsFromDB.length} saints from Firestore!`);
            } else {
                console.warn("Firestore 'saints' collection is empty or could not be read. The saints page will not work correctly.");
                window.saintsDB = []; // Ensure saintsDB exists to prevent errors
            }
        } catch (error) {
            console.error("Error fetching saints from Firestore: ", error);
            // You might want to show a toast message here
            window.saintsDB = []; // Fallback to an empty array on error
        }

        // Dispatch a custom event to signal that global data is ready
        document.dispatchEvent(new CustomEvent('globalDataLoaded'));
      }

      // --- 3. EXECUTE ---
      loadGlobalData();

    </script>
    <!-- END NEW -->

    <script>
        document.getElementById('year').textContent = new Date().getFullYear();
        let saintsDB = []; // Initialize as an empty array. It will be populated by the module script.
        // --- GLOBAL STATE ---
        let currentlyLoadedDate = new Date();
        // currentCalendarDisplayMonth will be set inside loadFullContent now
        let currentCalendarDisplayMonth = new Date(currentlyLoadedDate.getFullYear(), currentlyLoadedDate.getMonth(), 1); 
        let homeCalendarDisplayMonth = new Date(currentlyLoadedDate.getFullYear(), currentlyLoadedDate.getMonth(), 1);
        const tabContents = {}; // Used to store the initial home page content
        let currentPage = 'home';
        let currentDevotionPage = 'list'; // 'list' or 'rosary', 'stations', etc.
        let lastSearchQuery = '';
        let readingsView = 'ferial'; // NEW: 'ferial' or 'memorial'
        let loggedIn = false; // NEW: Simulated login state

        // --- NEW: SIMULATED USER STATE ---
        let user = {
            name: 'Wilson Karugaba',
            // NEW: Add role for admin dashboard
            role: 'admin', // 'user' or 'admin'
            email: 'fr.wilson.karugaba@email.com',
            photoUrl: 'https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y', // Default Gravatar
            settings: {
                theme: 'system', // 'light', 'dark', 'system'
                email: {
                    daily: true,
                    weekly: true,
                    announcements: false,
                },
                notifications: {
                    newContent: true,
                    community: false,
                },
                layout: {
                    home: ['reflections', 'readings', 'mass', 'verse', 'prayer']
                }
            },
            // NEW: Favorites
            favorites: {
                prayers: [], // will store prayer titles
                saints: [], // will store saint IDs
            },
        };

        
        // --- DOM REFERENCES ---
        const navButtons = document.querySelectorAll('.nav-link');
        const mainGrid = document.getElementById('main-content-grid');
        const rightColumn = document.getElementById('right-column');
        const leftColumn = document.getElementById('left-column');

        // --- NEW: SCROLL & COOKIE LOGIC ---
        window.onscroll = function() {
            // Scroll to Top Button
            const scrollToTopBtn = document.getElementById('scroll-to-top');
            if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
                scrollToTopBtn.style.opacity = '1';
                scrollToTopBtn.style.visibility = 'visible';
            } else {
                scrollToTopBtn.style.opacity = '0';
                scrollToTopBtn.style.visibility = 'hidden';
            }
        };

        window.scrollToTop = function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        window.handleCookieConsent = function(accepted) {
            const banner = document.getElementById('cookie-consent-banner');
            if (banner) {
                banner.style.display = 'none';
            }
            // You can save the user's choice in localStorage here
            localStorage.setItem('cookie_consent', accepted ? 'true' : 'false');
            console.log(`Cookie consent: ${accepted}`);
        }

        // --- NEW: USER DROPDOWN LOGIC (CLICKABLE) ---
        window.toggleUserDropdown = function() {
            const menu = document.getElementById('user-dropdown-menu');
            const button = document.getElementById('user-dropdown-button');
            if (menu && button) {
                menu.classList.toggle('hidden');
                // The button itself no longer needs an 'open' class, as the menu appears below it.
            }
        }

        // Close dropdown if clicking outside
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('user-dropdown-menu');
            const button = document.getElementById('user-dropdown-button');
            // First, check if the menu and button exist (i.e., if the user is logged in)
            if (menu && button) {
                // Then, check if the menu is open and the click was outside both the button and the menu
                if (!menu.classList.contains('hidden') && !button.contains(event.target) && !menu.contains(event.target))
                    menu.classList.add('hidden');
            }
        });

        // --- NEW: AUTHENTICATION MODAL LOGIC ---
        function openLoginModal() {
            closeAuthModals();
            document.getElementById('login-modal').classList.add('show');
        }

        function openSignupModal() {
            closeAuthModals();
            document.getElementById('signup-modal').classList.add('show'); // Corrected to show signup modal
        }

        function closeAuthModals() {
            document.getElementById('login-modal').classList.remove('show');
            document.getElementById('signup-modal').classList.remove('show');
        }

        function handleLogin() {
            // This is a simulation. In a real app, you'd send this to a server.
            const email = document.getElementById('login-email').value;
            if (email) {
                loggedIn = true;
                updateUserUI();
                closeAuthModals();
                showToast(`Welcome back, ${user.name.split(' ')[0]}!`);
            } else {
                showToast("Please enter your email or phone.", "error");
            }
        }

        function handleSignup() {
            // This is a simulation.
            const name = document.getElementById('signup-name').value;
            const email = document.getElementById('signup-email').value;
            if (name && email) {
                // Simulate sending a verification link
                showToast(`A verification link has been sent to ${email}. Please check your inbox.`, "success");
                closeAuthModals();
            } else {
                showToast("Please fill in all required fields.", "error");
            }
        }

        function handleSignOut() {
            loggedIn = false;
            updateUserUI();
            showToast("You have been signed out.");
        }

        // --- NEW: NOVENA REMINDER MODAL ---
        function openNovenaReminderModal() {
            document.getElementById('novena-reminder-modal').classList.add('show');
        }

        function closeNovenaReminderModal() {
            document.getElementById('novena-reminder-modal').classList.remove('show');
        }

        function saveNovenaReminder() {
            const time = document.getElementById('novena-reminder-time').value;
            // In a real app, you'd save this to the user's profile
            console.log(`Novena reminder set for ${time}`);
            showToast(`Reminder set for ${time} daily!`);
            closeNovenaReminderModal();
        }

        // --- NEW: SEARCH FUNCTIONALITY ---
        window.performSearch = function(inputId) {
            const input = document.getElementById(inputId);
            if (!input) return;

            const query = input.value.trim();
            if (query.length < 2) {
                showToast("Please enter at least 2 characters to search.");
                return;
            }

            lastSearchQuery = query;
            switchPage('search');
        }

        // --- NEW: NOTIFICATION FUNCTIONALITY ---
        const notifications = [
            { id: 1, title: 'New Reflection Added', text: 'A new reflection for the Feast of St. Andrew is now available.', read: false, date: '2025-11-30' },
            { id: 2, title: 'Website Update', text: 'The search functionality has been improved across the site.', read: false, date: '2025-11-15' },
            { id: 3, title: 'Prayer Request', text: 'A new prayer request has been posted by a community member.', read: true, date: '2025-11-14' },
        ];

        function updateNotificationBadge() {
            const badge = document.getElementById('notification-badge');
            const unreadCount = notifications.filter(n => !n.read).length;
            if (badge) {
                if (unreadCount > 0) {
                    badge.textContent = unreadCount;
                    badge.style.display = 'inline-flex';
                } else {
                    badge.style.display = 'none';
                }
            }
        }

        window.toggleNotificationsPanel = function() {
            const panel = document.getElementById('notifications-panel');
            if (!panel) return;

            if (panel.classList.contains('hidden')) {
                let html = `<div class="p-3 font-bold border-b text-gray-700">Notifications</div><div class="max-h-80 overflow-y-auto">`;
                if (notifications.length === 0) {
                    html += `<p class="p-4 text-sm text-gray-500">You have no new notifications.</p>`;
                } else {
                    notifications.forEach(n => {
                        html += `<div class="p-3 border-b hover:bg-gray-50 ${!n.read ? 'bg-blue-50' : ''}"><p class="font-semibold text-sm text-gray-800">${n.title}</p><p class="text-xs text-gray-600">${n.text}</p></div>`;
                    });
                }
                html += `</div><a href="#" onclick="showToast('Viewing all notifications...')" class="block text-center p-2 text-sm font-semibold text-blue-600 hover:bg-gray-100">View All</a>`;
                panel.innerHTML = html;
                panel.classList.remove('hidden');
            } else {
                panel.classList.add('hidden');
            }
        }


        // --- CORE UTILITY FUNCTIONS ---
        
        // Helper function for consistent date formatting
        function formattedDate(date, options = {}) {
            const defaultOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            
            // Allow turning off weekday for shorter formats
            if (options.weekday === false) {
                delete defaultOptions.weekday;
            }

            const dateOptions = { ...defaultOptions, ...options };
            // Ensure weekday isn't added if specifically set to false in options:
            if (options.weekday === false) {
                 delete dateOptions.weekday;
            }
            
            return date.toLocaleDateString('en-US', dateOptions);
        }
        
        // Helper function to check if a date is today
        function isToday(date) {
            const today = new Date();
            return date.getFullYear() === today.getFullYear() &&
                   date.getMonth() === today.getMonth() &&
                   date.getDate() === today.getDate();
        }

        // Helper to get ordinal suffix (1st, 2nd, 3rd, 4th)
        function getOrdinal(n) {
            const s = ["th", "st", "nd", "rd"], v = n % 100;
            return n + (s[(v - 20) % 10] || s[v] || s[0]);
        }

        // --- NEW ROSARY MYSTERY MODAL FUNCTIONS ---
        window.openRosaryMysteryModal = function(setName) {
            const modal = document.getElementById('mystery-modal');
            const titleEl = document.getElementById('mystery-modal-title');
            const bodyEl = document.getElementById('mystery-modal-body');

            if (!modal || !titleEl || !bodyEl || !rosaryMysteries[setName]) return;

            const mysteriesList = rosaryMysteries[setName];
            const properName = setName.charAt(0).toUpperCase() + setName.slice(1);

            titleEl.textContent = `${properName} Mysteries`;
            
            let listHtml = '<ol class="list-decimal list-inside space-y-2 text-gray-700">';
            mysteriesList.forEach(mystery => {
                listHtml += `<li>${mystery}</li>`;
            });
            listHtml += '</ol>';
            
            bodyEl.innerHTML = listHtml;
            modal.classList.add('show');
        }

        window.closeRosaryMysteryModal = function() {
            const modal = document.getElementById('mystery-modal');
            if (modal) {
                modal.classList.remove('show');
            }
        }
        // --- END NEW MODAL FUNCTIONS ---

        // --- NEW PRAYER MODAL FUNCTIONS ---
        window.openPrayerModal = function(title, text) {
            const modal = document.getElementById('prayer-modal');
            const titleEl = document.getElementById('prayer-modal-title');
            const bodyEl = document.getElementById('prayer-modal-body');

            if (!modal || !titleEl || !bodyEl) return;

            titleEl.textContent = title;
            // Use whitespace-pre-line to respect newline characters (\n) in the text
            bodyEl.innerHTML = `<p class="text-gray-700 whitespace-pre-line text-lg leading-relaxed">${text}</p>`;
            
            modal.classList.add('show');
        }

        window.closePrayerModal = function() {
            const modal = document.getElementById('prayer-modal');
            if (modal) {
                modal.classList.remove('show');
            }
        }
        // --- END PRAYER MODAL FUNCTIONS ---

        // --- NEW: USER SETTINGS MODAL FUNCTIONS ---
        function openSettingsModal(modalId) {
            // Close user dropdown first if it's open
            toggleUserDropdown();

            const modal = document.getElementById(modalId);
            if (!modal) return;

            // Populate the form with current user data
            if (modalId === 'profile-settings-modal') {
                document.getElementById('profile-name').value = user.name; // Corrected ID
                document.getElementById('profile-email').value = user.email; // Corrected ID
                document.getElementById('profile-photo-preview').src = user.photoUrl; // Corrected ID
            } else if (modalId === 'email-preferences-modal') {
                document.getElementById('email-daily').checked = user.settings.email.daily;
                document.getElementById('email-weekly').checked = user.settings.email.weekly;
                document.getElementById('email-announcements').checked = user.settings.email.announcements;
            } else if (modalId === 'appearance-modal') {
                document.querySelector(`input[name="theme"][value="${user.settings.theme}"]`).checked = true;
            } else if (modalId === 'notifications-modal') {
                document.getElementById('notif-new-content').checked = user.settings.notifications.newContent;
                document.getElementById('notif-community').checked = user.settings.notifications.community;
            } else if (modalId === 'content-layout-modal') {
                document.getElementById('layout-reflections').checked = user.settings.layout.home.includes('reflections');
                document.getElementById('layout-readings').checked = user.settings.layout.home.includes('readings');
                document.getElementById('layout-mass').checked = user.settings.layout.home.includes('mass');
                document.getElementById('layout-verse').checked = user.settings.layout.home.includes('verse');
                document.getElementById('layout-prayer').checked = user.settings.layout.home.includes('prayer');
            }

            modal.classList.add('show');
        }

        function closeAllSettingsModals() {
            document.querySelectorAll('.settings-modal').forEach(modal => {
                modal.classList.remove('show');
            });
        }

        // --- NEW: SAVE SETTINGS FUNCTIONS ---
        function saveProfileSettings() {
            user.name = document.getElementById('profile-name').value; // Corrected ID
            user.email = document.getElementById('profile-email').value; // Corrected ID
            // The photo URL is updated by the preview function
            updateUserUI();
            showToast('Profile settings saved!');
            closeAllSettingsModals();
        }

        function saveEmailPreferences() {
            user.settings.email.daily = document.getElementById('email-daily').checked;
            user.settings.email.weekly = document.getElementById('email-weekly').checked;
            user.settings.email.announcements = document.getElementById('email-announcements').checked;
            showToast('Email preferences saved!');
            closeAllSettingsModals();
        }

        function saveAppearanceSettings() {
            user.settings.theme = document.querySelector('input[name="theme"]:checked').value;
            showToast('Appearance settings saved!');
            applyTheme();
            closeAllSettingsModals();
        }

        function applyTheme() {
            const root = document.documentElement;
            if (user.settings.theme === 'dark' || (user.settings.theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                root.classList.add('dark');
            } else {
                root.classList.remove('dark');
            }
        }

        function saveNotificationSettings() {
            user.settings.notifications.newContent = document.getElementById('notif-new-content').checked;
            user.settings.notifications.community = document.getElementById('notif-community').checked;
            // In a real app, you'd save the time values here too.
            showToast('Notification settings saved!');
            closeAllSettingsModals();
        }

        function saveLayoutSettings() {
            const newLayout = [];
            if (document.getElementById('layout-reflections').checked) newLayout.push('reflections');
            if (document.getElementById('layout-readings').checked) newLayout.push('readings');
            if (document.getElementById('layout-mass').checked) newLayout.push('mass');
            if (document.getElementById('layout-verse').checked) newLayout.push('verse');
            if (document.getElementById('layout-prayer').checked) newLayout.push('prayer');
            user.settings.layout.home = newLayout;
            showToast('Layout settings saved! Changes will apply next time you visit Home.');
            closeAllSettingsModals();
        }

        // --- NEW: PROFILE PHOTO UPLOAD ---
        function previewProfilePhoto(event) {
            const reader = new FileReader();
            reader.onload = function() {
                const dataURL = reader.result;
                document.getElementById('profile-photo-preview').src = dataURL;
                user.photoUrl = dataURL; // Save the new photo URL
            }
            reader.readAsDataURL(event.target.files[0]);
        }

        // --- NEW: UPDATE USER UI ---
        function updateUserUI() {
            const userArea = document.getElementById('user-account-area');
            if (loggedIn) {
                userArea.innerHTML = `
                    <button id="user-dropdown-button" aria-label="User Account and Settings" onclick="toggleUserDropdown()" class="nav-link py-3 px-3 sm:px-4 text-sm sm:text-base font-semibold whitespace-nowrap flex items-center">
                        <img id="user-avatar-nav" src="${user.photoUrl}" alt="User Avatar" class="w-6 h-6 rounded-full mr-2">
                        <span id="user-name-nav">${user.name.split(' ')[0]}</span>
                    </button>
                    <div id="user-dropdown-menu" class="absolute z-50 right-0 mt-2 w-64 bg-white rounded-lg shadow-xl hidden transition-all duration-150 ease-in-out" style="background-color: var(--color-card-bg);">
                        <div class="p-2 space-y-1">
                            <div class="px-2 py-2"><p id="user-dropdown-name" class="text-sm font-semibold text-gray-800">${user.name}</p><p id="user-dropdown-email" class="text-xs text-gray-500 truncate">${user.email}</p></div>
                            <div class="border-t my-1"></div>
                            <a href="#" onclick="switchPage('my_prayers'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg> My Favourite Prayers</a>
                            <a href="#" onclick="switchPage('my_saints'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.539 1.118l-3.975-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.196-1.539-1.118l1.518-4.674a1 1 0 00-.363-1.118L2.05 10.1c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg> My Favourite Saints</a>
                            <a href="#" onclick="switchPage('my_requests'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a2 2 0 01-2-2V10a2 2 0 012-2h8z"></path></svg> My Prayer Requests</a>
                            <div class="border-t my-1"></div>
                            <a href="#" onclick="openSettingsModal('profile-settings-modal'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> Profile Settings</a>
                            <a href="#" onclick="openSettingsModal('account-security-modal'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg> Account & Security</a>
                            <a href="#" onclick="openSettingsModal('email-preferences-modal'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg> Email Preferences</a>
                            <a href="#" onclick="openSettingsModal('appearance-modal'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg> Appearance</a>
                            <a href="#" onclick="openSettingsModal('notifications-modal'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 00-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg> Reminders & Notifications</a>
                            <a href="#" onclick="openSettingsModal('content-layout-modal'); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path></svg> Content & Layout</a>
                            <a id="admin-dashboard-link" href="#" onclick="switchPage('admin_dashboard'); return false;" class="user-dropdown-link" style="display: ${user.role === 'admin' ? 'flex' : 'none'};"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2a4 4 0 00-4-4H3V7h2a4 4 0 004-4V3a2 2 0 012-2h2a2 2 0 012 2v2a4 4 0 004 4h2v4h-2a4 4 0 00-4 4v2a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg> Admin Dashboard</a>
                            <div class="border-t my-1"></div>
                            <a href="#" onclick="handleSignOut(); return false;" class="user-dropdown-link"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg> Sign Out</a>
                        </div>
                    </div>
                `;
            } else {
                userArea.innerHTML = `<div class="flex items-center gap-2"><button onclick="openLoginModal()" class="nav-link py-2 px-3 sm:px-4 text-sm font-semibold">Sign In</button><button onclick="openSignupModal()" class="px-3 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700">Sign Up</button></div>`;
            }
        }

        // --- NEW Anchor Navigation Function ---
        window.navigateToAnchor = function(page, anchorId) {
            // 1. Switch to the page
            switchPage(page);
            
            // 2. Scroll to the anchor
            // We need to wait a brief moment for the DOM to be updated by switchPage
            setTimeout(() => {
                const element = document.getElementById(anchorId);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    
                    // Optional: Add a brief highlight effect
                    element.style.transition = 'all 0.3s ease-in-out';
                    element.style.backgroundColor = '#fefcbf'; // yellow-100
                    setTimeout(() => {
                        element.style.backgroundColor = ''; // Revert
                    }, 1500);
                }
            }, 100); // 100ms delay should be enough

            return false; // Prevent default <a> behavior
        }
        // --- END Anchor Navigation Function ---


        // --- NEW ROSARY NAVIGATION FUNCTIONS ---
        window.openRosaryNav = function() {
            const modal = document.getElementById('rosary-nav-modal');
            const bodyEl = document.getElementById('rosary-nav-body');
            if (!modal || !bodyEl) return;

            const properName = rosaryState.mysterySet.charAt(0).toUpperCase() + rosaryState.mysterySet.slice(1);
            document.getElementById('rosary-nav-title').textContent = `Jump to... (${properName})`;

            let html = '<div class="space-y-1">';
            
            // 1. Introduction
            html += '<strong class="text-sm text-gray-500 uppercase">Introduction</strong>';
            rosarySequence.intro.forEach((item, index) => {
                const isActive = rosaryState.step === 0 && rosaryState.bead === index;
                html += `<a onclick="jumpToPrayer(0, ${index})" class="rosary-nav-link ${isActive ? 'active' : ''}">${item.prayer.title}</a>`;
            });

            // 2. Decades
            for (let i = 1; i <= 5; i++) {
                const mysteryTitle = rosaryMysteries[rosaryState.mysterySet][i - 1];
                html += `<strong class="text-sm text-gray-500 uppercase pt-2 block">Mystery ${i}: ${mysteryTitle}</strong>`;
                
                rosarySequence.decade.forEach((item, index) => {
                    const isActive = rosaryState.step === i && rosaryState.bead === index;
                    let title = '';
                    if (index === 0) {
                        title = `Announce Mystery ${i}`;
                    } else if (item.prayer === rosaryPrayers.hail_mary) {
                        const hmNum = index - 1; // 2-11 -> 1-10
                        title = `Hail Mary (${hmNum} of 10)`;
                    } else {
                        title = item.prayer.title;
                    }
                    html += `<a onclick="jumpToPrayer(${i}, ${index})" class="rosary-nav-link ${isActive ? 'active' : ''}">${title}</a>`;
                });
            }

            // 3. Conclusion
            html += '<strong class="text-sm text-gray-500 uppercase pt-2 block">Conclusion</strong>';
            rosarySequence.conclusion.forEach((item, index) => {
                const isActive = rosaryState.step === 6 && rosaryState.bead === index;
                html += `<a onclick="jumpToPrayer(6, ${index})" class="rosary-nav-link ${isActive ? 'active' : ''}">${item.prayer.title}</a>`;
            });

            html += '</div>';
            bodyEl.innerHTML = html;
            modal.classList.add('show');
        }

        window.closeRosaryNav = function() {
            const modal = document.getElementById('rosary-nav-modal');
            if (modal) {
                modal.classList.remove('show');
            }
        }

        window.jumpToPrayer = function(step, bead) {
            rosaryState.step = step;
            rosaryState.bead = bead;
            renderRosaryPlayer();
            closeRosaryNav();
        }
        // --- END ROSARY NAVIGATION FUNCTIONS ---

        // --- NEW GLOBAL AUDIO PLAYER FUNCTIONS ---
        window.toggleGlobalAudioPlayer = function() {
            const player = document.getElementById('global-audio-player');
            const audioEl = document.getElementById('rosary-audio-element');
            const sourceEl = document.getElementById('rosary-audio-source');
            
            if (!player || !audioEl || !sourceEl) {
                console.error("Audio player elements not found!");
                return;
            }

            if (player.style.display === 'flex') {
                // It's open, let's close it
                closeGlobalAudioPlayer();
            } else {
                // It's closed, let's open it and load the correct audio
                const audioSrc = rosaryAudioFiles[rosaryState.mysterySet];
                if (!audioSrc) {
                    console.warn("No audio file found for mystery set:", rosaryState.mysterySet);
                    showToast("Audio for this mystery is not available.");
                    return;
                }

                // Check if the source is already correct
                if (sourceEl.src !== audioSrc) {
                    sourceEl.src = audioSrc;
                    audioEl.load(); // Load the new source
                }
                
                player.style.display = 'flex';
                audioEl.play(); // Auto-play when opened
            }
        }

        window.closeGlobalAudioPlayer = function() {
            const player = document.getElementById('global-audio-player');
            const audioEl = document.getElementById('rosary-audio-element');
            if (player) {
                player.style.display = 'none';
            }
            if (audioEl) {
                audioEl.pause(); // Stop playing when closed
            }
        }
        // --- END GLOBAL AUDIO PLAYER FUNCTIONS ---


        // --- TOAST NOTIFICATION ---
        let toastTimer;
        function showToast(message, type = 'info') {
            const toast = document.getElementById('notification-toast');
            if (!toast) return;
            
            toast.className = `fixed bottom-10 right-10 text-white p-4 rounded-lg shadow-xl transition-all duration-300 ease-in-out transform ${type === 'error' ? 'bg-red-600' : 'bg-gray-800'}`;
            // Clear any existing timer
            if (toastTimer) {
                clearTimeout(toastTimer);
            }

            toast.textContent = message;
            toast.style.visibility = 'visible';
            toast.style.opacity = '1';
            toast.style.transform = 'translateX(0)';

            // Hide after 3 seconds
            toastTimer = setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                
                // Use another timeout to set visibility to hidden after the transition
                setTimeout(() => {
                    toast.style.visibility = 'hidden';
                    toastTimer = null;
                }, 300); // Must match the transition duration
            }, 3000);
        }

        window.openDevotion = function(event, devotionName) {
            event.preventDefault(); // Prevent the link from jumping to top

            // SPECIAL CASE: Handle The Holy Rosary
            if (devotionName === 'The Holy Rosary') {
                currentDevotionPage = 'rosary';
                // We are already on the 'devotions' page, so just reload the content
                loadFullContent(currentlyLoadedDate, 'devotions'); 
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
                // Default behavior for all other links
                console.log(`Opening devotion: ${devotionName}. Content is not yet available.`);
                showToast(`Content for "${devotionName}" is coming soon!`);
            }
        }
        
        // NEW: Function for handling clicks on individual prayers
        // UPDATED: This now opens the modal if the prayer exists in our new database
        window.openPrayer = function(event, prayerName) {
            event.preventDefault();
            
            // Look for the prayer in our database
            const prayerData = allPrayers[prayerName];
            
            if (prayerData) {
                // NEW: Store the current prayer's title for the favorite function
                document.getElementById('prayer-modal').dataset.currentPrayer = prayerName;
                // If found, open the modal with its title and text
                openPrayerModal(prayerData.title, prayerData.text);
            } else {
                // Otherwise, show the "coming soon" message
                console.log(`Opening prayer: ${prayerName}. Content is not yet available.`);
                showToast(`Content for "${prayerName}" is coming soon!`);
            }
        }

        // --- NEW: FAVORITES LOGIC ---
        function toggleFavoritePrayer() {
            const modal = document.getElementById('prayer-modal');
            const prayerName = modal.dataset.currentPrayer;
            if (!prayerName) return;

            const index = user.favorites.prayers.indexOf(prayerName);
            if (index > -1) {
                // It's already a favorite, so remove it
                user.favorites.prayers.splice(index, 1);
                showToast(`"${prayerName}" removed from favorites.`);
            } else {
                // Add it to favorites
                user.favorites.prayers.push(prayerName);
                showToast(`"${prayerName}" added to favorites.`);
            }
            // Update the button state
            updateFavoriteButtonState(prayerName);
        }

        function updateFavoriteButtonState(prayerName) {
            const isFavorite = user.favorites.prayers.includes(prayerName);
            const btn = document.getElementById('prayer-modal-favorite-btn');
            const icon = document.getElementById('prayer-modal-favorite-icon');
            if (btn && icon) {
                btn.innerHTML = `<svg id="prayer-modal-favorite-icon" class="w-5 h-5 mr-2" fill="${isFavorite ? 'currentColor' : 'none'}" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.539 1.118l-3.975-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.196-1.539-1.118l1.518-4.674a1 1 0 00-.363-1.118L2.05 10.1c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg> ${isFavorite ? 'Favorited' : 'Add to Favorites'}`;
                btn.classList.toggle('text-yellow-500', isFavorite);
            }
        }
        
        window.goBackToDevotionsList = function(event) {
            event.preventDefault();
            currentDevotionPage = 'list';
            loadFullContent(currentlyLoadedDate, 'devotions');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        /**
         * Parses the reading citation from the text (assumes "Citation: Text..." format)
         */
        function getCitationAndText(reading) {
            if (!reading) return { citation: '', text: '' };
            const parts = reading.split(': ');
            const citation = parts[0];
            const text = parts.slice(1).join(': ');
            return { citation, text };
        }

        // --- PRAYER DATABASES ---

        // NEW: Database for all prayer texts
        // We will add all the prayers here, one by one.
        const allPrayers = {
            'Sign of the Cross': {
                title: 'Sign of the Cross',

                text: 'In the name of the Father,\nand of the Son,\nand of the Holy Spirit.\nAmen.'
            }
            // Next, you can send me the text for "The Lord's Prayer"
            // and I will add it here.
        };

        // --- ROSARY PLAYER LOGIC ---
        const rosaryPrayers = {
            sign_of_cross: { title: "Sign of the Cross", text: "In the name of the Father, and of the Son, and of the Holy Spirit. Amen." },
            creed: { title: "The Apostles' Creed", text: "I believe in God, the Father almighty, Creator of heaven and earth, and in Jesus Christ, his only Son, our Lord, who was conceived by the Holy Spirit, born of the Virgin Mary, suffered under Pontius Pilate, was crucified, died and was buried; he descended into hell; on the third day he rose again from the dead; he ascended into heaven, and is seated at the right hand of God the Father almighty; from there he will come to judge the living and the dead. I believe in the Holy Spirit, the holy catholic Church, the communion of saints, the forgiveness of sins, the resurrection of the body, and life everlasting. Amen." },
            our_father: { title: "Our Father", text: "Our Father, Who art in heaven, hallowed be Thy name; Thy kingdom come; Thy will be done on earth as it is in heaven. Give us this day our daily bread; and forgive us our trespasses as we forgive those who trespass against us; and lead us not into temptation, but deliver us from evil. Amen." },
            hail_mary: { title: "Hail Mary", text: "Hail Mary, full of grace, the Lord is with thee; blessed art thou among women, and blessed is the fruit of thy womb, Jesus. Holy Mary, Mother of God, pray for us sinners, now and at the hour of our death. Amen." },
            glory_be: { title: "Glory Be", text: "Glory be to the Father, and to the Son, and to the Holy Spirit, as it was in the beginning, is now, and ever shall be, world without end. Amen." },
            fatima: { title: "Fatima Prayer (O My Jesus)", text: "O my Jesus, forgive us our sins, save us from the fires of hell, lead all souls to Heaven, especially those in most need of Thy mercy." },
            hail_holy_queen: { title: "Hail, Holy Queen", text: "Hail, Holy Queen, Mother of Mercy, our life, our sweetness and our hope! To thee do we cry, poor banished children of Eve; to thee do we send up our sighs, mourning and weeping in this valley of tears. Turn then, most gracious Advocate, thine eyes of mercy toward us, and after this our exile, show unto us the blessed fruit of thy womb, Jesus. O clement, O loving, O sweet Virgin Mary! \n\nV. Pray for us, O Holy Mother of God. \nR. That we may be made worthy of the promises of Christ." },
            final_prayer: { title: "Final Prayer", text: "Let us pray. O God, whose only begotten Son, by His life, death, and resurrection, has purchased for us the rewards of eternal life, grant, we beseech Thee, that meditating upon these mysteries of the Most Holy Rosary of the Blessed Virgin Mary, we may imitate what they contain and obtain what they promise, through the same Christ Our Lord. Amen." }
        };

        const rosaryMysteries = {
            joyful: ["The Annunciation", "The Visitation", "The Nativity", "The Presentation", "The Finding in the Temple"],
            luminous: ["The Baptism in the Jordan", "The Wedding at Cana", "The Proclamation of the Kingdom", "The Transfiguration", "The Institution of the Eucharist"],
            sorrowful: ["The Agony in the Garden", "The Scourging at the Pillar", "The Crowning with Thorns", "The Carrying of the Cross", "The Crucifixion"],
            glorious: ["The Resurrection", "The Ascension", "The Descent of the Holy Spirit", "The Assumption", "The Coronation of Mary"]
        };
        
        // NEW: Audio files for each mystery set
        const rosaryAudioFiles = {
            joyful: "https.archive.org/download/RosaryJoyfulMysteries/Rosary-JoyfulMysteries.mp3",
            luminous: "https.archive.org/download/RosaryLuminousMysteries/Rosary-LuminousMysteries.mp3",
            sorrowful: "https.archive.org/download/RosarySorrowfulMysteries/Rosary-SorrowfulMysteries.mp3",
            glorious: "https.archive.org/download/RosaryGloriousMysteries/Rosary-GloriousMysteries.mp3"
        };
        
        let rosaryState = {
            step: 0, // 0=Intro, 1-5=Decades, 6=Conclusion
            bead: 0, // 0-5 (Intro), 0-12 (Decade), 0-1 (Conclusion)
            mysterySet: 'joyful'
        };

        // NEW: Updated rosarySequence with SVG IDs
        const rosarySequence = {
            intro: [
                { prayer: rosaryPrayers.sign_of_cross },
                { prayer: rosaryPrayers.creed },
                { prayer: rosaryPrayers.our_father },
                { prayer: rosaryPrayers.hail_mary },
                { prayer: rosaryPrayers.hail_mary },
                { prayer: rosaryPrayers.hail_mary },
                { prayer: rosaryPrayers.glory_be }
            ],
            decade: [
                { prayer: "Announce Mystery" }, // Special case
                { prayer: rosaryPrayers.our_father },
                { prayer: rosaryPrayers.hail_mary },
                { prayer: rosaryPrayers.hail_mary },
                { prayer: rosaryPrayers.hail_mary },
                { prayer: rosaryPrayers.hail_mary },
                { prayer: rosaryPrayers.hail_mary },
                { prayer: rosaryPrayers.hail_mary },
                { prayer: rosaryPrayers.hail_mary },
                { prayer: rosaryPrayers.hail_mary },
                { prayer: rosaryPrayers.hail_mary },
                { prayer: rosaryPrayers.hail_mary },
                { prayer: rosaryPrayers.glory_be },
                { prayer: rosaryPrayers.fatima }
            ],
            conclusion: [
                { prayer: rosaryPrayers.hail_holy_queen },
                { prayer: rosaryPrayers.final_prayer },
                { prayer: rosaryPrayers.sign_of_cross }
            ]
        };

        // DELETED: The getDecadeBead function is no longer needed and has been removed.


        // REPLACED: This now launches the full-screen modal
        window.launchRosaryPlayer = function(mysterySet) {
            const modal = document.getElementById('rosary-player-modal');
            if (!modal) return;
            
            // If no mysterySet provided, calculate today's default
            if (!mysterySet) {
                const todayDay = new Date().getDay(); // 0=Sun, 1=Mon, 2=Tue, 3=Wed, 4=Thu, 5=Fri, 6=Sat
                if ([0, 3].includes(todayDay)) mysterySet = 'glorious';
                else if ([2, 5].includes(todayDay)) mysterySet = 'sorrowful';
                else if (todayDay === 4) mysterySet = 'luminous';
                else mysterySet = 'joyful'; // Default for Mon, Sat
            }

            rosaryState = { step: 0, bead: 0, mysterySet: mysterySet };
            
            // Update modal title
            const properName = mysterySet.charAt(0).toUpperCase() + mysterySet.slice(1);
            document.getElementById('rosary-player-title').textContent = `${properName} Mysteries`;

            renderRosaryPlayer();
            modal.classList.add('show');
        }
        
        // NEW: Closes the full-screen modal
        window.closeRosaryPlayer = function() {
            const modal = document.getElementById('rosary-player-modal');
            if (modal) {
                modal.classList.remove('show');
            }
        }


        // REPURPOSED: This function now controls the MODAL, not the inline player
        // This function is updated to be more robust.
        window.renderRosaryPlayer = function() {
            const contentEl = document.getElementById('rosary-player-content');
            const prevBtn = document.getElementById('rosary-modal-prev');
            const nextBtn = document.getElementById('rosary-modal-next');
            
            // REMOVED: beadNameEl
            
            if (!contentEl || !prevBtn || !nextBtn) {
                console.error("Rosary player elements not found!"); 
                return;
            }
            
            let currentStep, currentBead, currentPrayer, mysteryTitle = '';
            // REMOVED: beadId, beadName
            
            try {
                if (rosaryState.step === 0) { // Intro
                    currentStep = rosarySequence.intro;
                    currentBead = currentStep[rosaryState.bead];
                    currentPrayer = currentBead.prayer;
                    // REMOVED: beadId, beadName logic
                    
                    contentEl.innerHTML = `
                        <p class="text-sm font-semibold text-gray-500 uppercase tracking-wide text-center">Introduction</p>
                        <h4 class="text-2xl font-bold font-serif mt-2 text-center" style="color: var(--color-text-primary);">${currentPrayer.title}</h4>
                        <p class="whitespace-pre-line mt-4 text-lg md:text-xl leading-relaxed" style="color: var(--color-text-secondary);">${currentPrayer.text}</p>
                    `;
                } else if (rosaryState.step >= 1 && rosaryState.step <= 5) { // Decades 1-5
                    currentStep = rosarySequence.decade;
                    currentBead = currentStep[rosaryState.bead];
                    mysteryTitle = rosaryMysteries[rosaryState.mysterySet][rosaryState.step - 1];
                    // REMOVED: beadId logic
                    
                    if (rosaryState.bead === 0) { // Announce Mystery
                        currentPrayer = { title: `Mystery ${rosaryState.step}: ${mysteryTitle}`, text: `(Pause to reflect on the ${mysteryTitle})` };
                        // REMOVED: beadName
                    } else {
                        currentPrayer = currentBead.prayer;
                        
                        // NEW: Number the Hail Marys
                        if (currentPrayer === rosaryPrayers.hail_mary) {
                            // Beads 2-11 are Hail Marys.
                            const hailMaryNumber = rosaryState.bead - 1; // bead 2 is HM 1, bead 3 is HM 2, etc.
                            // CLONE the prayer object so we don't modify the original
                            currentPrayer = { 
                                ...currentPrayer, 
                                title: `Hail Mary (${hailMaryNumber} of 10)` 
                            };
                        }
                        // END NEW
                        
                        // REMOVED: beadName
                    }
                    
                    contentEl.innerHTML = `
                        <p class="text-sm font-semibold text-blue-600 uppercase tracking-wide text-center">Mystery ${rosaryState.step}: ${mysteryTitle}</p>
                        <h4 class="text-2xl font-bold font-serif mt-2 text-center" style="color: var(--color-text-primary);">${currentPrayer.title}</h4>
                        <p class="whitespace-pre-line mt-4 text-lg md:text-xl leading-relaxed" style="color: var(--color-text-secondary);">${currentPrayer.text}</p>
                    `;
                } else { // Conclusion
                    currentStep = rosarySequence.conclusion;
                    currentBead = currentStep[rosaryState.bead];
                    currentPrayer = currentBead.prayer;
                    // REMOVED: beadId, beadName logic

                    contentEl.innerHTML = `
                        <p class="text-sm font-semibold text-gray-500 uppercase tracking-wide text-center">Conclusion</p>
                        <h4 class="text-2xl font-bold font-serif mt-2 text-center" style="color: var(--color-text-primary);">${currentPrayer.title}</h4>
                        <p class="whitespace-pre-line mt-4 text-lg md:text-xl leading-relaxed" style="color: var(--color-text-secondary);">${currentPrayer.text}</p>
                    `;
                }

                // REMOVED: Update Bead Name logic

                // REMOVED: Update SVG Highlighting logic

                // Handle button states
                prevBtn.disabled = (rosaryState.step === 0 && rosaryState.bead === 0);
                nextBtn.disabled = (rosaryState.step === 6 && rosaryState.bead === rosarySequence.conclusion.length - 1);

            } catch (e) {
                console.error("Error rendering Rosary player:", e);
                contentEl.innerHTML = `<p class="text-center text-red-600">An error occurred while loading the prayer. Please close and try again.</p>`;
            }
        }

        window.rosaryNext = function() {
            let step = rosaryState.step;
            let bead = rosaryState.bead;
            
            if (step === 0) { // Intro
                if (bead < rosarySequence.intro.length - 1) {
                    rosaryState.bead++;
                } else {
                    rosaryState.step = 1;
                    rosaryState.bead = 0;
                }
            } else if (step >= 1 && step <= 5) { // Decades
                if (bead < rosarySequence.decade.length - 1) {
                    rosaryState.bead++;
                } else {
                    if (step < 5) { // Move to next decade
                        rosaryState.step++;
                        rosaryState.bead = 0;
                    } else { // Move to conclusion
                        rosaryState.step = 6;
                        rosaryState.bead = 0;
                    }
                }
            } else { // Conclusion
                if (bead < rosarySequence.conclusion.length - 1) {
                    rosaryState.bead++;
                }
            }
            renderRosaryPlayer();
        }

        window.rosaryPrev = function() {
            let step = rosaryState.step;
            let bead = rosaryState.bead;

            if (step === 0) { // Intro
                if (bead > 0) {
                    rosaryState.bead--;
                }
            } else if (step >= 1 && step <= 5) { // Decades
                if (bead > 0) {
                    rosaryState.bead--;
                } else {
                    if (step > 1) { // Go to previous decade's end
                        rosaryState.step--;
                        rosaryState.bead = rosarySequence.decade.length - 1;
                    } else { // Go to intro's end
                        rosaryState.step = 0;
                        rosaryState.bead = rosarySequence.intro.length - 1;
                    }
                }
            } else { // Conclusion
                if (bead > 0) {
                    rosaryState.bead--;
                } else { // Go to last decade's end
                    rosaryState.step = 5;
                    rosaryState.bead = rosarySequence.decade.length - 1;
                }
            }
            renderRosaryPlayer();
        }
        
        // --- END ROSARY LOGIC (REMOVED OLD FUNCTIONS) ---

        /**
         * Function to determine Liturgical details based on the current date.
         * Now uses 2025 key dates for accurate Ordinary Time week calculation.
         */
        function getLiturgicalInfo(date) {
            const day = date.getDate();
            const month = date.getMonth(); // 0-11
            const year = date.getFullYear();
            const dayOfWeek = date.getDay(); // 0=Sunday, 6=Saturday
            
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            let dayName = days[dayOfWeek];
            const isSunday = dayOfWeek === 0;

            let color = 'green';
            let season = 'Ordinary Time'; // Default season
            let feast = '';
            let readingCycle = ''; // A, B, C
            // Year I (Odd) - 2025, Year II (Even) - 2024, 2026
            const weekdayReadingYear = (year % 2 === 0) ? 'II' : 'I'; 

            // --- 1. Key Liturgical Dates for 2025 (Fixed for accuracy) ---
            // Normalize comparison by setting hours to 12:00:00 to avoid timezone issues
            const compareDate = new Date(date.setHours(12, 0, 0, 0));
            
            // Standard Dates (Fixed within the year)
            const christmasDay = new Date(year, 11, 25); 
            const epiphany = new Date(year, 0, 6); 

            // Anchor Dates for 2025 (Year C/I)
            const advent1_2024 = new Date(2024, 11, 1); // Dec 1, 2024
            const baptismOfLord = new Date(year, 0, 12); // Jan 12, 2025 (End of Christmas, Start of OT Week 1)
            const ashWednesday = new Date(year, 2, 5); // Mar 5, 2025
            const easterSunday = new Date(year, 3, 20); // April 20, 2025
            const pentecost = new Date(year, 5, 8); // June 8, 2025
            const trinitySunday = new Date(year, 5, 15); // June 15, 2025 (Start of OT Week 11)
            const christTheKing = new Date(year, 10, 23); // Nov 23, 2025 (End of OT Week 34)
            const advent1_2025 = new Date(year, 11, 30); // Nov 30, 2025 (Start of Advent Year A)


            // --- 2. Determine Liturgical Cycle (A, B, C) ---
            if (compareDate >= advent1_2024 && compareDate < advent1_2025) {
                // Dec 1, 2024 - Nov 29, 2025
                readingCycle = 'C'; 
            } else {
                // After Nov 30, 2025
                readingCycle = 'A'; 
            }
            
            
            // --- 3. Determine Season and Feasts (Priority: Special Feasts > Major Seasons > Ordinary Time) ---
            
            // --- NEW: Check for a saint's day first from the database ---
            const saintInfo = saintsDB.find(s => s.month === month + 1 && s.day === day);
            if (saintInfo && saintInfo.rank === 'Solemnity') {
                season = 'Solemnity';
                feast = 'Solemnity of All Saints';
                
                return { 
                    color, 
                    season, 
                    feast, 
                    readingCycle: 'Proper', 
                    reflectionTitle: 'The Beatitudes: The Blueprint for Holiness', 
                    reflection: 'Today, on the **Solemnity of All Saints**, we contemplate the Beatitudes ($$\\text{Matt 5:1-12a}$$), the very blueprint for a life of holiness. The Saints are those who lived this perfect life, embracing poverty in spirit, mourning, and hungering for righteousness. Their example shows us that sanctity is attainable through simple acts of faith, hope, and charity, even amidst great trial. How can you live one of the Beatitudes more deeply today? The grace of God is sufficient for all of us.', 
                    readings: {
                        first: `Revelation 7:2-4, 9-14: After this I had a vision of a great multitude, which no one could count, from every nation, race, people, and tongue. They stood before the throne and before the Lamb, wearing white robes, and holding palm branches in their hands, and they cried out in a loud voice, "Salvation belongs to our God who is seated on the throne, and to the Lamb."`,
                        psalm: `Psalm 24: Lord, this is the people that longs to see your face.`,
                        second: `1 John 3:1-3: Beloved, we are Gods children now; what we shall be has not yet been revealed; what we do know is this: that when it is revealed, we will be like him, for we will see him as he is. Everyone who has this hope based on him makes himself pure, as he is pure.`,
                        gospel: `Matthew 5:1-12a: When Jesus saw the crowds, he went up the mountain, and after he sat down, his disciples came to him. He began to teach them, saying: Blessed are the poor in spirit, for theirs is the kingdom of heaven. Blessed are they who mourn, for they will be comforted..."`,
                    },
                    collectPrayer: `Almighty ever-living God, by whose gift we venerate in one celebration the merits of all the Saints, bestow on us, we pray, through the multitude of those intercessors, an abundance of your reconciliation, that, ever longing for the life to come, we may pass with security from this present time to the life everlasting. Through our Lord Jesus Christ, your Son, who lives and reigns with you in the unity of the Holy Spirit, God, for ever and ever.`,
                    // NEW PRAYERS FOR ALL SAINTS
                    preface: 'It is truly right and just, our duty and our salvation, always and everywhere to give you thanks, Lord, holy Father, almighty and eternal God. For today by your gift we celebrate the festival of your city, the heavenly Jerusalem, our mother, where the array of our-brothers and sisters already gives you eternal praise.',
                    prayerOverOfferings: 'May these offerings we bring in honor of all the Saints be pleasing to you, O Lord, and grant that, assured of their loving help, we may be preserved from all adversity. Through Christ our Lord.',
                    prayerAfterCommunion: 'As we adore you, O God, who alone are holy and wonderful in all your Saints, we implore your grace, so that, coming to perfect holiness in the fullness of your love, we may pass from this table of the new covenant to the banquet of our heavenly homeland. Through Christ our Lord.',
                    dailyVerse: { text: "Let your hearts be full of joy, for your reward in heaven is great.", citation: "Matthew 5:12" },
                };
            }
            
            // --- Advent Season (Nov 30, 2025 onwards) ---
            if (compareDate >= advent1_2025) {
                season = 'Advent';
                color = 'violet'; 
                
                const daysIntoAdvent = Math.floor((compareDate - advent1_2025) / (1000 * 60 * 60 * 24));
                const weekNumber = Math.floor(daysIntoAdvent / 7) + 1; // 1 to 4
                
                if (isSunday) {
                    feast = `${getOrdinal(weekNumber)} Sunday of Advent, Year A`;
                } else {
                    feast = `${dayName} of the ${getOrdinal(weekNumber)} Week of Advent`;
                }
                
                return getDefaultContent(date, color, season, feast, 'A', 'I');
            }

            // --- Christmas Season (Dec 25 - Jan 12) ---
            if (month === 0 && compareDate < baptismOfLord) {
                season = 'Christmas';
                color = 'white';
                
                if (compareDate.toDateString() === epiphany.toDateString()) {
                     feast = 'The Epiphany of the Lord';
                } else if (dayOfWeek === 0) { // All Sundays after Jan 6 but before Baptism are the "Sunday after Epiphany"
                     feast = 'Sunday after the Epiphany';
                } else {
                     feast = `${dayName} in the Christmas Season`;
                }
                return getDefaultContent(date, color, season, feast, 'C', 'I');
            }
            // Note: Christmas Day (Dec 25) is handled by the Advent check from last year.

            // --- Lent & Easter Season (Roughly Mar 5 - Jun 14) ---
            if (compareDate >= ashWednesday && compareDate < trinitySunday) {
                if (compareDate < easterSunday) {
                    season = 'Lent';
                    color = 'violet';
                    
                    if (compareDate.toDateString() === ashWednesday.toDateString()) {
                        feast = 'Ash Wednesday';
                    } else if (compareDate >= new Date(year, 3, 13) && compareDate < easterSunday) { // Holy Week: April 13 (Palm Sunday) to April 19 (Holy Saturday)
                        color = 'red'; // Palm Sunday, Good Friday
                        season = 'Holy Week';
                        feast = `${dayName} of Holy Week`;
                    } else {
                        // Days in Lent
                        const daysIntoLent = Math.floor((compareDate - ashWednesday) / (1000 * 60 * 60 * 24));
                        const weekNumber = Math.floor(daysIntoLent / 7) + 1;
                        if (isSunday) { // Corrected to use getOrdinal
                            feast = `${getOrdinal(weekNumber)} Sunday of Lent, Year C`;
                        } else { // Corrected to use getOrdinal
                            feast = `${dayName} of the ${getOrdinal(weekNumber)} Week of Lent`;
                        }
                    }

                } else { // After Easter
                    season = 'Easter';
                    color = 'white';
                    
                    if (compareDate.toDateString() === easterSunday.toDateString()) {
                        feast = 'Easter Sunday: The Resurrection of the Lord';
                    } else if (compareDate.toDateString() === pentecost.toDateString()) {
                         color = 'red';
                         feast = 'Pentecost Sunday';
                    } else {
                         // Easter Season (50 days)
                         const daysAfterEaster = Math.floor((compareDate - easterSunday) / (1000 * 60 * 60 * 24));
                         const weekNumber = Math.floor(daysAfterEaster / 7) + 1;
                         if (isSunday) { // Corrected to use getOrdinal
                             feast = `${getOrdinal(weekNumber)} Sunday of Easter, Year C`;
                         } else { // Corrected to use getOrdinal
                             feast = `${dayName} of the ${getOrdinal(weekNumber)} Week of Easter`;
                         }
                    }
                }
                return getDefaultContent(date, color, season, feast, 'C', 'I');
            }


            // --- Ordinary Time Logic (The 34 Weeks) ---
            let ferialInfo = {}; // To store the base day info
            let ordinaryWeek = 0;
            
            // Part 1: Ordinary Time before Lent (Weeks 2-9)
            // OT Week 2 starts Jan 19. Week 9 ends Mar 1.
            if (compareDate >= baptismOfLord && compareDate < ashWednesday) {
                // Calculate weeks past the Baptism of the Lord (Jan 12, 2025)
                const referenceSunday = new Date(year, 0, 19); // OT Week 2 starts here
                const weeksPassed = Math.floor((compareDate - referenceSunday) / (1000 * 60 * 60 * 24 * 7));
                ordinaryWeek = weeksPassed + 2; // +2 because Jan 19 is Week 2
            } 
            // Part 2: Ordinary Time after Pentecost (Weeks 11-34)
            // OT Week 11 starts on Trinity Sunday (June 15, 2025)
            else if (compareDate >= trinitySunday && compareDate < advent1_2025) {
                const referenceSunday = trinitySunday;
                const weeksPassed = Math.floor((compareDate - referenceSunday) / (1000 * 60 * 60 * 24 * 7));
                ordinaryWeek = weeksPassed + 11; 
                
                if (ordinaryWeek > 34) ordinaryWeek = 34; 
            }
            
            // Final check and assignment for Ordinary Time
            if (ordinaryWeek > 0) {
                season = 'Ordinary Time';
                color = 'green';
                
                if (isSunday) {
                    if (ordinaryWeek === 34) {
                        feast = `Solemnity of Our Lord Jesus Christ, King of the Universe, Year ${readingCycle}`;
                        season = 'Solemnity'; // This is a solemnity
                    } else {
                        feast = `${getOrdinal(ordinaryWeek)} Sunday in Ordinary Time, Year ${readingCycle}`;
                    }
                } else {
                    feast = `${dayName} of the ${getOrdinal(ordinaryWeek)} Week in Ordinary Time`;
                }
                
                // Store this as the base ferial day information
                ferialInfo = {
                    name: feast,
                    color: color,
                    season: season,
                    cycle: `Year ${readingCycle}(${weekdayReadingYear})`
                };
            }

            // --- FINAL STEP: Combine Ferial and Saint Info ---
            if (saintInfo) {
                // If we found a saint, return a combined object
                return { ferial: ferialInfo, saint: saintInfo, ...getDefaultContent(date, color, season, feast, readingCycle, weekdayReadingYear) };
            } else if (ferialInfo.name) {
                // If no saint but it's a valid ferial day, return that
                return { ferial: ferialInfo, ...getDefaultContent(date, color, season, feast, readingCycle, weekdayReadingYear) };
            }
            
            // Default Fallback
            feast = `Feast of the Presentation of the Lord`;
            return getDefaultContent(date, 'white', 'Proper', feast, 'Proper', weekdayReadingYear); 
        }

        
        // --- NEW FUNCTION TO FIX REFERENCEERROR ---
        // This function provides default "placeholder" content for any day.
        function getDefaultContent(date, color, season, feast, readingCycle, weekdayReadingYear) {
            const isSunday = date.getDay() === 0;
            const cycleText = isSunday ? `Year ${readingCycle}` : `Year ${weekdayReadingYear}`;
            const secondReading = (isSunday && season !== 'Lent' && season !== 'Advent') ? `Second Reading (${cycleText}): Second reading text for this day is not yet available.` : null;

            return {
                color,
                season,
                feast,
                readingCycle: cycleText,
                reflectionTitle: `Reflection for ${feast}`,
                reflection: `This is a placeholder reflection for the **${feast}**. Content for this day is being prepared. Today we celebrate the **${season}** season. May God bless your day.`,
                readings: {
                    first: `First Reading (${cycleText}): Reading text for this day is not yet available.`,
                    psalm: `Responsorial Psalm (${cycleText}): Psalm text for this day is not yet available.`,
                    second: secondReading,
                    gospel: `Gospel (${cycleText}): Gospel text for this day is not yet available.`
                },
                collectPrayer: `O God, who... (This is a placeholder Collect for the ${feast}). We ask this through our Lord Jesus Christ, your Son, who lives and reigns with you in the unity of the Holy Spirit, God, for ever and ever.`,
                // NEW: Default prayers for Mass
                preface: `This is a placeholder Preface for the ${feast}.`,
                prayerOverOfferings: `This is a placeholder Prayer Over the Offerings for the ${feast}.`,
                prayerAfterCommunion: `This is a placeholder Prayer After Communion for the ${feast}.`,
                dailyVerse: { text: "This is the day the Lord has made; let us rejoice and be glad in it.", citation: "Psalm 118:24" },
            };
        }
        // --- END NEW FUNCTION ---

        
        function updateHeaderAndHomeContent(date) {
            const info = getLiturgicalInfo(date);
            const isSunday = date.getDay() === 0;

            // 1. Update Header Date
            document.getElementById('date-of-day').textContent = formattedDate(date);

            // 2. Update Liturgical Details (Color, Feast)
            const detailsElement = document.getElementById('liturgical-details');
            let detailsHtml = '';
 
            // NEW LOGIC based on user's requested format
            if (info.saint && (info.saint.rank === 'Solemnity' || info.saint.rank === 'Feast')) {
                // Format for Solemnity or Feast
                const saintColor = info.saint.rank === 'Solemnity' ? 'white' : (info.saint.color || 'red'); // Default feast to red if not specified
                const cycle = info.ferial.cycle || `Year ${info.readingCycle}(${info.weekdayReadingYear})`;
                detailsHtml = `
                    <div class="text-center">
                        <span class="font-semibold text-gray-800">${info.saint.rank} of ${info.saint.name}, ${cycle}</span>
                        <span class="color-circle color-${saintColor}"></span>
                    </div>`;
            } else if (info.saint && info.saint.rank === 'Memorial') {
                // Format for Memorial
                const saintColor = info.saint.color || 'white'; // Default memorial to white
                const ferialName = info.ferial.name || '';
                const cycle = info.ferial.cycle || `Year ${info.readingCycle}(${info.weekdayReadingYear})`;
                detailsHtml = `
                    <div class="text-center leading-tight">
                        <span class="font-semibold text-gray-800">Memorial of ${info.saint.name}</span>
                        <span class="color-circle color-${saintColor}"></span>
                        <br>
                        <span class="font-normal text-gray-600">on ${ferialName}, ${cycle}</span>
                    </div>`;
            } else if (info.saint && info.saint.rank === 'Optional Memorial') {
                // Format for Optional Memorial
                const saintColor = info.saint.color || 'white';
                const ferialName = info.ferial.name || '';
                const ferialColor = info.ferial.color || 'green';
                const cycle = info.ferial.cycle || `Year ${info.readingCycle}(${info.weekdayReadingYear})`;
                detailsHtml = `
                    <div class="text-center leading-tight">
                        <span class="font-semibold text-gray-800">${ferialName}, ${cycle}</span>
                        <span class="color-circle color-${ferialColor}"></span>
                        <br>
                        <span class="font-normal text-gray-600">or Optional Memorial of ${info.saint.name}</span>
                        <span class="color-circle color-${saintColor}"></span>
                    </div>`;
            } else if (info.ferial && info.ferial.name) {
                // Format for a regular ferial day
                const ferialName = info.ferial.name;
                const ferialColor = info.ferial.color || 'green';
                const cycle = info.ferial.cycle || `Year ${info.readingCycle}(${info.weekdayReadingYear})`;
                detailsHtml = `
                    <div class="text-center">
                        <span class="font-semibold text-gray-800">${ferialName}, ${cycle}</span>
                        <span class="color-circle color-${ferialColor}"></span>
                    </div>`;
            } else {
                // Fallback for days without specific info (should be rare)
                detailsHtml = `<div class="text-center"><span class="font-semibold text-gray-800">${info.feast}</span></div>`;
            }

            detailsElement.innerHTML = detailsHtml;

            // 3. Update Home View Content (if the page is 'home')
            if (currentPage === 'home') {
                // Reflection (Home View - Truncated)
                document.getElementById('reflection-home-title').textContent = info.reflectionTitle; 
                const twoLinesText = info.reflection.replace(/\*\*/g, '').replace(/(\r\n|\n|\r)/gm, " ").trim();
                const truncatedText = twoLinesText.split(' ').slice(0, 25).join(' ') + '...';
                document.getElementById('reflection-text').innerHTML = `<p>${truncatedText}</p>`;
                
                // Readings (Home View - Truncated)
                const firstReadingData = getCitationAndText(info.readings.first);
                const gospelData = getCitationAndText(info.readings.gospel); 

                const readingsHtml = `
                    <div class="space-y-2 text-sm">
                        <p class="font-bold text-gray-700">First Reading: <span class="font-normal">${firstReadingData.citation}</span></p>
                        <p class="text-gray-600 truncate-3-lines">${firstReadingData.text}</p>
                        
                        <p class="font-bold text-gray-700 pt-2 border-t">Gospel: <span class="font-normal">${gospelData.citation}</span></p>
                        <p class="text-gray-600 truncate-3-lines">${gospelData.text}</p>
                    </div>
                `;
                document.getElementById('readings-content').innerHTML = readingsHtml;
                
                // Mass Today Summary 
                document.getElementById('mass-today-title').textContent = 'Mass Today: ' + info.feast.split(',')[0].trim();
                document.getElementById('mass-prayers-summary').innerHTML = `
                    Today's mass uses the prayers for the **${info.feast}** (${info.color} vestments). Includes the Collect, Prayer over the Offerings, and Prayer after Communion, adapted for this day.
                `;
                
                // Daily Verse
                document.getElementById('daily-verse').innerHTML = `
                    <p class="font-medium leading-normal" style="color: var(--color-text-secondary);">"${info.dailyVerse.text}"</p>
                    <span class="text-sm font-semibold text-emerald-600 block mt-2"> ${info.dailyVerse.citation}</span>
                `;

                // Daily Prayer
                document.getElementById('daily-prayer').innerHTML = ` 
                    <p class="font-medium text-gray-700">${info.collectPrayer.split('.').slice(0, 1).join('.')}.</p>
                    <p class="font-medium text-gray-700">${info.collectPrayer}</p>
                `;
            }
        }


        // --- FULL PAGE CONTENT GENERATORS ---

        function getCalendarHtmlTemplate() {
            return `
                <div id="calendar-widget" class="w-full max-w-lg mx-auto p-4 rounded-xl shadow-2xl mt-10" style="background-color: var(--color-card-bg);">
                    <div class="flex items-center justify-between mb-3 border-b pb-2">
                        <!-- Prev Month Button -->
                        <button onclick="handleMonthChange(-1, 'calendar-days-grid', 'calendar-month-year')" class="p-1 rounded hover:bg-gray-100 transition text-gray-700" aria-label="Previous Month">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                        </button>
                        <!-- Month Name -->
                        <span id="calendar-month-year" class="font-semibold text-lg text-gray-800"></span>
                        <!-- Next Month Button -->
                        <button onclick="handleMonthChange(1, 'calendar-days-grid', 'calendar-month-year')" class="p-1 rounded hover:bg-gray-100 transition text-gray-700" aria-label="Next Month">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                        </button>
                    </div>
                    <div class="grid grid-cols-7 gap-1 text-center text-xs font-medium text-gray-500">
                        <span>Sun</span><span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span>
                    </div>
                    <!-- Calendar Grid -->
                    <div id="calendar-days-grid" class="grid grid-cols-7 gap-1 mt-2 text-sm">
                        <!-- Days will be generated here -->
                    </div>
                </div>
            `;
        }


        // NEW: Full Order of Mass Content Generator
        function getFullOrderOfMassContent(info) {
            // Date navigation
            const dateObj = new Date(currentlyLoadedDate);
            const prevDateTs = new Date(dateObj).setDate(dateObj.getDate() - 1);
            const nextDateTs = new Date(dateObj).setDate(dateObj.getDate() + 1);

            // NEW: Dynamic Title
            const isCurrent = isToday(currentlyLoadedDate);
            const mainTitle = isCurrent ? "Mass Today" : "Order of Mass";

            return `
            <!-- Top Navigation Header -->
            <div class="flex items-center justify-between bg-sky-100 p-4 rounded-xl shadow-md mb-6 border-b-2 border-sky-600" style="background-color: var(--color-card-bg);">
                <button onclick="handleDateSelect(${prevDateTs}, 'ordermass')" class="flex items-center p-2 text-sky-600 hover:text-sky-800 transition" aria-label="Previous Day">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path></svg>
                </button>
                <div class="text-center">
                    <h2 class="text-2xl font-bold text-gray-800 text-center">${mainTitle}</h2>
                    <p class="text-sm font-semibold text-sky-700">${info.feast}</p>
                </div>
                <button onclick="handleDateSelect(${nextDateTs}, 'ordermass')" class="flex items-center p-2 text-sky-600 hover:text-sky-800 transition" aria-label="Next Day">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path></svg>
                </button>
            </div>

            <div class="space-y-6">
                
                <!-- Introductory Rites -->
                <section class="mass-section">
                    <h3 class="mass-section-title">Introductory Rites</h3>
                    <div class="mass-prayer-body">
                        <p>Sign of the Cross</p>
                        <p>Greeting</p>
                        <p>Penitential Act</p>
                        <p>Kyrie Eleison (Lord, have mercy)</p>
                        ${(info.season !== 'Advent' && info.season !== 'Lent' && (info.season.includes('Sunday') || info.season.includes('Solemnity'))) ? '<p class="font-semibold">Gloria in Excelsis (Glory to God in the highest)</p>' : ''}
                        <hr class="my-3">
                        <h4 class="mass-prayer-title">Collect</h4>
                        <p class="mass-prayer-text">${info.collectPrayer}</p>
                    </div>
                </section>
                
                <!-- Liturgy of the Word -->
                <section class="mass-section">
                    <h3 class="mass-section-title">Liturgy of the Word</h3>
                    <div class="mass-prayer-body">
                        <p>First Reading: <a href="#" onclick="switchPage('readings'); return false;" class="text-sky-600 hover:underline">${getCitationAndText(info.readings.first).citation}</a></p>
                        <p>Responsorial Psalm: <a href="#" onclick="switchPage('readings'); return false;" class="text-sky-600 hover:underline">${getCitationAndText(info.readings.psalm).citation}</a></p>
                        ${info.readings.second ? `<p>Second Reading: <a href="#" onclick="switchPage('readings'); return false;" class="text-sky-600 hover:underline">${getCitationAndText(info.readings.second).citation}</a></p>` : ''}
                        <p>Gospel Acclamation</p>
                        <p>Gospel: <a href="#" onclick="switchPage('readings'); return false;" class="text-sky-600 hover:underline">${getCitationAndText(info.readings.gospel).citation}</a></p>
                        <p>Homily</p>
                        ${(info.season.includes('Sunday') || info.season.includes('Solemnity')) ? '<p class="font-semibold">Creed (Profession of Faith)</p>' : ''}
                        <p>Universal Prayer (Prayer of the Faithful)</p>
                    </div>
                </section>
                
                <!-- Liturgy of the Eucharist -->
                <section class="mass-section">
                    <h3 class="mass-section-title">Liturgy of the Eucharist</h3>
                    <div class="mass-prayer-body">
                        <h4 class="mass-prayer-title">Prayer over the Offerings</h4>
                        <p class="mass-prayer-text">${info.prayerOverOfferings}</p>
                        <hr class="my-3">
                        <h4 class="mass-prayer-title">Preface</h4>
                        <p class="mass-prayer-text">${info.preface}</p>
                        <hr class="my-3">
                        <p>Sanctus (Holy, Holy, Holy)</p>
                        <p>Eucharistic Prayer</p>
                        <p>The mystery of faith</p>
                        <p>Great Amen</p>
                        <h4 class="mass-prayer-title pt-3">Communion Rite</h4>
                        <p>The Lord's Prayer</p>
                        <p>Sign of Peace</p>
                        <p>Agnus Dei (Lamb of God)</p>
                        <p>Communion</p>
                        <hr class="my-3">
                        <h4 class="mass-prayer-title">Prayer after Communion</h4>
                        <p class="mass-prayer-text">${info.prayerAfterCommunion}</p>
                    </div>
                </section>
                
                <!-- Concluding Rites -->
                <section class="mass-section">
                    <h3 class="mass-section-title">Concluding Rites</h3>
                    <div class="mass-prayer-body">
                        <p>Greeting and Final Blessing</p>
                        <p>Dismissal</p>
                    </div>
                </section>
            </div>
            ${getCalendarHtmlTemplate()}
            `;
        }

        // NEW: General (Static) Order of Mass Content Generator
        function getGeneralOrderOfMassContent() {
            return `
            <!-- Top Navigation Header --> 
            <div class="bg-sky-100 p-4 rounded-xl shadow-md mb-6 border-b-2 border-sky-600">
                <div class="text-center">
                    <h2 class="text-2xl font-bold text-gray-800 text-center">Order of Mass</h2>
                    <p class="text-sm font-semibold text-sky-700">The general structure of the Catholic Mass</p>
                </div>
            </div>

            <div class="space-y-6">
                
                <!-- Introductory Rites -->
                <section class="mass-section">
                    <h3 class="mass-section-title">Introductory Rites</h3>
                    <div class="mass-prayer-body">
                        <p>The purpose of the Introductory Rites is to bring the assembled people together as a community and prepare them to listen to Gods Word and celebrate the Eucharist.</p>
                        <ul class="list-disc list-inside mt-2 space-y-1">
                            <li>Entrance Procession and Hymn</li>
                            <li>Sign of the Cross and Greeting</li>
                            <li>Penitential Act (e.g., Confiteor)</li>
                            <li>Kyrie Eleison (Lord, have mercy)</li>
                            <li>Gloria (Glory to God in the highest) - *Sung or recited on Sundays (outside of Advent and Lent), Solemnities, and Feasts.*</li>
                            <li>Collect (Opening Prayer)</li>
                        </ul>
                    </div>
                </section>
                
                <!-- Liturgy of the Word -->
                <section class="mass-section">
                    <h3 class="mass-section-title">Liturgy of the Word</h3>
                    <div class="mass-prayer-body">
                        <p>In this part of the Mass, we listen to readings from Sacred Scripture, which are followed by a homily, the Profession of Faith, and the Universal Prayer.</p>
                        <ul class="list-disc list-inside mt-2 space-y-1">
                            <li>First Reading (Typically from the Old Testament)</li>
                            <li>Responsorial Psalm</li>
                            <li>Second Reading (Typically from the New Testament Epistles) - *Recited on Sundays and Solemnities.*</li>
                            <li>Gospel Acclamation (Alleluia)</li>
                            <li>Gospel Reading</li>
                            <li>Homily</li>
                            <li>Creed (Profession of Faith) - *Recited on Sundays and Solemnities.*</li>
                            <li>Universal Prayer (Prayer of the Faithful)</li>
                        </ul>
                    </div>
                </section>
                
                <!-- Liturgy of the Eucharist -->
                <section class="mass-section">
                    <h3 class="mass-section-title">Liturgy of the Eucharist</h3>
                    <div class="mass-prayer-body">
                        <p>This is the central part of the Mass, where the bread and wine are offered and become the Body and Blood of Christ through the power of the Holy Spirit.</p>
                        
                        <h4 class="mass-prayer-title mt-4">1. Preparation of the Gifts</h4>
                        <ul class="list-disc list-inside space-y-1">
                            <li>Offertory Procession and Hymn</li>
                            <li>Presentation of the Gifts (Bread and Wine)</li>
                            <li>Prayer over the Offerings</li>
                        </ul>

                        <h4 class="mass-prayer-title mt-4">2. Eucharistic Prayer (The Anaphora)</h4>
                        <ul class="list-disc list-inside space-y-1">
                            <li>Preface</li>
                            <li>Sanctus (Holy, Holy, Holy)</li>
                            <li>Epiclesis (Calling down the Holy Spirit)</li>
                            <li>Institution Narrative and Consecration</li>
                            <li>The Mystery of Faith (Memorial Acclamation)</li>
                            <li>Anamnesis (Remembrance), Oblation (Offering), and Intercessions</li>
                            <li>Doxology (Through him, and with him, and in him...)</li>
                            <li>Great Amen</li>
                        </ul>

                        <h4 class="mass-prayer-title mt-4">3. Communion Rite</h4>
                        <ul class="list-disc list-inside space-y-1">
                            <li>The Lord's Prayer (Our Father)</li>
                            <li>Sign of Peace</li>
                            <li>Agnus Dei (Lamb of God)</li>
                            <li>Communion</li>
                            <li>Hymn or Period of Silence</li>
                            <li>Prayer after Communion</li>
                        </ul>
                    </div>
                </section>
                
                <!-- Concluding Rites -->
                <section class="mass-section">
                    <h3 class="mass-section-title">Concluding Rites</h3>
                    <div class="mass-prayer-body">
                        <p>The final part of the Mass sends the people forth to do good works, praising and blessing the Lord.</p>
                        <ul class="list-disc list-inside mt-2 space-y-1">
                            <li>Announcements (if any)</li>
                            <li>Greeting and Final Blessing</li>
                            <li>Dismissal ("Go in peace," "Thanks be to God.")</li>
                            <li>Recessional Hymn (optional)</li>
                        </ul>
                    </div>
                </section>
            </div>
            `;
        }


        function getFullReflectionContent(info) {
            const isCurrent = isToday(currentlyLoadedDate);
            
            const bodyText = info.reflection
                .replace(/\n/g, '<br>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>'); 

            // Date navigation timestamps
            const dateObj = new Date(currentlyLoadedDate);
            const dateTs = dateObj.getTime();
            const prevDateTs = new Date(dateObj).setDate(dateObj.getDate() - 1);
            const nextDateTs = new Date(dateObj).setDate(dateObj.getDate() + 1);

            // Get today's date for the cross-link target
            const today = new Date();

            return `
                <!-- Top Navigation Header -->
                <div class="flex items-center justify-between bg-violet-100 p-4 rounded-xl shadow-md mb-6 border-b-2 border-violet-600" style="background-color: var(--color-card-bg);">
                    <button onclick="handleDateSelect(${prevDateTs}, 'reflections')" class="flex items-center p-2 text-violet-600 hover:text-violet-800 transition duration-150 font-semibold" aria-label="Previous Day">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path></svg>
                    </button>
                    <!-- Title is now the specific reflection title -->
                    <h2 class="text-2xl font-bold text-gray-800 text-center">${info.reflectionTitle}</h2>
                    <button onclick="handleDateSelect(${nextDateTs}, 'reflections')" class="flex items-center p-2 text-violet-600 hover:text-violet-800 transition duration-150 font-semibold" aria-label="Next Day">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2004/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path></svg>
                    </button>
                </div>

                <!-- Media and Link Access -->
                <div class="flex flex-wrap justify-center gap-4 mb-8">
                    <button onclick="console.log('Load Audio for Reflection')" class="flex items-center text-sm px-4 py-2 bg-gray-200 text-gray-700 font-semibold rounded-full hover:bg-gray-300 transition duration-150 shadow-md">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6a2 2 0 00-2-2H5a2 2 0 00-2 2v13a2 2 0 002 2h4zm-2 0V6m8 13V6a2 2 0 012-2h2a2 2 0 012 2v13a2 2 0 01-2 2h-4z"></path></svg>
                        Listen to Reflection
                    </button>
                    <button onclick="console.log('Load Video for Reflection')" class="flex items-center text-sm px-4 py-2 bg-gray-200 text-gray-700 font-semibold rounded-full hover:bg-gray-300 transition duration-150 shadow-md">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                        Watch Reflection
                    </button>
                    <!-- Link to Today's Readings -->
                    <a href="#" onclick="handleDateSelect(${today.getTime()}, 'readings'); return false;" class="flex items-center text-sm px-4 py-2 bg-violet-600 text-white font-semibold rounded-full hover:bg-violet-700 transition duration-150 shadow-md">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13M3.25 9.75h17.5M3.25 15.75h17.5"></path></svg>
                        See Readings for Today
                    </a>
                </div>

                <!-- Reflection Body -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-violet-600" style="background-color: var(--color-card-bg);">
                    <h3 class="text-xl sm:text-2xl font-bold text-gray-800 mb-4">Reflection on ${info.feast}</h3>
                    <div class="text-base text-gray-600 leading-relaxed space-y-4">
                        <p>${bodyText}</p>
                        <p class="mt-4 text-sm text-gray-500 italic">May the Holy Spirit guide your prayer and meditation on this reflection.</p>
                    </div>
                </section>
                
                ${getCalendarHtmlTemplate()}
            `;
        }

        function getFullReadingsContent(info) {
            const firstReadingData = getCitationAndText(info.readings.first);
            const psalmData = getCitationAndText(info.readings.psalm);
            const secondReadingData = info.readings.second ? getCitationAndText(info.readings.second) : null;
            const gospelData = getCitationAndText(info.readings.gospel);

            const isCurrent = isToday(currentlyLoadedDate);
            
            // NEW: Determine which set of readings to use and set the correct title
            let activeReadings;
            let activeTitle;
            if (readingsView === 'memorial' && info.saint && info.saint.properReadings) {
                activeReadings = info.saint.properReadings;
                // Use the memorial's name for the title
                activeTitle = `Readings for the ${info.saint.rank} of ${info.saint.name}`;
            } else {
                activeReadings = info.readings;
                // Use the ferial day's name for the title
                const cycle = info.ferial.cycle || `Year ${info.readingCycle}(${info.weekdayReadingYear})`;
                activeTitle = `Readings for ${info.ferial.name}, ${cycle}`;
            }
            
            // 1. Title logic updated:
            const mainTitle = isCurrent ? "Today's Readings" : "Readings";
            
            // Date navigation timestamps
            const dateObj = new Date(currentlyLoadedDate);
            const dateTs = dateObj.getTime();
            const prevDateTs = new Date(dateObj).setDate(dateObj.getDate() - 1);
            const nextDateTs = new Date(dateObj).setDate(dateObj.getDate() + 1);

            // 2. Media button logic updated:
            const mediaDateDisplay = isCurrent ? "" : " for " + formattedDate(currentlyLoadedDate, { weekday: false, year: 'numeric', month: 'long', day: 'numeric' });
            
            // Get today's date for the cross-link target
            const today = new Date();

            // NEW: Build the toggle for ferial/memorial readings if applicable
            // This rubric appears if there's a choice to be made.
            const dayName = currentlyLoadedDate.toLocaleDateString('en-US', { weekday: 'long' });
            const choiceRubric = (info.saint && info.saint.properReadings && info.saint.rank.includes('Memorial')) 
                ? `<p class="text-center text-sm italic text-red-600 mb-4">There is a choice between the readings for the ferial day (${dayName}) and those of the memorial. The ferial readings are recommended unless pastoral reasons suggest otherwise.</p>`
                : '';

            let readingsToggleHtml = '';
            if (info.saint && info.saint.properReadings) {
                readingsToggleHtml = `
                <div class="mb-6 text-center p-3 bg-gray-100 rounded-lg border">
                    <p class="text-sm font-medium text-gray-700 mb-2">This day has proper readings for the memorial. Choose which set to view:</p>
                    <div class="inline-flex rounded-md shadow-sm" role="group">
                        <button onclick="setReadingsView('ferial')" class="px-4 py-2 text-sm font-medium ${readingsView === 'ferial' ? 'bg-amber-600 text-white' : 'bg-white text-gray-900'} border border-gray-200 rounded-l-lg hover:bg-gray-100">
                            Ferial Readings
                        </button>
                        <button onclick="setReadingsView('memorial')" class="px-4 py-2 text-sm font-medium ${readingsView === 'memorial' ? 'bg-amber-600 text-white' : 'bg-white text-gray-900'} border border-gray-200 rounded-r-md hover:bg-gray-100">
                            Memorial Readings
                        </button>
                    </div>
                </div>`;
            }

            return `
                <!-- Top Navigation Header -->
                <div class="flex items-center justify-between bg-amber-100 p-4 rounded-xl shadow-md mb-6 border-b-2 border-amber-600" style="background-color: var(--color-card-bg);">
                    <button onclick="handleDateSelect(${prevDateTs}, 'readings')" class="flex items-center p-2 text-amber-600 hover:text-amber-800 transition duration-150 font-semibold" aria-label="Previous Day">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2004/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path></svg>
                    </button>
                    <!-- Simplified title as requested -->
                    <h2 class="text-2xl font-bold text-gray-800 text-center">${activeTitle}</h2>
                    <button onclick="handleDateSelect(${nextDateTs}, 'readings')" class="flex items-center p-2 text-amber-600 hover:text-amber-800 transition duration-150 font-semibold" aria-label="Next Day">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2004/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path></svg>
                    </button>
                </div>

                <!-- Media and Link Access -->
                <div class="flex flex-wrap justify-center gap-4 mb-8">
                    <!-- Audio Button -->
                    <button onclick="console.log('Load Audio for Readings')" class="flex items-center text-sm px-4 py-2 bg-gray-200 text-gray-700 font-semibold rounded-full hover:bg-gray-300 transition duration-150 shadow-md">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6a2 2 0 00-2-2H5a2 2 0 00-2 2v13a2 2 0 002 2h4zm-2 0V6m8 13V6a2 2 0 012-2h2a2 2 0 012 2v13a2 2 0 01-2 2h-4z"></path></svg>
                        Listen to Readings${mediaDateDisplay}
                    </button>
                    <!-- Link to Today's Reflection -->
                    <a href="#" onclick="handleDateSelect(${today.getTime()}, 'reflections'); return false;" class="flex items-center text-sm px-4 py-2 bg-violet-600 text-white font-semibold rounded-full hover:bg-violet-700 transition duration-150 shadow-md">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13M3.25 9.75h17.5M3.25 15.75h17.5"></path></svg>
                        See Reflection for Today
                    </a>
                </div>

                <!-- NEW: Readings Toggle -->
                ${choiceRubric}
                ${readingsToggleHtml} 

                <div class="space-y-6">
                    <!-- First Reading -->
                    <section class="p-6 rounded-xl shadow-lg border-t-4 border-amber-600" style="background-color: var(--color-card-bg);">
                        <p class="font-bold text-lg text-gray-800 mb-3">First Reading: <span class="font-normal">${getCitationAndText(activeReadings.first).citation}</span></p>
                        <p class="text-base text-gray-600 leading-relaxed mb-4">${getCitationAndText(activeReadings.first).text}</p>
                        <!-- NEW: Commentary Toggle for First Reading -->
                        <div class="mt-4 pt-4 border-t">
                            <div class="flex justify-between items-center">
                                <h4 class="text-md font-semibold text-gray-700">Commentary</h4>
                                <label for="commentary-toggle-1" class="flex items-center cursor-pointer">
                                    <div class="relative"><input type="checkbox" id="commentary-toggle-1" class="sr-only" onchange="document.getElementById('commentary-content-1').classList.toggle('hidden')"><div class="block bg-gray-600 w-14 h-8 rounded-full"></div><div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition"></div></div>
                                </label>
                            </div>
                            <div id="commentary-content-1" class="hidden mt-2">
                                <p class="text-sm text-gray-600 p-3 bg-gray-50 rounded-lg">Commentary for the First Reading is coming soon.</p>
                            </div>
                        </div>
                    </section>

                    <!-- Responsorial Psalm -->
                    <section class="p-6 rounded-xl shadow-lg border-t-4 border-amber-600" style="background-color: var(--color-card-bg);">
                        <p class="font-bold text-lg text-gray-800 mb-3">Responsorial Psalm: <span class="font-normal">${getCitationAndText(activeReadings.psalm).citation}</span></p>
                        <p class="text-base text-gray-600 leading-relaxed">${getCitationAndText(activeReadings.psalm).text.replace(/\n/g, '<br>')}</p>
                    </section>
                    
                    <!-- Second Reading (Conditional) -->
                    ${activeReadings.second ? `
                    <section class="p-6 rounded-xl shadow-lg border-t-4 border-amber-600" style="background-color: var(--color-card-bg);">
                        <p class="font-bold text-lg text-gray-800 mb-3">Second Reading: <span class="font-normal">${getCitationAndText(activeReadings.second).citation}</span></p>
                        <p class="text-base text-gray-600 leading-relaxed mb-4">${getCitationAndText(activeReadings.second).text}</p>
                        <!-- NEW: Commentary Toggle for Second Reading -->
                        <div class="mt-4 pt-4 border-t">
                            <div class="flex justify-between items-center">
                                <h4 class="text-md font-semibold text-gray-700">Commentary</h4>
                                <label for="commentary-toggle-2" class="flex items-center cursor-pointer">
                                    <div class="relative"><input type="checkbox" id="commentary-toggle-2" class="sr-only" onchange="document.getElementById('commentary-content-2').classList.toggle('hidden')"><div class="block bg-gray-600 w-14 h-8 rounded-full"></div><div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition"></div></div>
                                </label>
                            </div>
                            <div id="commentary-content-2" class="hidden mt-2">
                                <p class="text-sm text-gray-600 p-3 bg-gray-50 rounded-lg">Commentary for the Second Reading is coming soon.</p>
                            </div>
                        </div>
                    </section>
                    ` : ''}

                    <!-- Gospel -->
                    <section class="p-6 rounded-xl shadow-lg border-t-4 border-amber-600" style="background-color: var(--color-card-bg);">
                        <p class="font-bold text-lg text-gray-800 mb-3">Gospel: <span class="font-normal">${getCitationAndText(activeReadings.gospel).citation}</span></p>
                        <p class="text-base text-gray-600 leading-relaxed mb-4">${getCitationAndText(activeReadings.gospel).text}</p>
                        <!-- NEW: Commentary Toggle for Gospel -->
                        <div class="mt-4 pt-4 border-t">
                            <div class="flex justify-between items-center">
                                <h4 class="text-md font-semibold text-gray-700">Commentary</h4>
                                <label for="commentary-toggle-gospel" class="flex items-center cursor-pointer">
                                    <div class="relative"><input type="checkbox" id="commentary-toggle-gospel" class="sr-only" onchange="document.getElementById('commentary-content-gospel').classList.toggle('hidden')"><div class="block bg-gray-600 w-14 h-8 rounded-full"></div><div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition"></div></div>
                                </label>
                            </div>
                            <div id="commentary-content-gospel" class="hidden mt-2">
                                <p class="text-sm text-gray-600 p-3 bg-gray-50 rounded-lg">Commentary for the Gospel is coming soon.</p>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- NEW: Longer Passages Section -->
                <div class="mt-8 p-6 rounded-xl shadow-lg border-t-4 border-gray-400" style="background-color: var(--color-card-bg);">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-xl font-semibold text-gray-800">Longer Passages</h3>
                            <p class="text-sm italic text-red-600 mt-2">For practical Reasons, the readings at Mass are relatively short while the First Readings in the Office of the Readings are longer. In case you find them useful for private study, here are passages from the Office of the Readings that contain the readings you have just heard at Mass.</p>
                        </div>
                        <label for="longer-passages-toggle" class="flex items-center cursor-pointer">
                            <div class="relative">
                                <input type="checkbox" id="longer-passages-toggle" class="sr-only" onchange="document.getElementById('longer-passages-content').classList.toggle('hidden')">
                                <div class="block bg-gray-600 w-14 h-8 rounded-full"></div>
                                <div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition"></div>
                            </div>
                        </label> 
                    </div>
                    <section id="longer-passages-content" class="hidden mt-4 pt-4 border-t">
                        <p class="text-gray-700 p-4 bg-gray-50 rounded-lg">Content for the longer passages from the Office of Readings would be loaded here. This feature is currently under development.</p>
                    </section>
                </div>
                
                ${getCalendarHtmlTemplate()}
            `;
        }

        // --- CALENDAR LOGIC ---
        // handleMonthChange and renderCalendar now accept element IDs since they are dynamically inserted
        
        window.handleMonthChange = function(offset, daysGridId = 'calendar-days-grid', monthYearId = 'calendar-month-year') {
            currentCalendarDisplayMonth.setMonth(currentCalendarDisplayMonth.getMonth() + offset);
            // Re-render the calendar using the dynamically provided IDs
            renderCalendar(currentCalendarDisplayMonth, daysGridId, monthYearId);
        }

        window.handleDateSelect = function(timestamp, page) {
            // 1. Set the global date to the selected timestamp
            currentlyLoadedDate = new Date(timestamp);
        
            // 2. Switch to the target page. The switchPage function will handle
            // loading the content for the now-current date.
            switchPage(page);
            // The scroll to top is handled within switchPage.
        }

        function renderCalendar(dateInMonth, daysGridId, monthYearId) {
            const month = dateInMonth.getMonth();
            const year = dateInMonth.getFullYear();

            // 1. Update Month/Year Header
            const monthYearEl = document.getElementById(monthYearId);
            if (monthYearEl) {
                monthYearEl.textContent = dateInMonth.toLocaleDateString('en-US', { year: 'numeric', month: 'long' });
            }

            // 2. Calculate dates
            const firstDayOfMonth = new Date(year, month, 1);
            const lastDayOfMonth = new Date(year, month + 1, 0);
            const startDay = firstDayOfMonth.getDay(); // Day of week (0=Sun, 6=Sat)
            
            let html = '';

            // Add placeholder divs for days before the 1st
            for (let i = 0; i < startDay; i++) {
                html += '<div></div>';
            }

            // Add the days of the month
            for (let day = 1; day <= lastDayOfMonth.getDate(); day++) {
                const dayDate = new Date(year, month, day);
                const isCurrentDay = dayDate.toDateString() === currentlyLoadedDate.toDateString();
                const isTodayFlag = isToday(dayDate);
                const timestamp = dayDate.getTime();

                html += `
                    <div 
                        class="p-1 cursor-pointer rounded-lg text-center transition-colors duration-150 ${isCurrentDay ? 'bg-blue-600 text-white font-bold' : (isTodayFlag ? 'bg-blue-100 text-blue-700' : 'hover:bg-gray-200')}" 
                        onclick="handleDateSelect(${timestamp}, currentPage)">
                        ${day}
                    </div>
                `;
            }

            const daysGridEl = document.getElementById(daysGridId);
            if (daysGridEl) {
                daysGridEl.innerHTML = html;
            }
        }

        // NEW: Function to toggle between ferial and memorial readings
        window.setReadingsView = function(view) {
            readingsView = view;
            // Reload the content for the current page and date
            loadFullContent(currentlyLoadedDate, 'readings');
        }

        // --- PAGE SWITCHING LOGIC ---

        // Function to load full content (used by switchPage and handleDateSelect)
        function loadFullContent(date, page) {
            currentlyLoadedDate = date;
            const info = getLiturgicalInfo(date);
            
            let contentHtml = '';
            if (page === 'reflections') {
                contentHtml = getFullReflectionContent(info);
            } else if (page === 'readings') {
                contentHtml = getFullReadingsContent(info);
            } else if (page === 'devotions') {
                if (currentDevotionPage === 'rosary') {
                    contentHtml = getFullRosaryContent(info);
                } else {
                    contentHtml = getDevotionsListHtml();
                }
            } else if (page === 'prayers') {
                // UPDATED: Load the new prayers content
                contentHtml = getFullPrayersContent(info);
            } else if (page === 'ordermass') {
                // NEW: Load the Order of Mass page
                contentHtml = getFullOrderOfMassContent(info);
            } else if (page === 'ordermass_general') {
                // NEW: Load the General Order of Mass page
                contentHtml = getGeneralOrderOfMassContent();
            } else if (page === 'doctrine_summary') {
                // NEW: Load the Doctrine Summary page
                contentHtml = getFullDoctrineSummaryContent();
            } else if (page === 'litanies') {
                // NEW: Load the Litanies page
                contentHtml = getFullLitaniesContent();
            } else if (page === 'novenas') {
                // NEW: Load the Novenas page
                contentHtml = getFullNovenasContent();
            } else if (page === 'about') {
                // NEW: Load the About page content
                contentHtml = getFullAboutContent();
            } else if (page === 'saints') {
                // NEW: Load the Saints page
                contentHtml = getFullSaintsContent(info);
            } else if (page === 'day_view') {
                contentHtml = getFullDayViewContent(info);
            } else if (page === 'my_prayers') {
                contentHtml = getMyFavoritePrayersContent();
                // NEW: Update header for this page
                updateHeaderAndHomeContent(date);
            } else if (page === 'my_saints') {
                contentHtml = getMyFavoriteSaintsContent();
            } else if (page === 'my_saints') {
                contentHtml = getMyFavoriteSaintsContent();
            } else if (page === 'my_requests') {
                contentHtml = getComingSoonContent("My Prayer Requests");
            } else if (page === 'search') {
                contentHtml = getSearchResultsContent(lastSearchQuery);
            } else if (page === 'articles') {
                contentHtml = getComingSoonContent('Articles');
            } else if (page === 'books_encyclicals') {
                contentHtml = getComingSoonContent('Books & Encyclicals');
            } else if (page === 'news') {
                contentHtml = getComingSoonContent('News');
            } else if (page === 'christian_art') {
                contentHtml = getComingSoonContent('Christian Art');
            } else if (page === 'popes') {
                contentHtml = getComingSoonContent('Popes');
            } else if (page === 'liturgical_calendar') {
                contentHtml = getFullLiturgicalCalendarContent();
            } else if (page === 'vocation') {
                contentHtml = getComingSoonContent('Vocation Promotion');
            } else if (page === 'admin_dashboard') {
                contentHtml = getAdminDashboardContent();
            } else if (page === 'more') {
                 contentHtml = `
                    <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">More Resources</h2>
                    
                    <div class="space-y-8">

                        <!-- 1. Liturgy & Worship --> 
                        <section id="liturgy-worship" class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-sky-600">
                            <h3 class="text-2xl font-bold text-sky-700 mb-4 border-b pb-2">Liturgy & Worship</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                                <!-- Order of Mass -->
                                <a href="#" onclick="currentlyLoadedDate = new Date(); switchPage('ordermass'); return false;" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13M3.25 9.75h17.5M3.25 15.75h17.5"></path></svg>
                                        Mass Today
                                    </div>
                                </a>
                                <!-- NEW: General Order of Mass Link -->
                                <a href="#" onclick="switchPage('ordermass_general'); return false;" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 3l-5 5-5-5"></path></svg>
                                        Order of Mass
                                    </div>
                                </a>
                                <!-- Liturgy of the Hours -->
                                <a href="#" onclick="showToast('Liturgy of the Hours is coming soon!')" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                        Liturgy of the Hours
                                    </div>
                                </a>
                                <!-- Liturgical Calendar -->
                                <a href="#" onclick="switchPage('liturgical_calendar'); return false;" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                        Liturgical Calendar
                                    </div>
                                </a>
                                <!-- Christian Art -->
                                <a href="#" onclick="switchPage('christian_art'); return false;" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l-1-1m5.293-5.293a1 1 0 010 1.414L15 14.414m-2.586-2.586a2 2 0 00-2.828 0L4 16"></path></svg>
                                        Christian Art
                                    </div>
                                </a>
                                <!-- Sacrament Guide -->
                                <a href="#" onclick="showToast('Sacrament Guide is coming soon!')" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0zM14 11.5V14m0-2.5v-6a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0zM10.5 5.5v1.5m0 0v1.5m0-1.5h3m-3 0h-3"></path></svg>
                                        Sacrament Guide
                                    </div>
                                </a>
                                <!-- Common Blessings -->
                                <a href="#" onclick="switchPage('prayers'); showToast('Opening Common Blessings...');" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636a9 9 0 010 12.728m-12.728 0a9 9 0 010-12.728m12.728 0L12 12m0 0l-6.364-6.364m6.364 6.364l6.364 6.364m-6.364-6.364L5.636 18.364"></path></svg>
                                        Common Blessings
                                    </div>
                                </a>
                            </div>
                        </section>

                        <!-- 2. Learn & Grow -->
                        <section id="learn-grow" class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-violet-600">
                            <h3 class="text-2xl font-bold text-violet-700 mb-4 border-b pb-2">Learn & Grow</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                                <!-- Saints Calendar -->
                                <a href="#" onclick="switchPage('saints'); showToast('Opening Saints Calendar...');" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10m0-2s-1 2-3 2m14 0l-3-3m0 0l-3 3m3-3v12"></path></svg>
                                        Saints Calendar
                                    </div>
                                </a>
                                <!-- Bible -->
                                <a href="#" onclick="switchPage('readings'); showToast('Opening Bible/Readings...');" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13M3.25 9.75h17.5M3.25 15.75h17.5"></path></svg>
                                        Bible
                                    </div>
                                </a>
                                <!-- Catechism -->
                                <a href="#" onclick="showToast('Catechism is coming soon!')" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l-4 4-4-4M6 16l-4-4 4-4"></path></svg>
                                        Catechism
                                    </div>
                                </a>
                                <!-- NEW LINK ADDED HERE -->
                                <a href="#" onclick="switchPage('doctrine_summary'); return false;" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path></svg>
                                        Summary of Christian Doctrine
                                    </div>
                                </a>
                                <!-- NEW LINK -->
                                <a href="#" onclick="switchPage('litanies'); return false;" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3"></path></svg>
                                        Treasury of Litanies
                                    </div>
                                </a>
                                <!-- Articles -->
                                <a href="#" onclick="switchPage('articles'); return false;" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                                        Articles
                                    </div>
                                </a>
                                <!-- Books & Encyclicals -->
                                <a href="#" onclick="switchPage('books_encyclicals'); return false;" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13M3.25 9.75h17.5M3.25 15.75h17.5"></path></svg>
                                        Books & Encyclicals
                                    </div>
                                </a>
                                <!-- Popes -->
                                <a href="#" onclick="switchPage('popes'); return false;" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                                        Popes
                                    </div>
                                </a>
                                <!-- Spiritual Reading -->
                                <a href="#" onclick="showToast('Spiritual Reading library is coming soon!')" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-12v4m-2-2h4m5 10v4m-2-2h4"></path></svg>
                                        Spiritual Reading
                                    </div>
                                </a>
                                <!-- Question & Answer -->
                                <a href="#" onclick="showToast('Question & Answer is coming soon!')" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.79 4 4 0 1.933-1.566 3.5-3.5 3.5a1.5 1.5 0 01-1.5-1.5c0-.966.6-1.811 1.5-2.206l-1.667-3.293zM12 18.75A1.25 1.25 0 1012 21.25a1.25 1.25 0 000-2.5z"></path></svg>
                                        Question & Answer
                                    </div>
                                </a>
                                <!-- Vocation Promotion -->
                                <a href="#" onclick="switchPage('vocation'); return false;" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.539 1.118l-3.975-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.196-1.539-1.118l1.518-4.674a1 1 0 00-.363-1.118L2.05 10.1c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg>
                                        Vocation Promotion
                                    </div>
                                </a>
                                <!-- Monthly Quiz -->
                                <a href="#" onclick="showToast('Monthly Quiz is coming soon!')" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>
                                        Monthly Quiz
                                    </div>
                                </a>
                                <!-- Church History -->
                                <a href="#" onclick="showToast('Church History is coming soon!')" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 22V12h6v10"></path></svg>
                                        Church History
                                    </div>
                                </a>
                                <!-- Introduction to the Faith (RCIA) -->
                                <a href="#" onclick="showToast('RCIA resources are coming soon!')" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13M3.25 9.75h17.5M3.25 15.75h17.5"></path></svg>
                                        Introduction to the Faith (RCIA)
                                    </div>
                                </a>
                            </div>
                        </section>

                        <!-- 3. Community & Utilities -->
                        <section id="community-utilities" class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-emerald-600">
                            <h3 class="text-2xl font-bold text-emerald-700 mb-4 border-b pb-2">Community & Utilities</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                                <!-- Prayer Requests -->
                                <a href="#" onclick="showToast('Prayer Requests are coming soon!')" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                                        Prayer Requests
                                    </div>
                                </a>
                                <!-- Community Discussions -->
                                <a href="#" onclick="showToast('Community Discussions are coming soon!')" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a2 2 0 01-2-2V10a2 2 0 012-2h8zM7 8H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l4-4h8a2 2 0 002-2V10a2 2 0 00-2-2H9l-4-4V8z"></path></svg>
                                        Community Discussions
                                    </div>
                                </a>
                                <!-- Catholic News -->
                                <a href="#" onclick="showToast('Catholic News is coming soon!')" class="prayer-link-item">
                                    <div class="flex items-center" onclick="switchPage('news'); return false;">
                                        <svg class="w-5 h-5 mr-3 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 12h6m-3-4h3"></path></svg>
                                        Catholic News
                                    </div>
                                </a>
                                <!-- Parish Finder -->
                                <a href="#" onclick="showToast('Parish Finder is coming soon!')" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.828 0l-4.243-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                                        Parish Finder
                                    </div>
                                </a>
                                <!-- Other Resources -->
                                <a href="#" onclick="showToast('Other Resources are coming soon!')" class="prayer-link-item">
                                    <div class="flex items-center">
                                        <svg class="w-5 h-5 mr-3 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                        Other Resources
                                    </div>
                                </a>
                            </div>
                        </section>

                    </div>
                 `;
            } else {
                 contentHtml = getComingSoonContent(page.charAt(0).toUpperCase() + page.slice(1));
            }
            leftColumn.innerHTML = contentHtml;
            
            // If we are on a date-sensitive page (Reflections/Readings), re-render the calendar after HTML insertion
            if (page === 'reflections' || page === 'readings' || page === 'ordermass' || page === 'day_view') {
                // Set the calendar to display the month of the currently loaded date
                currentCalendarDisplayMonth = new Date(date.getFullYear(), date.getMonth(), 1);
                // The IDs are now local to the inserted HTML block
                renderCalendar(currentCalendarDisplayMonth, 'calendar-days-grid', 'calendar-month-year');
            }

            // If we just loaded the Rosary page, initialize the player
            if (page === 'devotions' && currentDevotionPage === 'rosary') {
                // OLD INLINE PLAYER LOGIC - REMOVED
                // const todayDay = new Date().getDay(); 
                // let defaultSet = 'joyful';
                // if ([0, 3].includes(todayDay)) defaultSet = 'glorious';
                // if ([2, 5].includes(todayDay)) defaultSet = 'sorrowful';
                // if (todayDay === 4) defaultSet = 'luminous';
                // selectRosaryMystery(defaultSet);
            }
        }


        window.switchPage = function(page) {
            currentPage = page;
            
            // 1. Manage Layout (Sidebar visibility and full-page width)
            if (page === 'home') {
                // NEW: Show date/liturgy block
                const dateLiturgyBlock = document.getElementById('date-liturgy-block');
                if (dateLiturgyBlock) dateLiturgyBlock.style.display = 'block';

                // HOME VIEW
                // NEW: Right column is now always visible, so we don't need to change grid classes.
                /*
                mainGrid.classList.remove('grid-full');
                mainGrid.classList.add('md:grid-cols-4', 'grid-home');
                rightColumn.style.display = 'block'; // Show sidebar
                // FIX: Check if the element exists before trying to style it.
                const postContentSection = document.getElementById('post-content-section');
                if (postContentSection) {
                    postContentSection.style.display = 'block'; // Show quick actions
                }
                leftColumn.classList.remove('md:col-span-4');
                leftColumn.classList.add('md:col-span-3');
                */

                leftColumn.innerHTML = tabContents['home'];
                
                // Reset to today's date for home view, but keep currentlyLoadedDate for context
                const today = new Date();
                updateHeaderAndHomeContent(today);
                renderHomeCalendar(homeCalendarDisplayMonth); // Re-render home calendar
                currentlyLoadedDate = today;
                currentDevotionPage = 'list'; // Reset devotions view when going home

            } else {
                // NEW: Show or hide the date/liturgy block based on the page
                const dateLiturgyBlock = document.getElementById('date-liturgy-block');
                const pagesToShowBlock = ['reflections', 'readings', 'day_view'];
                if (dateLiturgyBlock) {
                    dateLiturgyBlock.style.display = pagesToShowBlock.includes(page) ? 'block' : 'none';
                }
                // FULL-PAGE VIEW
                // NEW: Right column is now always visible, so we don't need to change grid classes.

                // If switching *to* devotions tab, reset to list view
                if (page === 'devotions') {
                    currentDevotionPage = 'list';
                } else if (page === 'saints') {
                    saintsPageState = { view: 'buttons', buttonPage: 0, alphaPage: 0, selectedSaintId: null, calendarMonth: new Date().getMonth(), calendarYear: new Date().getFullYear() };
                } else if (page === 'readings') {
                    // When switching to readings tab, default to ferial readings
                    readingsView = 'ferial';
                    saintsPageState = { view: 'buttons', buttonPage: 0, alphaPage: 0, selectedSaintId: null, calendarMonth: new Date().getMonth(), calendarYear: new Date().getFullYear() };
                }

                // Load the full content for the currently selected date (this handles calendar insertion/rendering now)
                loadFullContent(currentlyLoadedDate, page);

                // NEW: Update header for date-sensitive pages
                if (pagesToShowBlock.includes(page)) {
                    updateHeaderAndHomeContent(currentlyLoadedDate);
                }
            }
            
            // 2. Activate the corresponding navigation link
            // Remove 'active' class from all buttons
            navButtons.forEach(btn => btn.classList.remove('active'));

            // NEW: Make 'more' tab active for ordermass pages
            let pageToActivate = page;
            if (['my_prayers', 'my_saints', 'my_requests'].includes(page)) {
                pageToActivate = null; // Don't highlight any tab for user-specific pages
            }
            else if (page === 'day_view') {
                pageToActivate = 'home'; // Keep 'Home' active for the day view
            }
            else if (['ordermass', 'ordermass_general', 'doctrine_summary', 'litanies', 'articles', 'books_encyclicals', 'news', 'christian_art', 'popes', 'vocation', 'liturgical_calendar', 'search', 'admin_dashboard'].includes(page)) {
                pageToActivate = 'more';
            }
            const activeNavButton = document.querySelector('[data-page="' + pageToActivate + '"]');
            if (activeNavButton) {
                activeNavButton.classList.add('active');
            }
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // --- INITIALIZATION ---

        // --- NEW HOME CALENDAR LOGIC ---
        const monthlyDedications = {
            0: "The Holy Name of Jesus",
            1: "The Holy Family",
            2: "St. Joseph",
            3: "The Holy Eucharist",
            4: "The Blessed Virgin Mary",
            5: "The Sacred Heart of Jesus",
            6: "The Precious Blood of Jesus",
            7: "The Immaculate Heart of Mary",
            8: "Our Lady of Sorrows",
            9: "The Holy Rosary",
            10: "The Holy Souls in Purgatory",
            11: "The Immaculate Conception"
        };

        function renderHomeCalendar(dateInMonth) {
            const month = dateInMonth.getMonth();
            const year = dateInMonth.getFullYear();

            document.getElementById('home-calendar-month-year').textContent = dateInMonth.toLocaleDateString('en-US', { year: 'numeric', month: 'long' });
            document.getElementById('home-calendar-dedication').textContent = `Month of ${monthlyDedications[month]}`;

            const firstDayOfMonth = new Date(year, month, 1);
            const lastDayOfMonth = new Date(year, month + 1, 0);
            const startDay = firstDayOfMonth.getDay();
            
            let html = '';
            for (let i = 0; i < startDay; i++) {
                html += '<div></div>';
            }

            for (let day = 1; day <= lastDayOfMonth.getDate(); day++) {
                const dayDate = new Date(year, month, day);
                const isTodayFlag = isToday(dayDate);
                const timestamp = dayDate.getTime();
                
                // For the home calendar, clicking a day should switch to the new 'day_view' page for that day.
                html += `
                    <div 
                        class="p-1 cursor-pointer rounded-full text-center transition-colors duration-150 ${isTodayFlag ? 'bg-blue-600 text-white font-bold' : 'hover:bg-gray-200'}" 
                        onclick="handleDateSelect(${timestamp}, 'day_view')">
                        ${day}
                    </div>
                `;
            }

            document.getElementById('home-calendar-days-grid').innerHTML = html;
        }

        function renderHomeCalendarWidget() {
            const widgetHtml = `
                <div class="flex items-center justify-between mb-2 border-b pb-2">
                    <button onclick="handleHomeMonthChange(-1)" class="p-1 rounded hover:bg-gray-100 transition text-gray-700" aria-label="Previous Month"> 
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                    </button>
                    <span id="home-calendar-month-year" class="font-semibold text-lg text-gray-800"></span>
                    <button onclick="handleHomeMonthChange(1)" class="p-1 rounded hover:bg-gray-100 transition text-gray-700" aria-label="Next Month">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                    </button>
                </div>
                <div id="home-calendar-dedication" class="text-center text-xs font-semibold text-violet-700 mb-2 h-8 flex items-center justify-center"></div>
                <div class="grid grid-cols-7 gap-1 text-center text-xs font-medium text-gray-500">
                    <span>Su</span><span>Mo</span><span>Tu</span><span>We</span><span>Th</span><span>Fr</span><span>Sa</span>
                </div>
                <div id="home-calendar-days-grid" class="grid grid-cols-7 gap-1 mt-1 text-sm">
                    <!-- Days will be generated here -->
                </div>
            `;
            const widgetContainer = document.createElement('div');
            widgetContainer.id = 'home-calendar-widget';
            widgetContainer.className = 'p-4 rounded-xl shadow-lg';
            widgetContainer.innerHTML = widgetHtml;
            
            // Append it to the left column, after the quick actions
            const leftCol = document.getElementById('left-column');
            if (leftCol) {
                leftCol.appendChild(widgetContainer);
            }

            // Now render the content
            const month = homeCalendarDisplayMonth.getMonth();
            const year = homeCalendarDisplayMonth.getFullYear();

            document.getElementById('home-calendar-month-year').textContent = homeCalendarDisplayMonth.toLocaleDateString('en-US', { year: 'numeric', month: 'long' });
            document.getElementById('home-calendar-dedication').textContent = `Month of ${monthlyDedications[month]}`;

            const firstDayOfMonth = new Date(year, month, 1);
            const lastDayOfMonth = new Date(year, month + 1, 0);
            const startDay = firstDayOfMonth.getDay();
            
            let html = '';
            for (let i = 0; i < startDay; i++) {
                html += '<div></div>';
            }

            for (let day = 1; day <= lastDayOfMonth.getDate(); day++) {
                const dayDate = new Date(year, month, day);
                const isTodayFlag = isToday(dayDate);
                const timestamp = dayDate.getTime();
                
                // For the home calendar, clicking a day should switch to the new 'day_view' page for that day.
                html += `
                    <div 
                        class="p-1 cursor-pointer rounded-full text-center transition-colors duration-150 ${isTodayFlag ? 'bg-blue-600 text-white font-bold' : 'hover:bg-gray-200'}" 
                        onclick="handleDateSelect(${timestamp}, 'day_view')">
                        ${day}
                    </div>
                `;
            }

            document.getElementById('home-calendar-days-grid').innerHTML = html;
        }

        window.handleHomeMonthChange = function(offset) {
            homeCalendarDisplayMonth.setMonth(homeCalendarDisplayMonth.getMonth() + offset);
            renderHomeCalendar(homeCalendarDisplayMonth);
        }

        // --- NEW GENERIC CONTENT GENERATORS ---

        function getComingSoonContent(title) {
            return `
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-gray-500" style="background-color: var(--color-card-bg);">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4 text-center">${title}</h2>
                    <div class="text-center">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        <h3 class="mt-2 text-lg font-medium text-gray-900">Content Coming Soon</h3>
                        <p class="mt-1 text-sm text-gray-500">This section is currently under construction. Please check back later!</p>
                        <div class="mt-6">
                            <button type="button" onclick="switchPage('home')" class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                Go Back Home
                            </button>
                        </div>
                    </div>
                </section>`;
        }

        // NEW: Function to generate search results page
        function getSearchResultsContent(query) {
            const results = [];
            const lowerCaseQuery = query.toLowerCase();

            // 1. Search Saints
            saintsDB.forEach(saint => {
                if (saint.name.toLowerCase().includes(lowerCaseQuery) || saint.bio.toLowerCase().includes(lowerCaseQuery)) {
                    results.push({
                        type: 'Saint',
                        title: saint.name,
                        description: saint.bio.split(' ').slice(0, 20).join(' ') + '...',
                        // Creates a javascript call to switch to the saints page and show the detail view
                        link: `switchSaintsView('saint_detail'); saintsPageState.selectedSaintId='${saint.id}'; loadFullContent(new Date(), 'saints');`
                    });
                }
            });

            // 2. Search Prayers
            for (const prayerName in allPrayers) {
                const prayer = allPrayers[prayerName];
                if (prayer.title.toLowerCase().includes(lowerCaseQuery) || prayer.text.toLowerCase().includes(lowerCaseQuery)) {
                    results.push({
                        type: 'Prayer',
                        title: prayer.title,
                        description: prayer.text.split(' ').slice(0, 20).join(' ') + '...',
                        // Opens the prayer modal directly
                        link: `openPrayerModal('${prayer.title.replace(/'/g, "\\'")}', '${prayer.text.replace(/'/g, "\\'").replace(/\n/g, '\\n')}')`
                    });
                }
            }

            let resultsHtml = results.map(result => `
                <div class="p-4 border-b">
                    <span class="text-xs font-semibold uppercase text-gray-500">${result.type}</span>
                    <a href="#" onclick="${result.link}; return false;" class="block text-lg font-bold text-blue-600 hover:underline">${result.title}</a>
                    <p class="text-sm text-gray-600 mt-1">${result.description}</p>
                </div>
            `).join('');

            return `
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">Search Results for "${query}"</h2>
                <section class="p-6 rounded-xl shadow-lg" style="background-color: var(--color-card-bg);">${results.length > 0 ? resultsHtml : '<p class="text-center text-gray-500">No results found.</p>'}</section>`;
        }

        // Initial setup
        // UPDATED: This function is now async to wait for Firebase data
        function initializePage() {
            // This function will now run AFTER the saints data has been fetched.

            // Check if saintsDB was populated
            if (window.saintsDB && window.saintsDB.length > 0) {
                 saintsDB = window.saintsDB; // Use the globally fetched data
            }

            // 1. Initial content display based on today's date (this now runs AFTER fetching data)
            const today = new Date();
            currentlyLoadedDate = today;
            updateHeaderAndHomeContent(today); // This populates the home page content initially

            // 2. Render the home page calendar once.
            renderHomeCalendarWidget();
            
            // 3. Capture the entire home content AFTER the calendar has been added.
            tabContents['home'] = document.getElementById('left-column').innerHTML;
            
            // 4. Check for cookie consent and show banner if needed
            if (!localStorage.getItem('cookie_consent')) {
                const banner = document.getElementById('cookie-consent-banner');
                if (banner) {
                    banner.style.display = 'flex';
                }
            }

            // 5. Add search event listeners
            const homeSearch = document.getElementById('home-search-input');
            if (homeSearch) {
                homeSearch.addEventListener('keydown', (e) => { if (e.key === 'Enter') performSearch('home-search-input'); });
            }
            // This listener will be added when the saints page is loaded
            // The error was because this element doesn't exist on page load.
            const saintsSearch = document.getElementById('saints-search-input');
            if (saintsSearch) {
                saintsSearch.addEventListener('keydown', (e) => { if (e.key === 'Enter') performSearch('saints-search-input'); });
            }

            // 6. Initialize notifications
            updateNotificationBadge();
            if (notifications.filter(n => !n.read).length > 0) {
                showToast(`You have ${notifications.filter(n => !n.read).length} new notifications!`);
            }

            // 7. Initialize User UI
            // Start as logged out
            handleSignOut();

            // 8. Apply theme
            applyTheme();
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', applyTheme);


            // NEW: Automatically check for date change every minute
            let lastCheckedDate = new Date().getDate();
            setInterval(() => {
                const currentMinuteDate = new Date();
                const newDate = currentMinuteDate.getDate();
                if (newDate !== lastCheckedDate) {
                    // The date has changed, reload the content for the current page
                    console.log("Midnight detected. Refreshing content for the new day.");
                    
                    // Update the global date to the new day
                    currentlyLoadedDate = currentMinuteDate;
                    
                    // Reload content based on the currently active page
                    if (currentPage === 'home') {
                        switchPage('home'); // This handles resetting the home page correctly
                    } else {
                        loadFullContent(currentlyLoadedDate, currentPage);
                    }
                    lastCheckedDate = newDate;
                }
            }, 60000); // Check every 60,000 milliseconds (1 minute)
        }

        // Listen for the custom event from the module script, then initialize the page
        document.addEventListener('globalDataLoaded', initializePage);


        // --- NEW CONTENT GENERATOR FUNCTIONS ---

        // NEW: Function to generate the Liturgical Calendar page
        function getFullLiturgicalCalendarContent() {
            return `
            <div class="space-y-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">Liturgical Calendar</h2>

                <section class="p-2 sm:p-6 rounded-xl shadow-lg border-t-4 border-sky-600" style="background-color: var(--color-card-bg);">
                    <p class="text-center text-gray-600 mb-4">This calendar shows the General Roman Calendar with additions for the United States.</p>
                    <div class="flex justify-center">
                        <iframe src="https://calendar.google.com/calendar/embed?height=600&wkst=1&ctz=America%2FChicago&bgcolor=%23ffffff&title=General%20Roman%20Calendar%20with%20U.S.%20Additions&src=bXljYXRob2xpYy5saWZlXzZlZGdmMWYxMGJnbGkxNTltZ3M0dWMwcjkwQGdyb3VwLmNhbGVuZGFyLmdvb2dsZS5jb20&src=bXljYXRob2xpYy5saWZlX3Fpbmk3bjI3bjRmZ2I4MG00bHFlYmxyNTdvQGdyb3VwLmNhbGVuZGFyLmdvb2dsZS5jb20&src=bXljYXRob2xpYy5saWZlXzJjaG9lbGU4YTN2dGpkNWNmNWpwMTZnMmM4QGdyb3VwLmNhbGVuZGFyLmdvb2dsZS5jb20&src=bXljYXRob2xpYy5saWZlXzhjdmM4OGo3YzJvZHRzcmpyZ3NiZXR1cTk4QGdyb3VwLmNhbGVuZGFyLmdvb2dsZS5jb20&color=%230B8043&color=%23D50000&color=%238E24AA&color=%23E4C441" style="border:solid 1px #777" width="100%" max-width="800" height="600" frameborder="0" scrolling="no"></iframe>
                    </div>
                </section>
            </div>
            `;
        }
        
        // NEW: Function to generate the Day View page
        function getFullDayViewContent(info) {
            const dateObj = new Date(currentlyLoadedDate);
            const dateTs = dateObj.getTime();
            
            // NEW: Use liturgical info for the title
            let titleHtml = '';
            if (info.saint && (info.saint.rank === 'Solemnity' || info.saint.rank === 'Feast')) {
                titleHtml = `${info.saint.rank} of ${info.saint.name}`;
            } else if (info.ferial && info.ferial.name) {
                titleHtml = info.ferial.name;
            } else {
                titleHtml = `About ${formattedDate(dateObj, {weekday: false})}`;
            }

            return `
            <div class="space-y-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">${titleHtml}</h2>

                <section class="p-6 rounded-xl shadow-lg" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Content for this Day</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <a href="#" onclick="handleDateSelect(${dateTs}, 'readings'); return false;" class="devotion-link-item flex items-center">
                            <svg class="w-5 h-5 mr-3 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13M3.25 9.75h17.5M3.25 15.75h17.5"></path></svg>
                            Todays Readings
                        </a>
                        <a href="#" onclick="handleDateSelect(${dateTs}, 'reflections'); return false;" class="devotion-link-item flex items-center">
                            <svg class="w-5 h-5 mr-3 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            Todays Reflection
                        </a>
                        <a href="#" onclick="handleDateSelect(${dateTs}, 'saints'); return false;" class="devotion-link-item flex items-center">
                            <svg class="w-5 h-5 mr-3 text-pink-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                            Saint of the Day
                        </a>
                        <a href="#" onclick="launchRosaryPlayer()" class="devotion-link-item flex items-center">
                            <svg class="w-5 h-5 mr-3 text-blue-500" fill="currentColor" viewBox="0 0 20 20"><path d="M12.395 1.05a1 1 0 00-.796 0L4.5 3.5v13.5a1 1 0 001.5.866l5-3.333a1 1 0 011 0l5 3.333a1 1 0 001.5-.866V3.5a1 1 0 00-.595-.95l-7.5-2.5zM11 13.5L7 16V4.5l4-1.333V13.5z"></path></svg>
                            Todays Rosary
                        </a>
                        <a href="#" onclick="showToast('Spiritual Reading is coming soon!')" class="devotion-link-item flex items-center">
                            <svg class="w-5 h-5 mr-3 text-teal-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-12v4m-2-2h4m5 10v4m-2-2h4"></path></svg>
                            Todays Spiritual Reading
                        </a>
                        <a href="#" onclick="showToast('Liturgy of the Hours is coming soon!')" class="devotion-link-item flex items-center">
                            <svg class="w-5 h-5 mr-3 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            Todays Liturgy of Hours
                        </a>
                    </div>
                </section>
                ${getCalendarHtmlTemplate()}
            </div>
            `;
        }

        // NEW: Function to generate the Summary of Christian Doctrine page
        function getFullDoctrineSummaryContent() {
            return `
            <div class="space-y-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">Summary of Christian Doctrine</h2>

                <!-- 1. The Creed & The Church -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-sky-600" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-sky-700 mb-4 border-b pb-2">1. The Creed & The Church</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">Deposit of Revelation</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">Tradition</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">Sacred Scripture</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">Dogmas</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">Attributes of the Church</a>
                    </div>
                </section>

                <!-- 2. The Sacraments & Grace -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-red-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-red-700 mb-4 border-b pb-2">2. The Sacraments & Grace</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">The Seven Sacraments</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">The Holy Mass</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">Grace</a>
                    </div>
                </section>
                
                <!-- 3. The Moral Law -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-gray-700" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">3. The Moral Law</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">The Ten Commandments</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">The Six Chief Commandments of the Church</a>
                    </div>
                </section>

                <!-- 4. Virtues & Vices -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-green-600" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-green-700 mb-4 border-b pb-2">4. Virtues & Vices</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">The Three Theological Virtues</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">The Four Cardinal Virtues</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">The Seven Capital Sins</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">The Opposite Virtues</a>
                    </div>
                </section>

                <!-- 5. The Holy Spirit -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-orange-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-orange-700 mb-4 border-b pb-2">5. The Holy Spirit</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">The Seven Gifts of the Holy Spirit</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">The Twelve Fruits of the Holy Spirit</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">Sins Against the Holy Spirit</a>
                    </div>
                </section>

                <!-- 6. Works of Mercy -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-indigo-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-indigo-700 mb-4 border-b pb-2">6. Works of Mercy</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">The Seven Corporal Works of Mercy</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">The Seven Spiritual Works of Mercy</a>
                    </div>
                </section>

                <!-- 7. Our Lady -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-blue-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-blue-700 mb-4 border-b pb-2">7. The Blessed Virgin Mary</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">Blessed Virgin Mary</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">Marian Dogmas</a>
                    </div>
                </section>
                
                <!-- 8. Other Dangers -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-yellow-600" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-yellow-800 mb-4 border-b pb-2">8. Sins & Dangers</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">Superstition</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">Idolatry</a>
                        <a href="#" onclick="showToast('Content for this topic is coming soon!')" class="prayer-link-item">Magic</a>
                    </div>
                </section>
            </div>
            `;
        }

        // NEW: Function to generate the full Prayers tab content
        // REBUILT based on user's photos for better categorization
        function getFullPrayersContent(info) {
            // This function returns the HTML for the categorized prayer list
            return `
            <div class="space-y-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">Treasury of Prayers</h2>

                <!-- 1. Prayers to the Holy Trinity -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-yellow-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-yellow-700 mb-4 border-b pb-2">1. Prayers to the Holy Trinity</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'Sign of the Cross')" class="prayer-link-item">Sign of the Cross</a>
                        <a href="#" onclick="openPrayer(event, 'The Lord\\'s Prayer')" class="prayer-link-item">The Lord's Prayer</a>
                        <a href="#" onclick="openPrayer(event, 'Glory Be')" class="prayer-link-item">Glory Be</a>
                        <a href="#" onclick="openPrayer(event, 'Te Deum')" class="prayer-link-item">Te Deum</a>
                        <a href="#" onclick="openPrayer(event, 'Angelic Trisagion')" class="prayer-link-item">Angelic Trisagion</a>
                        <a href="#" onclick="openPrayer(event, 'Apostles\\' Creed')" class="prayer-link-item">Apostles' Creed</a>
                        <a href="#" onclick="openPrayer(event, 'Nicene Creed')" class="prayer-link-item">Nicene Creed</a>
                        <a href="#" onclick="openPrayer(event, 'Athanasian Creed')" class="prayer-link-item">Athanasian Creed (Quicumque)</a>
                        <a href="#" onclick="openPrayer(event, 'Veni, Creator Spiritus')" class="prayer-link-item">Veni, Creator Spiritus</a>
                        <a href="#" onclick="openPrayer(event, 'Sequence Come, Holy Spirit')" class="prayer-link-item">Sequence Come, Holy Spirit (Veni, Sancte)</a>
                    </div>
                </section>

                <!-- 2. Eucharistic Devotions -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-red-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-red-700 mb-4 border-b pb-2">2. Eucharistic Devotions</h3>
                    
                    <h4 class="text-lg font-semibold text-gray-700 mt-6 mb-3">Prayers Before Holy Mass</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Prayer to the Blessed Virgin Mary (Before Mass)')" class="prayer-link-item">Prayer to the Blessed Virgin Mary</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer to St. Joseph (Before Mass)')" class="prayer-link-item">Prayer to St. Joseph</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer of St. Ambrose')" class="prayer-link-item">Prayer of St. Ambrose</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer of St. Thomas Aquinas (Before Mass)')" class="prayer-link-item">Prayer of St. Thomas Aquinas</a>
                        <a href="#" onclick="openPrayer(event, 'Prayers for the Priest')" class="prayer-link-item">Prayers for the Priest</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer to all the Angels and Saints')" class="prayer-link-item">Prayer to all the Angels and Saints</a>
                        <a href="#" onclick="openPrayer(event, 'Statement Of Intention')" class="prayer-link-item">Statement Of Intention</a>
                    </div>

                    <h4 class="text-lg font-semibold text-gray-700 mt-6 mb-3">Prayers After Holy Mass</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Placeat')" class="prayer-link-item">Placeat</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer to St. Michael')" class="prayer-link-item">Prayer To St. Michael</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer Before a Crucifix')" class="prayer-link-item">Prayer Before a Crucifix</a>
                        <a href="#" onclick="openPrayer(event, 'Soul of Christ (Anima Christi)')" class="prayer-link-item">Soul of Christ (Anima Christi)</a>
                        <a href="#" onclick="openPrayer(event, 'I Beseech Thee, Most Sweet Lord')" class="prayer-link-item">I Beseech Thee, Most Sweet Lord</a>
                        <a href="#" onclick="openPrayer(event, 'O Good Cross (Prayer of St. Andrew)')" class="prayer-link-item">O Good Cross (Prayer of St. Andrew)</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer to the Blessed Virgin Mary (After Mass)')" class="prayer-link-item">Prayer to the Blessed Virgin Mary</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer to St. Joseph (After Mass)')" class="prayer-link-item">Prayer to St. Joseph</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer of Self-Dedication to Jesus Christ')" class="prayer-link-item">Prayer of Self-Dedication</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer of St. Thomas Aquinas After Mass')" class="prayer-link-item">Prayer of St. Thomas Aquinas</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer of St. Bonaventure')" class="prayer-link-item">Prayer of St. Bonaventure</a>
                        <a href="#" onclick="openPrayer(event, 'Universal Prayer (Pope Clement XI)')" class="prayer-link-item">Universal Prayer</a>
                    </div>
                    
                    <h4 class="text-lg font-semibold text-gray-700 mt-6 mb-3">Eucharistic Adoration</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Adorote Devote')" class="prayer-link-item">Adorote Devote</a>
                        <a href="#" onclick="openPrayer(event, 'Pange Lingua (Sing, My Tongue)')" class="prayer-link-item">Pange Lingua (Sing, My Tongue)</a>
                        <a href="#" onclick="openPrayer(event, 'O Salutaris Hostia (O Saving Victim)')" class="prayer-link-item">O Salutaris Hostia (O Saving Victim)</a>
                        <a href="#" onclick="openPrayer(event, 'Tantum Ergo (Down in Adoration Falling)')" class="prayer-link-item">Tantum Ergo (Down in Adoration Falling)</a>
                        <a href="#" onclick="openPrayer(event, 'Ave Verum Corpus')" class="prayer-link-item">Ave Verum Corpus</a>
                        <a href="#" onclick="openPrayer(event, 'O Sacrum Convivium')" class="prayer-link-item">O Sacrum Convivium</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer before the Blessed Sacrament')" class="prayer-link-item">A Quarter of an hour before the Blessed Sacrament</a>
                    </div>
                </section>

                <!-- 3. Marian Devotions -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-cyan-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-cyan-700 mb-4 border-b pb-2">3. Marian Devotions</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'Hail Mary (Ave Maria)')" class="prayer-link-item">Hail Mary (Ave Maria)</a>
                        <a href="#" onclick="openPrayer(event, 'Hail Holy Queen (Salve Regina)')" class="prayer-link-item">Hail Holy Queen (Salve Regina)</a>
                        <a href="#" onclick="openPrayer(event, 'Memorare')" class="prayer-link-item">Memorare</a>
                        <a href="#" onclick="openDevotion(event, 'The Holy Rosary')" class="prayer-link-item">The Holy Rosary (Guide)</a>
                        <a href="#" onclick="openPrayer(event, 'Litany of Loreto (BVM)')" class="prayer-link-item">Litany of Loreto</a>
                        <a href="#" onclick="openPrayer(event, 'Angelus')" class="prayer-link-item">Angelus</a>
                        <a href="#" onclick="openPrayer(event, 'Regina Caeli (Easter Season)')" class="prayer-link-item">Regina Caeli</a>
                        <a href="#" onclick="openPrayer(event, 'Fatima Prayer (O My Jesus)')" class="prayer-link-item">Fatima Prayer (O My Jesus)</a>
                        <a href="#" onclick="openPrayer(event, 'Stabat Mater')" class="prayer-link-item">At the Cross Her Station Keeping (Stabat Mater)</a>
                        <a href="#" onclick="openPrayer(event, 'Ave Maris Stella (Hail Star of the Ocean)')" class="prayer-link-item">Hail Star of the Ocean (Ave Maris Stella)</a>
                        <a href="#" onclick="openPrayer(event, 'Ave Regina Caelorum (Hail Queen of Heaven)')" class="prayer-link-item">Hail Queen of Heaven (Ave Regina Caelorum)</a>
                        <a href="#" onclick="openPrayer(event, 'Alma Redemptoris Mater')" class="prayer-link-item">Alma Redemptoris Mater</a>
                        <a href="#" onclick="openPrayer(event, 'O Mary, Conceived Without Sin')" class="prayer-link-item">O Mary, Conceived Without Sin</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer of St. Bernard (Memorare)')" class="prayer-link-item">Prayer of St. Bernard to the Virgin</a>
                        <a href="#" onclick="openPrayer(event, 'We Fly to Thy Patronage (Sub Tuum)')" class="prayer-link-item">We Fly to Thy Patronage</a>
                        <a href="#" onclick="openPrayer(event, 'Obsecro te')" class="prayer-link-item">Obsecro te</a>
                        <a href="#" onclick="openPrayer(event, 'Novena to the Blessed Virgin Mary')" class="prayer-link-item">Novena to the Blessed Virgin Mary</a>
                    </div>
                </section>

                <!-- 4. Prayers to Foster Contrition & Penance -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-indigo-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-indigo-700 mb-4 border-b pb-2">4. Prayers to Foster Contrition & Penance</h3>
                    
                    <h4 class="text-lg font-semibold text-gray-700 mt-6 mb-3">Prayers for Contrition</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Act of Contrition')" class="prayer-link-item">Act of Contrition</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer for a Happy Death')" class="prayer-link-item">Prayer to the Most Holy Trinity for a Happy Death</a>
                        <a href="#" onclick="openPrayer(event, 'Lord Jesus Christ...')" class="prayer-link-item">Lord Jesus Christ</a>
                        <a href="#" onclick="openPrayer(event, 'Grant Unto us, Lord Jesus')" class="prayer-link-item">Grant Unto us, Lord Jesus</a>
                        <!-- UPDATED: This now links to the interactive devotion page -->
                        <a href="#" onclick="openDevotion(event, 'Stations of the Cross')" class="prayer-link-item">The Stations of the Cross (Guide)</a>
                    </div>
                    
                    <h4 class="text-lg font-semibold text-gray-700 mt-6 mb-3">Confession Rites (for Priest)</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Oratio Sacerdotis Antequam...')" class="prayer-link-item">Oratio Sacerdotis Antequam...</a>
                        <a href="#" onclick="openPrayer(event, 'Oratio Sacerdotis Postquam...')" class="prayer-link-item">Oratio Sacerdotis Postquam...</a>
                        <a href="#" onclick="openPrayer(event, 'Ordo Pnitenti')" class="prayer-link-item">Ordo Pnitenti</a>
                    </div>
                </section>

                <!-- 5. Prayers for the Dead -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-gray-800" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4 border-b pb-2">5. Prayers for the Dead</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'Eternal Rest (Requiem Aeternam)')" class="prayer-link-item">Eternal Rest (Requiem Aeternam)</a>
                        <a href="#" onclick="openPrayer(event, 'De Profundis (Psalm 130)')" class="prayer-link-item">De Profundis (Psalm 130/129)</a>
                        <a href="#" onclick="openPrayer(event, 'Pro Defunctis')" class="prayer-link-item">Pro Defunctis</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer for our Parents')" class="prayer-link-item">For our parents</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer for all the Faithful Departed')" class="prayer-link-item">For all the faithful departed</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer for a Deceased Man')" class="prayer-link-item">For a Deceased Man</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer for a Deceased Woman')" class="prayer-link-item">For a Deceased Woman</a>
                        <a href="#" onclick="openPrayer(event, 'Responsory for the Dead')" class="prayer-link-item">Responsory for the Dead</a>
                    </div>
                </section>

                <!-- 6. Psalms -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-teal-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-teal-700 mb-4 border-b pb-2">6. Psalms</h3>
                    
                    <h4 class="text-lg font-semibold text-gray-700 mt-6 mb-3">Seven Penitential Psalms</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Psalm 6')" class="prayer-link-item">Psalm 6</a>
                        <a href="#" onclick="openPrayer(event, 'Psalm 31 (32)')" class="prayer-link-item">Psalm 31 (32)</a>
                        <a href="#" onclick="openPrayer(event, 'Psalm 37 (38)')" class="prayer-link-item">Psalm 37 (38)</a>
                        <a href="#" onclick="openPrayer(event, 'Psalm 50 (51) Have mercy on me')" class="prayer-link-item">Psalm 50 (51) Have mercy on me</a>
                        <a href="#" onclick="openPrayer(event, 'Psalm 101 (102)')" class="prayer-link-item">Psalm 101 (102)</a>
                        <a href="#" onclick="openPrayer(event, 'Psalm 129 (130) Out of the depths')" class="prayer-link-item">Psalm 129 (130) Out of the depths</a>
                        <a href="#" onclick="openPrayer(event, 'Psalm 142 (143)')" class="prayer-link-item">Psalm 142 (143)</a>
                    </div>

                    <h4 class="text-lg font-semibold text-gray-700 mt-6 mb-3">Other Psalms</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Psalm 2')" class="prayer-link-item">Psalm 2</a>
                        <a href="#" onclick="openPrayer(event, 'Psalm 83 (84)')" class="prayer-link-item">Psalm 83 (84)</a>
                        <a href="#" onclick="openPrayer(event, 'Psalm 84 (85)')" class="prayer-link-item">Psalm 84 (85)</a>
                        <a href="#" onclick="openPrayer(event, 'Psalm 85 (86)')" class="prayer-link-item">Psalm 85 (86)</a>
                        <a href="#" onclick="openPrayer(event, 'Psalm 115 (116)')" class="prayer-link-item">Psalm 115 (116)</a>
                        <a href="#" onclick="openPrayer(event, 'Psalm 150')" class="prayer-link-item">Psalm 150</a>
                        <a href="#" onclick="openPrayer(event, 'Trium Puerorum')" class="prayer-link-item">Canticle of the Three Youths (Trium Puerorum)</a>
                    </div>
                </section>

                <!-- 7. Songs and Hymns -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-purple-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-purple-700 mb-4 border-b pb-2">7. Songs and Hymns</h3>
                    
                    <h4 class="text-lg font-semibold text-gray-700 mt-6 mb-3">Canticles from Holy Scripture</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Canticle of Mary (Magnificat)')" class="prayer-link-item">Canticle of Mary (Magnificat)</a>
                        <a href="#" onclick="openPrayer(event, 'Canticle of Zechariah (Benedictus)')" class="prayer-link-item">Canticle of Zechariah (Benedictus)</a>
                        <a href="#" onclick="openPrayer(event, 'Canticle of Simeon (Nunc Dimittis)')" class="prayer-link-item">Canticle of Simeon (Nunc Dimittis)</a>
                    </div>

                    <h4 class="text-lg font-semibold text-gray-700 mt-6 mb-3">Hymns</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Adeste fideles')" class="prayer-link-item">Adeste fideles</a>
                        <a href="#" onclick="openPrayer(event, 'Dies irae')" class="prayer-link-item">Dies irae</a>
                        <a href="#" onclick="openPrayer(event, 'Stabat Mater speciosa')" class="prayer-link-item">Stabat Mater speciosa</a>
                        <a href="#" onclick="openPrayer(event, 'Te, Ioseph, celebrant')" class="prayer-link-item">Te, Ioseph, celebrant</a>
                        <a href="#" onclick="openPrayer(event, 'Ubi caritas')" class="prayer-link-item">Ubi caritas</a>
                        <a href="#" onclick="openPrayer(event, 'Exsultet')" class="prayer-link-item">Exsultet</a>
                        <a href="#" onclick="openPrayer(event, 'Lucis Creator optime')" class="prayer-link-item">Lucis Creator optime</a>
                        <a href="#" onclick="openPrayer(event, 'O lux beata caelitum')" class="prayer-link-item">O lux beata caelitum</a>
                        <a href="#" onclick="openPrayer(event, 'Vexilla Regis')" class="prayer-link-item">Vexilla Regis</a>
                        <a href="#" onclick="openPrayer(event, 'Victimae Paschali')" class="prayer-link-item">Victimae Paschali</a>
                    </div>
                </section>
                
                <!-- 8. Litanies (Pulled from 'Other Prayers' photo) -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-rose-500 text-center" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-rose-700 mb-4 border-b pb-2">8. Litanies</h3>
                    <p class="text-gray-600 mb-4">The Church has a rich tradition of litanies for both public and private prayer. A comprehensive collection has been added to the site.</p>
                    <div class="mt-4">
                        <a href="#" onclick="switchPage('litanies'); return false;" class="inline-flex items-center px-6 py-2 bg-rose-600 text-white font-semibold rounded-lg hover:bg-rose-700 transition duration-150 shadow-md">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3"></path></svg>
                            Go to Treasury of Litanies
                        </a>
                    </div>
                </section>
                
                <!-- 9. Other Prayers (from 'Other Prayers' photo) -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-pink-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-pink-700 mb-4 border-b pb-2">9. Other Prayers</h3>
                    
                    <h4 class="text-lg font-semibold text-gray-700 mt-6 mb-3">Daily & Devotional Prayers</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Blessing Before Meals')" class="prayer-link-item">Blessing Before Meals</a>
                        <a href="#" onclick="openPrayer(event, 'Blessing After Meals')" class="prayer-link-item">Blessing After Meals</a>
                        <a href="#" onclick="openPrayer(event, 'Angel of God (Guardian Angel Prayer)')" class="prayer-link-item">Prayer to One's Guardian Angel</a>
                        <a href="#" onclick="openPrayer(event, 'Act of Faith')" class="prayer-link-item">Act of Faith</a>
                        <a href="#" onclick="openPrayer(event, 'Act of Hope')" class="prayer-link-item">Act of Hope</a>
                        <a href="#" onclick="openPrayer(event, 'Act of Love')" class="prayer-link-item">Act of Love</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer before the Spiritual Reading')" class="prayer-link-item">Prayer before the Spiritual Reading</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer after the Spiritual Reading')" class="prayer-link-item">Prayer after the Spiritual Reading</a>
                        <a href="#" onclick="openPrayer(event, 'Lord Jesus, Let me Know Myself')" class="prayer-link-item">Lord Jesus, Let me Know Myself</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer for Peace (St. Francis)')" class="prayer-link-item">Prayer for Peace (St. Francis)</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer To D. Alvaro')" class="prayer-link-item">Prayer To D. Alvaro</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer Before Connecting to the Internet')" class="prayer-link-item">Prayer Before Connecting to the Internet</a>
                    </div>
                </section>
                
                <!-- 10. Common Blessings (from user photo) -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-green-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-green-700 mb-4 border-b pb-2">10. Common Blessings</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'Blessing Of Holy Water Outside Mass')" class="prayer-link-item">Blessing Of Holy Water Outside Mass</a>
                        <a href="#" onclick="openPrayer(event, 'Blessing Of An Advent Wreath')" class="prayer-link-item">Blessing Of An Advent Wreath</a>
                        <a href="#" onclick="openPrayer(event, 'Blessing Of A Christmas Tree')" class="prayer-link-item">Blessing Of A Christmas Tree</a>
                        <a href="#" onclick="openPrayer(event, 'Blessing And Imposition With The Scapular')" class="prayer-link-item">Blessing: Scapular of Our Lady of Mt Carmel</a>
                        <a href="#" onclick="openPrayer(event, 'Blessing Of A New Home')" class="prayer-link-item">Blessing Of A New Home</a>
                        <a href="#" onclick="openPrayer(event, 'Blessing For A Place Of Work')" class="prayer-link-item">Blessing For A Place Of Work / Office</a>
                        <a href="#" onclick="openPrayer(event, 'Blessing Of A Shop Or Factory')" class="prayer-link-item">Blessing Of A Shop Or Factory</a>
                        <a href="#" onclick="openPrayer(event, 'Blessing Of Travelers (Shorter Rite)')" class="prayer-link-item">Blessing Of Travelers (Shorter Rite)</a>
                        <a href="#" onclick="openPrayer(event, 'Blessing Of A Mother Before Childbirth')" class="prayer-link-item">Blessing Of A Mother Before Childbirth</a>
                        <a href="#" onclick="openPrayer(event, 'Blessing Of A Mother After Childbirth')" class="prayer-link-item">Blessing Of A Mother After Childbirth</a>
                        <a href="#" onclick="openPrayer(event, 'Blessing Of Rosaries (Shorter Rite)')" class="prayer-link-item">Blessing Of Rosaries (Shorter Rite)</a>
                        <a href="#" onclick="openPrayer(event, 'Blessing Of Religious Articles')" class="prayer-link-item">Blessing Of Religious Articles</a>
                        <a href="#" onclick="openPrayer(event, 'Blessing Of Means Of Transportation')" class="prayer-link-item">Blessing Of Means Of Transportation</a>
                    </div>
                </section>
            </div>
            `;
        }

        // UPDATED: This function is now completely replaced with the new comprehensive list
        function getDevotionsListHtml() {
            // This function returns the HTML for the categorized devotions list
            return `
            <div class="space-y-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">Devotions</h2>

                <!-- 1. Devotions Centered on Jesus -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-red-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-red-700 mb-4 border-b pb-2">1. Devotions Centered on Jesus</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'Eucharistic Adoration / Benediction')" class="prayer-link-item">Eucharistic Adoration / Benediction</a>
                        <a href="#" onclick="openPrayer(event, 'Forty Hours Devotion')" class="prayer-link-item">Forty Hours Devotion</a>
                        <a href="#" onclick="openPrayer(event, 'Perpetual Adoration')" class="prayer-link-item">Perpetual Adoration</a>
                        <a href="#" onclick="openPrayer(event, 'Visits to the Blessed Sacrament')" class="prayer-link-item">Visits to the Blessed Sacrament</a>
                        <a href="#" onclick="openPrayer(event, 'Corpus Christi processions')" class="prayer-link-item">Corpus Christi processions</a>
                        <a href="#" onclick="openPrayer(event, 'Devotion to the Sacred Heart')" class="prayer-link-item">Devotion to the Sacred Heart</a>
                        <a href="#" onclick="openPrayer(event, 'Devotion to the Divine Mercy')" class="prayer-link-item">Devotion to the Divine Mercy</a>
                        <a href="#" onclick="openPrayer(event, 'Devotion to the Holy Name of Jesus')" class="prayer-link-item">Devotion to the Holy Name of Jesus</a>
                        <a href="#" onclick="openPrayer(event, 'Devotion to the Precious Blood')" class="prayer-link-item">Devotion to the Precious Blood</a>
                        <a href="#" onclick="openPrayer(event, 'Devotion to the Five Holy Wounds')" class="prayer-link-item">Devotion to the Five Holy Wounds</a>
                        <a href="#" onclick="openPrayer(event, 'Devotion to the Holy Face')" class="prayer-link-item">Devotion to the Holy Face</a>
                        <a href="#" onclick="openPrayer(event, 'Devotion to the Infant Jesus')" class="prayer-link-item">Devotion to the Infant Jesus</a>
                        <a href="#" onclick="openDevotion(event, 'Stations of the Cross')" class="prayer-link-item">Stations of the Cross (Guide)</a>
                    </div>
                </section>

                <!-- 2. Marian Devotions -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-blue-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-blue-700 mb-4 border-b pb-2">2. Marian Devotions</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openDevotion(event, 'The Holy Rosary')" class="prayer-link-item">The Holy Rosary (Interactive Guide)</a>
                        <a href="#" onclick="openPrayer(event, 'First Saturday Devotions')" class="prayer-link-item">First Saturday Devotions</a>
                        <a href="#" onclick="openPrayer(event, 'Angelus and Regina Caeli')" class="prayer-link-item">Angelus and Regina Caeli</a>
                        <a href="#" onclick="openPrayer(event, 'Marian Consecration')" class="prayer-link-item">Marian Consecration</a>
                        <a href="#" onclick="openPrayer(event, 'Scapular Devotions')" class="prayer-link-item">Scapular Devotions</a>
                        <a href="#" onclick="openPrayer(event, 'Miraculous Medal')" class="prayer-link-item">Miraculous Medal</a>
                        <a href="#" onclick="openPrayer(event, 'Litany of Loreto')" class="prayer-link-item">Litany of Loreto</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Fatima')" class="prayer-link-item">Our Lady of Fatima</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Lourdes')" class="prayer-link-item">Our Lady of Lourdes</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Guadalupe')" class="prayer-link-item">Our Lady of Guadalupe</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Perpetual Help')" class="prayer-link-item">Our Lady of Perpetual Help</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Sorrows')" class="prayer-link-item">Our Lady of Sorrows</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Kibeho')" class="prayer-link-item">Our Lady of Kibeho</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Czestochowa')" class="prayer-link-item">Our Lady of Czestochowa</a>
                    </div>
                </section>

                <!-- 3. Devotions to the Holy Spirit -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-orange-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-orange-700 mb-4 border-b pb-2">3. Devotions to the Holy Spirit</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'Novena to the Holy Spirit')" class="prayer-link-item">Novena to the Holy Spirit</a>
                        <a href="#" onclick="openPrayer(event, 'Chaplet of the Holy Spirit')" class="prayer-link-item">Chaplet of the Holy Spirit</a>
                        <a href="#" onclick="openPrayer(event, 'Consecration to the Holy Spirit')" class="prayer-link-item">Consecration to the Holy Spirit</a>
                        <a href="#" onclick="openPrayer(event, 'Veni Creator Spiritus')" class="prayer-link-item">Veni Creator Spiritus</a>
                    </div>
                </section>
                
                <!-- 4. Devotions to St. Joseph -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-yellow-600" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-yellow-800 mb-4 border-b pb-2">4. Devotions to St. Joseph</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'Litany of St. Joseph')" class="prayer-link-item">Litany of St. Joseph</a>
                        <a href="#" onclick="openPrayer(event, 'Novena to St. Joseph')" class="prayer-link-item">Novena to St. Joseph</a>
                        <a href="#" onclick="openPrayer(event, 'Consecration to St. Joseph')" class="prayer-link-item">Consecration to St. Joseph</a>
                        <a href="#" onclick="openPrayer(event, 'Seven Sundays Devotion')" class="prayer-link-item">Seven Sundays Devotion</a>
                    </div>
                </section>

                <!-- 5. Devotions to Angels -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-cyan-400" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-cyan-700 mb-4 border-b pb-2">5. Devotions to Angels</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'Guardian Angel Prayer')" class="prayer-link-item">Guardian Angel Prayer</a>
                        <a href="#" onclick="openPrayer(event, 'St. Michael the Archangel Chaplet')" class="prayer-link-item">St. Michael Chaplet</a>
                        <a href="#" onclick="openPrayer(event, 'Consecration to St. Michael')" class="prayer-link-item">Consecration to St. Michael</a>
                        <a href="#" onclick="openPrayer(event, 'Prayer to St. Raphael')" class="prayer-link-item">Prayer to St. Raphael</a>
                    </div>
                </section>

                <!-- 6. Devotions to Saints -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-gray-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-gray-700 mb-4 border-b pb-2">6. Devotions to Saints</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'St. Anthony')" class="prayer-link-item">St. Anthony of Padua</a>
                        <a href="#" onclick="openPrayer(event, 'St. Jude')" class="prayer-link-item">St. Jude Thaddeus</a>
                        <a href="#" onclick="openPrayer(event, 'St. Therese')" class="prayer-link-item">St. Therese of Lisieux</a>
                        <a href="#" onclick="openPrayer(event, 'St. Francis')" class="prayer-link-item">St. Francis of Assisi</a>
                        <a href="#" onclick="openPrayer(event, 'St. Benedict')" class="prayer-link-item">St. Benedict (Medal)</a>
                        <a href="#" onclick="openPrayer(event, 'St. Rita')" class="prayer-link-item">St. Rita of Cascia</a>
                        <a href="#" onclick="openPrayer(event, 'St. Dymphna')" class="prayer-link-item">St. Dymphna</a>
                        <a href="#" onclick="openPrayer(event, 'St. Peregrine')" class="prayer-link-item">St. Peregrine</a>
                        <a href="#" onclick="openPrayer(event, 'St. Anne')" class="prayer-link-item">St. Anne</a>
                        <a href="#" onclick="openPrayer(event, 'St. Charles Lwanga & Martyrs')" class="prayer-link-item">St. Charles Lwanga & Ugandan Martyrs</a>
                    </div>
                </section>

                <!-- 7. Devotions for the Holy Souls in Purgatory -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-gray-800" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4 border-b pb-2">7. For the Holy Souls in Purgatory</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'November Devotions')" class="prayer-link-item">November Devotions</a>
                        <a href="#" onclick="openPrayer(event, 'Gregorian Masses')" class="prayer-link-item">Gregorian Masses</a>
                        <a href="#" onclick="openPrayer(event, 'Chaplet for the Dead')" class="prayer-link-item">Chaplet for the Dead</a>
                        <a href="#" onclick="openPrayer(event, 'Indulgences for the Dead')" class="prayer-link-item">Indulgences for the Dead</a>
                    </div>
                </section>

                <!-- 8. Sacramentals & Pious Objects -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-indigo-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-indigo-700 mb-4 border-b pb-2">8. Sacramentals & Pious Objects</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'About Scapulars')" class="prayer-link-item">Scapulars (Brown, Green, etc.)</a>
                        <a href="#" onclick="openPrayer(event, 'About Medals')" class="prayer-link-item">Miraculous Medal & St. Benedict Medal</a>
                        <a href="#" onclick="openPrayer(event, 'About Holy Water')" class="prayer-link-item">Holy Water, Blessed Salt, & Candles</a>
                        <a href="#" onclick="openPrayer(event, 'About Crucifixes')" class="prayer-link-item">Crucifixes and Rosaries</a>
                    </div>
                </section>
                
                <!-- 9. Liturgical-Season Devotions -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-green-600" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-green-800 mb-4 border-b pb-2">9. Liturgical-Season Devotions</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'Advent Wreath & Jesse Tree')" class="prayer-link-item">Advent Wreath & Jesse Tree</a>
                        <a href="#" onclick="openPrayer(event, 'Christmas Novena')" class="prayer-link-item">Christmas Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Epiphany Blessing (Chalking Doors)')" class="prayer-link-item">Epiphany Blessing (Chalking Doors)</a>
                        <a href="#" onclick="openPrayer(event, 'Lent Practices')" class="prayer-link-item">Lent Practices</a>
                        <a href="#" onclick="openPrayer(event, 'Holy Week Rites')" class="prayer-link-item">Holy Week Rites</a>
                        <a href="#" onclick="openPrayer(event, 'Pentecost Vigil')" class="prayer-link-item">Pentecost Vigil</a>
                    </div>
                </section>
                
                <!-- 10. Monthly Devotions -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-teal-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-teal-700 mb-4 border-b pb-2">10. Monthly Devotions</h3>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'January: Holy Name')" class="prayer-link-item">Jan: Holy Name</a>
                        <a href="#" onclick="openPrayer(event, 'February: Holy Family')" class="prayer-link-item">Feb: Holy Family</a>
                        <a href="#" onclick="openPrayer(event, 'March: St. Joseph')" class="prayer-link-item">Mar: St. Joseph</a>
                        <a href="#" onclick="openPrayer(event, 'April: Holy Eucharist')" class="prayer-link-item">Apr: Holy Eucharist</a>
                        <a href="#" onclick="openPrayer(event, 'May: Blessed Virgin Mary')" class="prayer-link-item">May: Blessed Virgin Mary</a>
                        <a href="#" onclick="openPrayer(event, 'June: Sacred Heart')" class="prayer-link-item">Jun: Sacred Heart</a>
                        <a href="#" onclick="openPrayer(event, 'July: Precious Blood')" class="prayer-link-item">Jul: Precious Blood</a>
                        <a href="#" onclick="openPrayer(event, 'August: Immaculate Heart')" class="prayer-link-item">Aug: Immaculate Heart</a>
                        <a href="#" onclick="openPrayer(event, 'September: Our Lady of Sorrows')" class="prayer-link-item">Sep: Our Lady of Sorrows</a>
                        <a href="#" onclick="openPrayer(event, 'October: Holy Rosary')" class="prayer-link-item">Oct: Holy Rosary</a>
                        <a href="#" onclick="openPrayer(event, 'November: Holy Souls')" class="prayer-link-item">Nov: Holy Souls</a>
                        <a href="#" onclick="openPrayer(event, 'December: Immaculate Conception')" class="prayer-link-item">Dec: Immaculate Conception</a>
                    </div>
                </section>
                
                <!-- 11. Associations & Pilgrimages -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-purple-600" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-purple-800 mb-4 border-b pb-2">11. Associations & Pilgrimages</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'Confraternity of the Rosary')" class="prayer-link-item">Confraternity of the Rosary</a>
                        <a href="#" onclick="openPrayer(event, 'Apostleship of Prayer')" class="prayer-link-item">Apostleship of Prayer</a>
                        <a href="#" onclick="openPrayer(event, 'Legion of Mary')" class="prayer-link-item">Legion of Mary</a>
                        <a href="#" onclick="openPrayer(event, 'Third Orders')" class="prayer-link-item">Third Orders</a>
                        <a href="#" onclick="openPrayer(event, 'Pilgrimages (Lourdes, Fatima, etc.)')" class="prayer-link-item">Pilgrimages</a>
                    </div>
                </section>
                
                <!-- 12. Local & Cultural Devotions -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-pink-600" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-pink-800 mb-4 border-b pb-2">12. Local & Cultural Devotions</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'St. Charles Lwanga & Ugandan Martyrs')" class="prayer-link-item">St. Charles Lwanga & Ugandan Martyrs</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Kibeho (Africa)')" class_name="prayer-link-item">Our Lady of Kibeho (Africa)</a>
                        <a href="#" onclick="openPrayer(event, 'Santo Nio (Philippines)')" class="prayer-link-item">Santo Nio (Philippines)</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Aparecida (Brazil)')" class="prayer-link-item">Our Lady of Aparecida (Brazil)</a>
                    </div>
                </section>

            </div>
            `;
        }

        // NEW: Function to generate the Litanies page
        function getFullLitaniesContent() {
            return `
            <div class="space-y-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">Treasury of Litanies</h2>

                <!-- 1. Litanies Approved for Public Liturgical Use -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-sky-600" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-sky-700 mb-4 border-b pb-2">Litanies Approved for Public Liturgical Use</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'The Litany of the Saints')" class="prayer-link-item">The Litany of the Saints</a>
                        <a href="#" onclick="openPrayer(event, 'The Litany of the Blessed Virgin Mary (The Litany of Loreto)')" class="prayer-link-item">The Litany of the Blessed Virgin Mary (The Litany of Loreto)</a>
                        <a href="#" onclick="openPrayer(event, 'The Litany of the Holy Name of Jesus')" class="prayer-link-item">The Litany of the Holy Name of Jesus</a>
                        <a href="#" onclick="openPrayer(event, 'The Litany of the Sacred Heart of Jesus')" class="prayer-link-item">The Litany of the Sacred Heart of Jesus</a>
                        <a href="#" onclick="openPrayer(event, 'The Litany of Saint Joseph')" class="prayer-link-item">The Litany of Saint Joseph</a>
                        <a href="#" onclick="openPrayer(event, 'The Litany of the Most Precious Blood of Jesus')" class="prayer-link-item">The Litany of the Most Precious Blood of Jesus</a>
                        <a href="#" onclick="openPrayer(event, 'The Litany for the Coronation of Images of the Blessed Virgin Mary')" class="prayer-link-item">The Litany for the Coronation of Images of the Blessed Virgin Mary</a>
                        <a href="#" onclick="openPrayer(event, 'The Litany (For use in the Personal Ordinariates)')" class="prayer-link-item">"The Litany" (For use in the Personal Ordinariates)</a>
                    </div>
                </section>

                <!-- 2. Litanies for Private Devotional Use -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-violet-600" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-violet-700 mb-4 border-b pb-2">Litanies for Private Devotional Use</h3>
                    
                    <div class="space-y-6">
                        <div>
                            <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Thematic & Devotional Litanies (General)</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                <a href="#" onclick="openPrayer(event, 'Litany of the Most Holy Trinity')" class="prayer-link-item">Litany of the Most Holy Trinity</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of God the Father')" class="prayer-link-item">Litany of God the Father</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of the Holy Spirit')" class="prayer-link-item">Litany of the Holy Spirit</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of the Most Blessed Sacrament')" class="prayer-link-item">Litany of the Most Blessed Sacrament</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of the Passion')" class="prayer-link-item">Litany of the Passion</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Christ the King')" class="prayer-link-item">Litany of Christ the King</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for Holy Communion')" class="prayer-link-item">Litany for Holy Communion</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of the Good Shepherd')" class="prayer-link-item">Litany of the Good Shepherd</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of the Holy Cross')" class="prayer-link-item">Litany of the Holy Cross</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Divine Mercy')" class="prayer-link-item">Litany of Divine Mercy</a>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Thematic & Devotional Litanies (Marian)</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                <a href="#" onclick="openPrayer(event, 'Litany of the Immaculate Heart of Mary')" class="prayer-link-item">Litany of the Immaculate Heart of Mary</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Our Lady of Sorrows')" class="prayer-link-item">Litany of Our Lady of Sorrows</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of the Immaculate Conception')" class="prayer-link-item">Litany of the Immaculate Conception</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of the Most Holy Name of Mary')" class="prayer-link-item">Litany of the Most Holy Name of Mary</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Our Lady of Mount Carmel')" class="prayer-link-item">Litany of Our Lady of Mount Carmel</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Our Lady of Fatima')" class="prayer-link-item">Litany of Our Lady of Fatima</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Our Lady of Victory')" class="prayer-link-item">Litany of Our Lady of Victory</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of the Blessed Virgin Mary, Mediatrix of all Graces')" class="prayer-link-item">Litany of the BVM, Mediatrix of all Graces</a>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Thematic & Devotional Litanies (Virtues, Life, and Eschatological)</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                <a href="#" onclick="openPrayer(event, 'Litany of Humility')" class="prayer-link-item">Litany of Humility</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for the Holy Souls in Purgatory')" class="prayer-link-item">Litany for the Holy Souls in Purgatory</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for a Happy Death')" class="prayer-link-item">Litany for a Happy Death</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for the Dying')" class="prayer-link-item">Litany for the Dying</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for Interior Peace')" class="prayer-link-item">Litany for Interior Peace</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for Life')" class="prayer-link-item">Litany for Life (or in Response to Abortion)</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Deliverance')" class="prayer-link-item">Litany of Deliverance</a>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Hagiographical Litanies (Angels)</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                <a href="#" onclick="openPrayer(event, 'Litany of the Holy Angels')" class="prayer-link-item">Litany of the Holy Angels</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of the Holy Guardian Angel')" class="prayer-link-item">Litany of the Holy Guardian Angel</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Michael the Archangel')" class="prayer-link-item">Litany of St. Michael the Archangel</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Gabriel the Archangel')" class="prayer-link-item">Litany of St. Gabriel the Archangel</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Raphael the Archangel')" class="prayer-link-item">Litany of St. Raphael the Archangel</a>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Hagiographical Litanies (Saints: Groups & Specific Rites)</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                <a href="#" onclick="openPrayer(event, 'Litany of the Martyrs')" class="prayer-link-item">Litany of the Martyrs</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of the Fourteen Holy Helpers')" class="prayer-link-item">Litany of the Fourteen Holy Helpers</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of the Forty English Martyrs')" class="prayer-link-item">Litany of the Forty English Martyrs</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Irish Saints')" class="prayer-link-item">Litany of Irish Saints</a>
                                <a href="#" onclick="openPrayer(event, 'Dominican Rite Litany')" class="prayer-link-item">Dominican Rite Litany</a>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Hagiographical Litanies (Saints: Individuals)</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Anne')" class="prayer-link-item">Litany of St. Anne</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Alphonse Liguori')" class="prayer-link-item">Litany of St. Alphonse Liguori</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Aloysius Gonzaga')" class="prayer-link-item">Litany of St. Aloysius Gonzaga</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Angela Merici')" class="prayer-link-item">Litany of St. Angela Merici</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Anne')" class="prayer-link-item">Litany of St. Anne</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Anthony of Padua')" class="prayer-link-item">Litany of St. Anthony of Padua</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Benedict')" class="prayer-link-item">Litany of St. Benedict</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Benedict Joseph Labre')" class="prayer-link-item">Litany of St. Benedict Joseph Labre</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Bernard of Clairvaux')" class="prayer-link-item">Litany of St. Bernard of Clairvaux</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Boniface')" class="prayer-link-item">Litany of St. Boniface</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Catherine of Siena')" class="prayer-link-item">Litany of St. Catherine of Siena</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Cecilia')" class="prayer-link-item">Litany of St. Cecilia</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Clare of Assisi')" class="prayer-link-item">Litany of St. Clare of Assisi</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Columba')" class="prayer-link-item">Litany of St. Columba</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of the Cur of Ars (St. John Vianney)')" class="prayer-link-item">Litany of the Cur of Ars (St. John Vianney)</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Dominic')" class="prayer-link-item">Litany of St. Dominic</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Dymphna')" class="prayer-link-item">Litany of St. Dymphna</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Elizabeth of Hungary')" class="prayer-link-item">Litany of St. Elizabeth of Hungary</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Francis of Assisi')" class="prayer-link-item">Litany of St. Francis of Assisi</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Francis de Sales')" class="prayer-link-item">Litany of St. Francis de Sales</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Francis Xavier')" class="prayer-link-item">Litany of St. Francis Xavier</a>
                                <a href="#" onclick="openPrayer(event, 'Litany in Honor of St. George')" class="prayer-link-item">Litany in Honor of St. George</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Gerard Majella')" class="prayer-link-item">Litany of St. Gerard Majella</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Gertrude the Great')" class="prayer-link-item">Litany of St. Gertrude the Great</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Gianna Molla')" class="prayer-link-item">Litany of St. Gianna Molla</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Joan of Arc')" class="prayer-link-item">Litany of St. Joan of Arc</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. John the Baptist')" class="prayer-link-item">Litany of St. John the Baptist</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. John Berchmans')" class="prayer-link-item">Litany of St. John Berchmans</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. John of the Cross')" class="prayer-link-item">Litany of St. John of the Cross</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. John of God')" class="prayer-link-item">Litany of St. John of God</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Jude')" class="prayer-link-item">Litany of St. Jude</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Blessed Kateri Tekawitha')" class="prayer-link-item">Litany of Blessed Kateri Tekawitha</a>
                                <a href="#" onclick="openPrayer(event, 'Litany to St. Louis de Montfort')" class="prayer-link-item">Litany to St. Louis de Montfort</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Louis, King of France')" class="prayer-link-item">Litany of St. Louis, King of France</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Martin de Porres')" class="prayer-link-item">Litany of St. Martin de Porres</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Mary Magdalen')" class="prayer-link-item">Litany of St. Mary Magdalen</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Michael of the Saints (Patron of Cancer Patients)')" class="prayer-link-item">Litany of St. Michael of the Saints (Patron of Cancer Patients)</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Odilia')" class="prayer-link-item">Litany of St. Odilia</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Patrick')" class="prayer-link-item">Litany of St. Patrick (The Breastplate)</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Paul')" class="prayer-link-item">Litany of St. Paul</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Peter')" class="prayer-link-item">Litany of St. Peter</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Philip Neri')" class="prayer-link-item">Litany of St. Philip Neri</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Philomena')" class="prayer-link-item">Litany of St. Philomena</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Pope St. Pius X')" class="prayer-link-item">Litany of Pope St. Pius X</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Rita of Cascia')" class="prayer-link-item">Litany of St. Rita of Cascia</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Rose of Lima')" class="prayer-link-item">Litany of St. Rose of Lima</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Scholastica')" class="prayer-link-item">Litany of St. Scholastica</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Teresa of Avila')" class="prayer-link-item">Litany of St. Teresa of Avila</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Therese (The Little Flower)')" class="prayer-link-item">Litany of St. Therese (The Little Flower)</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Thomas Aquinas')" class="prayer-link-item">Litany of St. Thomas Aquinas</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Thomas More')" class="prayer-link-item">Litany of St. Thomas More</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Ven. Pauline Jaricot')" class="prayer-link-item">Litany of Ven. Pauline Jaricot</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of St. Vincent de Paul')" class="prayer-link-item">Litany of St. Vincent de Paul</a>
                                <a href="#" onclick="showToast('More litanies of saints coming soon!')" class="prayer-link-item">... and many more</a>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Other Thematic & Occasional Litanies</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                <a href="#" onclick="openPrayer(event, 'Litany for Priests')" class="prayer-link-item">Litany for Priests</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for the Church in Our Time')" class="prayer-link-item">Litany for the Church in Our Time</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for America')" class="prayer-link-item">Litany for America</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for Sunday')" class="prayer-link-item">Litany for Sunday</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Creation (8th century Irish)')" class="prayer-link-item">Litany of Creation (8th century Irish)</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Confession (8th century Irish)')" class="prayer-link-item">Litany of Confession (8th century Irish)</a>
                                <a href="#" onclick="openPrayer(event, 'Litany of Intercession for England')" class="prayer-link-item">Litany of Intercession for England</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for Liberty')" class="prayer-link-item">Litany for Liberty</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for the Church in Our Time')" class="prayer-link-item">Litany for the Church in Our Time</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for America')" class="prayer-link-item">Litany for America</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for Sunday')" class="prayer-link-item">Litany for Sunday</a>
                                <a href="#" onclick="openPrayer(event, 'Litany for Liberty')" class="prayer-link-item">Litany for Liberty</a>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            `;
        }

        // --- NEW ROSARY PAGE CONTENT ---
        function getFullRosaryContent(info) {
            // This function returns the HTML for the Rosary Player sub-page
            
            // Determine today's mysteries for the default button
            const todayDay = new Date().getDay(); // 0=Sun, 1=Mon, 2=Tue, 3=Wed, 4=Thu, 5=Fri, 6=Sat
            let todaysMysteries = 'joyful';
            let todaysMysteriesName = 'Joyful';
            
            if ([0, 3].includes(todayDay)) {
                todaysMysteries = 'glorious';
                todaysMysteriesName = 'Glorious';
            } else if ([2, 5].includes(todayDay)) {
                todaysMysteries = 'sorrowful';
                todaysMysteriesName = 'Sorrowful';
            } else if (todayDay === 4) {
                todaysMysteries = 'luminous';
                todaysMysteriesName = 'Luminous';
            }
            // Mon, Sat default to Joyful
            
            return `
                <div class="space-y-8">
                    <!-- 1. Header with Back Button -->
                    <div class="flex items-center justify-between">
                        <a href="#" onclick="goBackToDevotionsList(event)" class="flex items-center text-sm font-semibold text-gray-600 hover:text-gray-800 transition">
                            <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                            Back to Devotions
                        </a>
                        <h2 class="text-3xl font-bold text-gray-800 text-center">The Holy Rosary</h2>
                        <div class="w-20"></div> <!-- Spacer -->
                    </div>

                    <!-- 2. Begin Prayer Section -->
                    <section class="p-6 rounded-xl shadow-lg border-t-4 border-blue-500 text-center" style="background-color: var(--color-card-bg);">
                        <h3 class="text-2xl font-bold text-blue-700 mb-4">Pray Today's Mysteries</h3>
                        <p class="text-gray-600 mb-6">Today (${todaysMysteriesName.toLowerCase()} mysteries) or choose a set below.</p>
                        
                        <!-- This button launches the full-screen modal player -->
                        <button onclick="launchRosaryPlayer('${todaysMysteries}')" class="w-full max-w-md mx-auto px-6 py-4 rounded-lg text-white font-bold text-lg transition shadow-lg hover:shadow-xl" style="background-color: var(--color-primary); color: white;">
                            Begin ${todaysMysteriesName} Mysteries
                        </button> 
                    </section>

                    <!-- 3. Choose Other Mysteries -->
                    <section class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-bold text-gray-800 mb-5 text-center">Or, Choose a Mystery to Pray</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            
                            <!-- Joyful -->
                            <div class="p-4 border border-gray-200 rounded-lg shadow-sm bg-gray-50">
                                <h4 class="text-lg font-semibold text-gray-700">Joyful Mysteries</h4>
                                <p class="text-sm text-gray-500 mb-3">(Mon, Sat, Advent, Christmas)</p>
                                <div class="flex flex-wrap gap-2">
                                    <button onclick="launchRosaryPlayer('joyful')" class="flex-grow px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition">Pray Now</button>
                                    <button onclick="openRosaryMysteryModal('joyful')" class="flex-shrink-0 px-4 py-2 text-sm font-semibold text-blue-600 bg-blue-100 rounded-lg hover:bg-blue-200 transition">See Mysteries</button>
                                </div>
                            </div>

                            <!-- Luminous -->
                            <div class="p-4 border border-gray-200 rounded-lg shadow-sm bg-gray-50">
                                <h4 class="text-lg font-semibold text-gray-700">Luminous Mysteries</h4>
                                <p class="text-sm text-gray-500 mb-3">(Thursday)</p>
                                <div class="flex flex-wrap gap-2">
                                    <button onclick="launchRosaryPlayer('luminous')" class="flex-grow px-4 py-2 text-sm font-semibold text-white bg-yellow-500 rounded-lg hover:bg-yellow-600 transition">Pray Now</button>
                                    <button onclick="openRosaryMysteryModal('luminous')" class="flex-shrink-0 px-4 py-2 text-sm font-semibold text-yellow-600 bg-yellow-100 rounded-lg hover:bg-yellow-200 transition">See Mysteries</button>
                                </div>
                            </div>
                            
                            <!-- Sorrowful -->
                            <div class="p-4 border border-gray-200 rounded-lg shadow-sm bg-gray-50">
                                <h4 class="text-lg font-semibold text-gray-700">Sorrowful Mysteries</h4>
                                <p class="text-sm text-gray-500 mb-3">(Tue, Fri, Lent)</p>
                                <div class="flex flex-wrap gap-2">
                                    <button onclick="launchRosaryPlayer('sorrowful')" class="flex-grow px-4 py-2 text-sm font-semibold text-white bg-red-600 rounded-lg hover:bg-red-700 transition">Pray Now</button>
                                    <button onclick="openRosaryMysteryModal('sorrowful')" class="flex-shrink-0 px-4 py-2 text-sm font-semibold text-red-600 bg-red-100 rounded-lg hover:bg-red-200 transition">See Mysteries</button>
                                </div>
                            </div>
                            
                            <!-- Glorious -->
                            <div class="p-4 border border-gray-200 rounded-lg shadow-sm bg-gray-50">
                                <h4 class="text-lg font-semibold text-gray-700">Glorious Mysteries</h4>
                                <p class="text-sm text-gray-500 mb-3">(Wed, Sun, Easter)</p>
                                <div class="flex flex-wrap gap-2">
                                    <button onclick="launchRosaryPlayer('glorious')" class="flex-grow px-4 py-2 text-sm font-semibold text-white bg-green-600 rounded-lg hover:bg-green-700 transition">Pray Now</button>
                                    <button onclick="openRosaryMysteryModal('glorious')" class="flex-shrink-0 px-4 py-2 text-sm font-semibold text-green-600 bg-green-100 rounded-lg hover:bg-green-200 transition">See Mysteries</button>
                                </div>
                            </div>

                        </div>
                    </section>
                </div>
            `;
        }

        // NEW: Function to generate the full Novenas tab content
        function getFullNovenasContent() {
            return `
            <div class="space-y-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">Treasury of Novenas</h2>

                <!-- Novenas by Start Date -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-blue-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-blue-700 mb-4 border-b pb-2">Novenas by Start Date</h3>
                    
                    <h4 class="text-xl font-semibold text-gray-800 mt-6 mb-3">January</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"> 
                        <a href="#" onclick="openPrayer(event, 'Surrender Novena')" class="prayer-link-item">Jan 2: Surrender Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Infant of Prague Novena')" class="prayer-link-item">Jan 5: Infant of Prague Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Hope Novena')" class="prayer-link-item">Jan 8: Our Lady of Hope Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Sebastian Novena')" class="prayer-link-item">Jan 11: St. Sebastian Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Agnes Novena')" class="prayer-link-item">Jan 12: St. Agnes Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Marianne Cope Novena')" class="prayer-link-item">Jan 14: St. Marianne Cope Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Francis de Sales Novena')" class="prayer-link-item">Jan 15: St. Francis de Sales Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Angela Merici Novena')" class="prayer-link-item">Jan 18: St. Angela Merici Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Angelic Warfare Confraternity Novena')" class="prayer-link-item">Jan 19: Angelic Warfare Confraternity Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Thomas Aquinas Novena')" class="prayer-link-item">Jan 19: St. Thomas Aquinas Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Respect Life Novena')" class="prayer-link-item">Jan 20: Respect Life Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. John Bosco Novena')" class="prayer-link-item">Jan 22: St. John Bosco Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Brigid of Ireland Novena')" class="prayer-link-item">Jan 23: St. Brigid of Ireland Novena</a>
                    </div>

                    <h4 class="text-xl font-semibold text-gray-800 mt-6 mb-3">February</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'St. Jude Winter Solemn Novena')" class="prayer-link-item">Feb 7: St. Jude Winter Solemn Novena</a>
                        <a href="#" onclick="openPrayer(event, '30 Day Novena to St. Joseph')" class="prayer-link-item">Feb 17: 30 Day Novena to St. Joseph</a>
                    </div>

                    <h4 class="text-xl font-semibold text-gray-800 mt-6 mb-3">March</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Novena to St. Benedict (March)')" class="prayer-link-item">Mar 12: Novena to St. Benedict (in preparation for his March 21 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'Annunciation Novena')" class="prayer-link-item">Mar 16: Annunciation Novena (in preparation for the March 25 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'The 54 Day Rosary Novena')" class="prayer-link-item">Mar 20: The 54 Day Rosary Novena (a traditional start date, ending on May 13)</a>
                    </div>

                    <h4 class="text-xl font-semibold text-gray-800 mt-6 mb-3">April</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'St. Peregrine Novena')" class="prayer-link-item">Apr 22: St. Peregrine Novena (in preparation for his May 1 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'St. Jude Spring Solemn Novena')" class="prayer-link-item">Apr 25: St. Jude Spring Solemn Novena</a>
                    </div>

                    <h4 class="text-xl font-semibold text-gray-800 mt-6 mb-3">May</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'St. Joan of Arc Novena')" class="prayer-link-item">May 21: St. Joan of Arc Novena (in preparation for her May 30 feast)</a>
                    </div>

                    <h4 class="text-xl font-semibold text-gray-800 mt-6 mb-3">June</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'St. Anthony of Padua Novena')" class="prayer-link-item">June 4: St. Anthony of Padua Novena (in preparation for his June 13 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'St. Alice of Schaerbeek Novena')" class="prayer-link-item">June 6: St. Alice of Schaerbeek Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. John Francis Regis Novena')" class="prayer-link-item">June 7: St. John Francis Regis Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Elizabeth of Schonau Novena')" class="prayer-link-item">June 9: St. Elizabeth of Schonau Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Saint Juliana Falconieri Novena')" class="prayer-link-item">June 10: Saint Juliana Falconieri Novena</a>
                        <a href="#" onclick="openPrayer(event, '17 Irish Martyrs Novena')" class="prayer-link-item">June 11: 17 Irish Martyrs Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Thomas More Novena')" class="prayer-link-item">June 13: St. Thomas More Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Saint John Fisher Novena')" class="prayer-link-item">June 13: Saint John Fisher Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Saint Joseph Cafasso Novena')" class="prayer-link-item">June 14: Saint Joseph Cafasso Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. John the Baptist Novena')" class="prayer-link-item">June 15: St. John the Baptist Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Prosper of Aquitaine Novena')" class="prayer-link-item">June 16: St. Prosper of Aquitaine Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Jude June Solemn Novena')" class="prayer-link-item">June 20: St. Jude June Solemn Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Novena to the Precious Blood')" class="prayer-link-item">June 22: Novena to the Precious Blood</a>
                    </div>

                    <h4 class="text-xl font-semibold text-gray-800 mt-6 mb-3">July</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Novena to St. Benedict (July)')" class="prayer-link-item">July 2: Novena to St. Benedict (in preparation for his July 11 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'Novena to Our Lady of Mount Carmel')" class="prayer-link-item">July 7: Novena to Our Lady of Mount Carmel (in preparation for the July 16 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'Novena to St. Ann (July)')" class="prayer-link-item">July 17: Novena to St. Ann (in preparation for her July 26 feast)</a>
                    </div>

                    <h4 class="text-xl font-semibold text-gray-800 mt-6 mb-3">August</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Assumption Novena')" class="prayer-link-item">Aug 6: Assumption Novena (in preparation for the August 15 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'Novena to Our Lady of Knock')" class="prayer-link-item">Aug 13: Novena to Our Lady of Knock (in preparation for the August 21 anniversary)</a>
                        <a href="#" onclick="openPrayer(event, 'St. Jude August Solemn Novena')" class="prayer-link-item">Aug 15: St. Jude August Solemn Novena</a>
                    </div>

                    <h4 class="text-xl font-semibold text-gray-800 mt-6 mb-3">September</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Novena to St. Thrse of Lisieux')" class="prayer-link-item">Sep 22: Novena to St. Thrse of Lisieux (The Little Flower) (in preparation for her Oct 1 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of the Holy Rosary Novena')" class="prayer-link-item">Sep 28: Our Lady of the Holy Rosary Novena (in preparation for the Oct 7 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Good Remedy Novena')" class="prayer-link-item">Sep 29: Our Lady of Good Remedy Novena (in preparation for the Oct 8 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Champion Novena')" class="prayer-link-item">Sep 30: Our Lady of Champion Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. John Henry Newman Novena')" class="prayer-link-item">Sep 30: St. John Henry Newman Novena</a>
                    </div>

                    <h4 class="text-xl font-semibold text-gray-800 mt-6 mb-3">October</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Our Lady of La Leche Novena')" class="prayer-link-item">Oct 2: Our Lady of La Leche Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Carlo Acutis Novena')" class="prayer-link-item">Oct 3: St. Carlo Acutis Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Teresa of Avila Novena')" class="prayer-link-item">Oct 6: St. Teresa of Avila Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Gerard Majella Novena')" class="prayer-link-item">Oct 7: St. Gerard Majella Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Margaret Mary Alacoque Novena')" class="prayer-link-item">Oct 7: St. Margaret Mary Alacoque Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Luke Novena')" class="prayer-link-item">Oct 9: St. Luke Novena</a>
                        <a href="#" onclick="openPrayer(event, 'North American Martyrs Novena')" class="prayer-link-item">Oct 10: North American Martyrs Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Paul of the Cross Novena')" class="prayer-link-item">Oct 11: St. Paul of the Cross Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Pope St. John Paul II Novena')" class="prayer-link-item">Oct 13: Pope St. John Paul II Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Anthony Mary Claret Novena')" class="prayer-link-item">Oct 15: St. Anthony Mary Claret Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Jude Novena (Miraculous Prayer)')" class="prayer-link-item">Oct 19: St. Jude Novena (Miraculous Prayer) (in preparation for the Oct 28 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'All Saints Novena')" class="prayer-link-item">Oct 23: All Saints Novena (in preparation for the Nov 1 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for the Holy Souls in Purgatory')" class="prayer-link-item">Oct 24: Novena for the Holy Souls in Purgatory (in preparation for All Souls' Day, Nov 2)</a>
                        <a href="#" onclick="openPrayer(event, 'St. Martin de Porres Novena')" class="prayer-link-item">Oct 25: St. Martin de Porres Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Election Novena')" class="prayer-link-item">Oct 26: Election Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Charles Borromeo Novena')" class="prayer-link-item">Oct 26: St. Charles Borromeo Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Elizabeth Novena (October)')" class="prayer-link-item">Oct 27: St. Elizabeth Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Elizabeth of the Trinity Novena')" class="prayer-link-item">Oct 31: St. Elizabeth of the Trinity Novena</a>
                    </div>

                    <h4 class="text-xl font-semibold text-gray-800 mt-6 mb-3">November</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Pope St. Leo the Great Novena')" class="prayer-link-item">Nov 1: Pope St. Leo the Great Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Andrew Avellino Novena')" class="prayer-link-item">Nov 1: St. Andrew Avellino Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Martin of Tours Novena')" class="prayer-link-item">Nov 2: St. Martin of Tours Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Frances Xavier Cabrini Novena')" class="prayer-link-item">Nov 4: St. Frances Xavier Cabrini Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Homobonus Novena')" class="prayer-link-item">Nov 4: St. Homobonus Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Albert the Great Novena')" class="prayer-link-item">Nov 6: St. Albert the Great Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Gertrude the Great Prayers for the Souls in Purgatory Novena')" class="prayer-link-item">Nov 7: St. Gertrude the Great Prayers for the Souls in Purgatory Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Giuseppe Moscati Novena')" class="prayer-link-item">Nov 7: St. Giuseppe Moscati Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Margaret of Scotland Novena')" class="prayer-link-item">Nov 7: St. Margaret of Scotland Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Elizabeth of Hungary Novena')" class="prayer-link-item">Nov 8: St. Elizabeth of Hungary Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Rose Philippine Duchesne Novena')" class="prayer-link-item">Nov 9: St. Rose Philippine Duchesne Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Presentation of the Blessed Virgin Mary Novena')" class="prayer-link-item">Nov 12: Presentation of the Blessed Virgin Mary Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Cecilia Novena')" class="prayer-link-item">Nov 13: St. Cecilia Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Blessed Miguel Agustin Pro Novena')" class="prayer-link-item">Nov 14: Blessed Miguel Agustin Pro Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Catherine of Alexandria Novena')" class="prayer-link-item">Nov 16: St. Catherine of Alexandria Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Miraculous Medal Novena')" class="prayer-link-item">Nov 18: Miraculous Medal Novena (in preparation for the Nov 27 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'St. Edmund Campion Novena')" class="prayer-link-item">Nov 22: St. Edmund Campion Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. John of Damascus Novena')" class="prayer-link-item">Nov 25: St. John of Damascus Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Nicholas of Myra Novena')" class="prayer-link-item">Nov 27: St. Nicholas of Myra Novena (in preparation for his Dec 6 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'St. Ambrose Novena')" class="prayer-link-item">Nov 28: St. Ambrose Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Immaculate Conception Novena')" class="prayer-link-item">Nov 29: Immaculate Conception Novena (in preparation for the Dec 8 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'Venerable Fulton Sheen Novena')" class="prayer-link-item">Nov 30: Venerable Fulton Sheen Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Andrew Christmas Novena')" class="prayer-link-item">Nov 30: St. Andrew Christmas Novena (prayed 15 times a day until Christmas)</a>
                        <a href="#" onclick="openPrayer(event, 'St. Juan Diego Novena')" class="prayer-link-item">Nov 30: St. Juan Diego Novena</a>
                    </div>

                    <h4 class="text-xl font-semibold text-gray-800 mt-6 mb-3">December</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Guadalupe Novena')" class="prayer-link-item">Dec 3: Our Lady of Guadalupe Novena (in preparation for the Dec 12 feast)</a>
                        <a href="#" onclick="openPrayer(event, 'St. Lucy Novena')" class="prayer-link-item">Dec 4: St. Lucy Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. John of the Cross Novena')" class="prayer-link-item">Dec 5: St. John of the Cross Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Adelaide Novena')" class="prayer-link-item">Dec 7: St. Adelaide Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Christmas Novena (general)')" class="prayer-link-item">Dec 16: Christmas Novena (general)</a>
                        <a href="#" onclick="openPrayer(event, 'St. Stephen Novena')" class="prayer-link-item">Dec 17: St. Stephen Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. John the Apostle Novena')" class="prayer-link-item">Dec 18: St. John the Apostle Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Holy Family Novena')" class="prayer-link-item">Dec 19: Holy Family Novena (traditionally starts 9 days before the feast)</a>
                        <a href="#" onclick="openPrayer(event, 'Holy Innocents Novena')" class="prayer-link-item">Dec 19: Holy Innocents Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Thomas Becket Novena')" class="prayer-link-item">Dec 20: St. Thomas Becket Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Holy Name of Jesus Novena')" class="prayer-link-item">Dec 25: Holy Name of Jesus Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Genevieve Novena')" class="prayer-link-item">Dec 25: St. Genevieve Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Christmas Novena of Masses')" class="prayer-link-item">Dec 25: Christmas Novena of Masses (an online novena)</a>
                        <a href="#" onclick="openPrayer(event, 'St. Elizabeth Ann Seton Novena')" class="prayer-link-item">Dec 26: St. Elizabeth Ann Seton Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. John Neumann Novena')" class="prayer-link-item">Dec 27: St. John Neumann Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Novena to the Magi')" class="prayer-link-item">Dec 28: Novena to the Magi (in preparation for Epiphany)</a>
                        <a href="#" onclick="openPrayer(event, 'St. Andre Bessette Novena')" class="prayer-link-item">Dec 28: St. Andre Bessette Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Black Nazarene Novena (December)')" class="prayer-link-item">Dec 31: Black Nazarene Novena (in preparation for the Jan 9 feast)</a>
                    </div>
                </section>

                <!-- Novenas with Floating Dates -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-green-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-green-700 mb-4 border-b pb-2">Novenas with Floating Dates (Liturgical Calendar)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'Divine Mercy Novena')" class="prayer-link-item">Divine Mercy Novena (Starts Good Friday)</a>
                        <a href="#" onclick="openPrayer(event, 'Holy Spirit Novena (Pentecost Novena)')" class="prayer-link-item">Holy Spirit Novena (Starts day after Ascension)</a>
                        <a href="#" onclick="openPrayer(event, 'Novena to the Sacred Heart')" class="prayer-link-item">Novena to the Sacred Heart (Starts 9 days before Feast of Sacred Heart)</a>
                        <a href="#" onclick="openPrayer(event, 'Corpus Christi Novena')" class="prayer-link-item">Corpus Christi Novena (Starts 9 days before Feast of Corpus Christi)</a>
                        <a href="#" onclick="openPrayer(event, 'Christ the King Novena')" class="prayer-link-item">Christ the King Novena (Starts 9 days before Feast of Christ the King)</a>
                        <a href="#" onclick="openPrayer(event, 'Ascension Novena')" class="prayer-link-item">Ascension Novena (Starts 9 days before Feast of the Ascension)</a>
                    </div>
                </section>

                <!-- Weekly Novenas -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-purple-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-purple-700 mb-4 border-b pb-2">Weekly Novenas</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, 'Novena to Our Mother of Perpetual Help (Wednesdays)')" class="prayer-link-item">Wednesdays: Novena to Our Mother of Perpetual Help</a>
                        <a href="#" onclick="openPrayer(event, 'St. Jude Novena (Thursdays)')" class="prayer-link-item">Thursdays: St. Jude Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Black Nazarene Novena (Fridays)')" class="prayer-link-item">Fridays: Black Nazarene Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Novena to St. Ann (Mondays)')" class="prayer-link-item">Mondays: Novena to St. Ann (at some shrines)</a>
                    </div>
                </section>

                <!-- Novenas with No Specified Traditional Start Date -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-gray-500" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-gray-700 mb-4 border-b pb-2">Novenas for Any Time of Year</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4">
                        <a href="#" onclick="openPrayer(event, '14 Holy Helpers Novena')" class="prayer-link-item">14 Holy Helpers Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Anniversary Novena')" class="prayer-link-item">Anniversary Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Bereavement Novena')" class="prayer-link-item">Bereavement Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Bethlehem Novena')" class="prayer-link-item">Bethlehem Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Blessed Anacleto Gonzalez Flores Novena')" class="prayer-link-item">Blessed Anacleto Gonzalez Flores Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Blessed Engelmar Unzeitig Novena')" class="prayer-link-item">Blessed Engelmar Unzeitig Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Blessed Fr. Michael McGivney Novena')" class="prayer-link-item">Blessed Fr. Michael McGivney Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Blessed Imelda Novena')" class="prayer-link-item">Blessed Imelda Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Blessed Solanus Casey Novena')" class="prayer-link-item">Blessed Solanus Casey Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Conversion of the Youth Novena')" class="prayer-link-item">Conversion of the Youth Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Cyril of Jerusalem Novena')" class="prayer-link-item">Cyril of Jerusalem Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Dedication of St. Mary Major Basilica Novena')" class="prayer-link-item">Dedication of St. Mary Major Basilica Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Doubting Thomas Novena for Faith')" class="prayer-link-item">Doubting Thomas Novena for Faith</a>
                        <a href="#" onclick="openPrayer(event, 'Easter Novena')" class="prayer-link-item">Easter Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Forgiveness Novena')" class="prayer-link-item">Forgiveness Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Guardian Angel Novena')" class="prayer-link-item">Guardian Angel Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Healing from Childhood Trauma Novena')" class="prayer-link-item">Healing from Childhood Trauma Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Homeschool Novena')" class="prayer-link-item">Homeschool Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Litany of Humility Novena')" class="prayer-link-item">Litany of Humility Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Litany of Trust Novena')" class="prayer-link-item">Litany of Trust Novena</a>
                        <a href="#" onclick="openPrayer(event, 'March for Life Novena')" class="prayer-link-item">March for Life Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Maria Bambina Novena')" class="prayer-link-item">Maria Bambina Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Mary Help of Christians Novena')" class="prayer-link-item">Mary Help of Christians Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Mary, Mother of God Novena')" class="prayer-link-item">Mary, Mother of God Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Mary Queen of All Hearts Novena')" class="prayer-link-item">Mary Queen of All Hearts Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Mary Queen of Angels Novena')" class="prayer-link-item">Mary Queen of Angels Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Mary Queen of Apostles Novena')" class="prayer-link-item">Mary Queen of Apostles Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Mary, Undoer of Knots Novena')" class="prayer-link-item">Mary, Undoer of Knots Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Memorare Novena')" class="prayer-link-item">Memorare Novena ("Flying Novena" of Mother Teresa)</a>
                        <a href="#" onclick="openPrayer(event, 'Mother Angelica Novena')" class="prayer-link-item">Mother Angelica Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Nativity of the Blessed Virgin Mary Novena')" class="prayer-link-item">Nativity of the Blessed Virgin Mary Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Novemdiales Novena')" class="prayer-link-item">Novemdiales Novena (prayed for a deceased Pope)</a>
                        <a href="#" onclick="openPrayer(event, 'Novena against Evil')" class="prayer-link-item">Novena against Evil</a>
                        <a href="#" onclick="openPrayer(event, 'Novena Against Fear')" class="prayer-link-item">Novena Against Fear</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Addiction Recovery')" class="prayer-link-item">Novena for Addiction Recovery</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for a Difficult Pregnancy')" class="prayer-link-item">Novena for a Difficult Pregnancy</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Adoration of the Eucharist')" class="prayer-link-item">Novena for Adoration of the Eucharist</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Anxiety and Depression (to St. Dymphna)')" class="prayer-link-item">Novena for Anxiety and Depression (to St. Dymphna)</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Baptism')" class="prayer-link-item">Novena for Baptism</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Bishops')" class="prayer-link-item">Novena for Bishops</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Broken Families')" class="prayer-link-item">Novena for Broken Families</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Business Success')" class="prayer-link-item">Novena for Business Success</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Cancer')" class="prayer-link-item">Novena for Cancer</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Catholic Schools')" class="prayer-link-item">Novena for Catholic Schools</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Healing')" class="prayer-link-item">Novena for Healing</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Peace in Ukraine')" class="prayer-link-item">Novena for Peace in Ukraine</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Pilgrims')" class="prayer-link-item">Novena for Pilgrims</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Pope Francis')" class="prayer-link-item">Novena for Pope Francis (or Benedict XVI)</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Priests')" class="prayer-link-item">Novena for Priests</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Prisoners')" class="prayer-link-item">Novena for Prisoners</a>
                        <a href="#" onclick="openPrayer(event, 'Novena For Racial Healing and Reconciliation')" class="prayer-link-item">Novena For Racial Healing and Reconciliation</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Rain')" class="prayer-link-item">Novena for Rain</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Reconciliation in Marriage')" class="prayer-link-item">Novena for Reconciliation in Marriage</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Recovery from Injury')" class="prayer-link-item">Novena for Recovery from Injury</a>
                        <a href="#" onclick="openPrayer(event, 'Novena for Repentance')" class="prayer-link-item">Novena for Repentance</a>
                        <a href="#" onclick="openPrayer(event, 'Novena to the Holy Trinity (Any Time)')" class="prayer-link-item">Novena to the Holy Trinity</a>
                        <a href="#" onclick="openPrayer(event, 'Novena to the Immaculate Heart of Mary (Any Time)')" class="prayer-link-item">Novena to the Immaculate Heart of Mary</a>
                        <a href="#" onclick="openPrayer(event, 'Novena to the Mother of God for the Nation')" class="prayer-link-item">Novena to the Mother of God for the Nation</a>
                        <a href="#" onclick="openPrayer(event, 'Novena to the Risen Jesus')" class="prayer-link-item">Novena to the Risen Jesus</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Africa Novena')" class="prayer-link-item">Our Lady of Africa Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of China Novena')" class="prayer-link-item">Our Lady of China Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Confidence Novena')" class="prayer-link-item">Our Lady of Confidence Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Consolation Novena')" class="prayer-link-item">Our Lady of Consolation Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Czestochowa Novena')" class="prayer-link-item">Our Lady of Czestochowa Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Fatima Novena')" class="prayer-link-item">Our Lady of Fatima Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Graces Novena')" class="prayer-link-item">Our Lady of Graces Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Peace Novena')" class="prayer-link-item">Our Lady of Peace Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Our Lady of Perpetual Help Novena (Any Time)')" class="prayer-link-item">Our Lady of Perpetual Help Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Saints Jacinta and Francisco Marto Novena')" class="prayer-link-item">Saints Jacinta and Francisco Marto Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Abigail Novena')" class="prayer-link-item">St. Abigail Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Agatha Novena')" class="prayer-link-item">St. Agatha Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Augustine Novena')" class="prayer-link-item">St. Augustine Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Dominic Novena')" class="prayer-link-item">St. Dominic Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Faustina Novena')" class="prayer-link-item">St. Faustina Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Francis of Assisi Novena (Any Time)')" class="prayer-link-item">St. Francis of Assisi Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Gennaro (San Gennaro) Novena')" class="prayer-link-item">St. Gennaro (San Gennaro) Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Isidore the Farmer Novena')" class="prayer-link-item">St. Isidore the Farmer Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Jos Luis Snchez del Ro Novena')" class="prayer-link-item">St. Jos Luis Snchez del Ro Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Joseph Holy Cloak Novena')" class="prayer-link-item">St. Joseph Holy Cloak Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Lorenzo Ruiz Novena')" class="prayer-link-item">St. Lorenzo Ruiz Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Louis de Montfort Novena (Any Time)')" class="prayer-link-item">St. Louis de Montfort Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Louis King of France Novena')" class="prayer-link-item">St. Louis King of France Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Madeleine Sophie Barat Novena')" class="prayer-link-item">St. Madeleine Sophie Barat Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Margaret Clitherow Novena')" class="prayer-link-item">St. Margaret Clitherow Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Margaret of Castello Novena')" class="prayer-link-item">St. Margaret of Castello Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Margaret of Cortona Novena')" class="prayer-link-item">St. Margaret of Cortona Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Mark Novena')" class="prayer-link-item">St. Mark Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Mary of Egypt Novena')" class="prayer-link-item">St. Mary of Egypt Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Patrick Novena')" class="prayer-link-item">St. Patrick Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Philomena Novena (Any Time)')" class="prayer-link-item">St. Philomena Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Pio (Padre Pio) Novena')" class="prayer-link-item">St. Pio (Padre Pio) Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Scholastica Novena (Any Time)')" class="prayer-link-item">St. Scholastica Novena</a>
                        <a href="#" onclick="openPrayer(event, 'St. Valentine Novena')" class="prayer-link-item">St. Valentine Novena</a>
                        <a href="#" onclick="openPrayer(event, 'The Novena from the Dominican Shrine of St. Jude Thaddeus')" class="prayer-link-item">The Novena from the Dominican Shrine of St. Jude Thaddeus</a>
                        <a href="#" onclick="openPrayer(event, 'The Novena to St. Maria Goretti')" class="prayer-link-item">The Novena to St. Maria Goretti</a>
                        <a href="#" onclick="openPrayer(event, 'Transfiguration Novena')" class="prayer-link-item">Transfiguration Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Ulma Family Novena')" class="prayer-link-item">Ulma Family Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Venerable Augustus Tolton Novena')" class="prayer-link-item">Venerable Augustus Tolton Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Venerable Marthe Robin Novena')" class="prayer-link-item">Venerable Marthe Robin Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Venerable Patrick Peyton Novena')" class="prayer-link-item">Venerable Patrick Peyton Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Visitation Novena')" class="prayer-link-item">Visitation Novena</a>
                        <a href="#" onclick="openPrayer(event, 'Wedding Novena')" class="prayer-link-item">Wedding Novena</a>
                    </div>
                </section>
            </div>
            `;
        }

        // NEW: Function to generate the full About page content
        function getFullAboutContent() {
            return `
            <div class="space-y-8">
                <!-- Header -->
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">About The Catholic Companion</h2>

                <!-- Introduction from the Editor -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-violet-600" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-violet-700 mb-4">A Message from the Editor</h3>
                    <div class="flex flex-col md:flex-row items-center gap-6">
                        <!-- Placeholder for a photo -->
                        <div class="flex-shrink-0">
                            <div class="w-32 h-32 bg-gray-200 rounded-full flex items-center justify-center text-gray-500 border-2 border-gray-300">
                                <!-- SVG icon as a placeholder for your photo -->
                                <svg class="w-20 h-20" fill="currentColor" viewBox="0 0 20 20"><path d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"></path></svg>
                            </div>
                        </div>
                        <div class="text-gray-700 leading-relaxed">
                            <p class="mb-3">Peace be with you, and welcome to The Catholic Companion.</p>
                            <p class="mb-3">My name is <strong>Fr. Wilson Karugaba</strong>, and I am the owner, editor, and author of the reflections you will find on this website. It is my joy and privilege to offer this digital space as a resource for your daily journey of faith.</p>
                            <p>In our busy world, finding moments for quiet prayer and spiritual nourishment can be a challenge. My hope is that this website serves as a readily accessible companion to guide your prayer life, deepen your understanding of our beautiful Catholic faith, and bring you closer to Christ.</p>
                        </div>
                    </div>
                </section>

                <!-- Our Mission -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-sky-600" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-sky-700 mb-4">Our Mission</h3>
                    <p class="text-gray-700 leading-relaxed"><strong>The Catholic Companion</strong> was created to be a comprehensive, one-stop resource for Catholics seeking to live their faith more fully. Our mission is to provide reliable, reverent, and enriching content that supports prayer, learning, and devotion. Whether you have two minutes or an hour, you will find something here to elevate your heart and mind to God.</p>
                </section>

                <!-- What You Will Find Here -->
                <section class="p-6 rounded-xl shadow-lg border-t-4 border-amber-600" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-amber-700 mb-4">What You Will Find Here</h3>
                    <p class="text-gray-700 leading-relaxed mb-4">This website is a growing treasury of spiritual tools, including:</p>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li><strong>Daily Content:</strong> Start your day with the official Mass Readings, a new Reflection, the Daily Prayer, and an inspirational Verse.</li>
                        <li><strong>Interactive Rosary:</strong> A full-screen, guided Rosary player to help you pray this powerful devotion.</li>
                        <li><strong>Treasury of Prayers & Litanies:</strong> An extensive, categorized collection of traditional Catholic prayers for every need and occasion.</li>
                        <li><strong>Devotions & Novenas:</strong> A comprehensive guide to the Church's rich tradition of devotions and a vast library of novenas organized by start date.</li>
                        <li><strong>Order of Mass:</strong> Follow along with the Mass for any given day, with the proper prayers and readings.</li>
                        <li><strong>Summary of Doctrine:</strong> A clear and concise overview of the fundamental teachings of the Catholic Church.</li>
                        <li><strong>And much more:</strong> Explore resources on the Saints, community prayer requests, and other tools for spiritual growth.</li>
                    </ul>
                </section>

                <!-- Closing Message -->
                <div class="text-center text-gray-600 italic mt-8">
                    <p>Thank you for visiting. May this digital companion be a source of grace and blessing in your life.</p>
                </div>
            </div>
            `;
        }

        // --- NEW FAVORITES PAGE GENERATORS ---
        function getMyFavoritePrayersContent() {
            let contentHtml = '';
            if (user.favorites.prayers.length === 0) {
                contentHtml = `<p class="text-center text-gray-500">You haven't favorited any prayers yet. Click the star icon on a prayer to add it here.</p>`;
            } else {
                contentHtml = user.favorites.prayers.map(prayerName => {
                    const prayerData = allPrayers[prayerName];
                    if (!prayerData) return '';
                    return `<a href="#" onclick="openPrayer(event, '${prayerName.replace(/'/g, "\\'")}')" class="prayer-link-item">${prayerData.title}</a>`;
                }).join('');
            }

            return `
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">My Favourite Prayers</h2>
                <section class="p-6 rounded-xl shadow-lg" style="background-color: var(--color-card-bg);">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        ${contentHtml}
                    </div>
                </section>
            `;
        }

        function getMyFavoriteSaintsContent() {
            let contentHtml = '';
            if (user.favorites.saints.length === 0) {
                contentHtml = `<p class="text-center text-gray-500">You haven't favorited any saints yet. Click the star icon on a saint's page to add them here.</p>`;
            } else {
                contentHtml = user.favorites.saints.map(saintId => {
                    const saint = saintsDB.find(s => s.id === saintId);
                    if (!saint) return '';
                    return `
                        <div class="saint-card flex flex-col">
                            <img src="${saint.imageUrl}" alt="Image of ${saint.name}" class="saint-card-img h-32">
                            <div class="p-4 flex-grow flex flex-col">
                                <h4 class="font-bold text-base text-gray-800">${saint.name}</h4>
                                <p class="text-xs text-gray-500 mb-2">${new Date(2024, saint.month - 1, saint.day).toLocaleDateString('en-US', { month: 'long', day: 'numeric' })}</p>
                                <p class="saint-card-bio text-sm text-gray-600 flex-grow">${saint.bio}</p>
                                <a href="#" onclick="viewSaintDetail('${saint.id}')" class="text-xs font-semibold text-violet-600 hover:text-violet-700 mt-2 self-start">Read More</a>
                            </div>
                        </div>`;
                }).join('');
            }

            return `
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">My Favourite Saints</h2>
                <section class="p-6 rounded-xl shadow-lg" style="background-color: var(--color-card-bg);">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                        ${contentHtml}
                    </div>
                </section>
            `;
        }

        // --- NEW SAINTS PAGE LOGIC ---

        // State for the saints page
        // NEW: Added alphaPage and selectedSaintId for new views
        let saintsPageState = {
            view: 'buttons', // 'buttons', 'alpha', 'calendar', 'saint_detail'
            buttonPage: 0,
            alphaPage: 0,
            selectedSaintId: null,
        };

        // Function to switch views within the saints page
        window.switchSaintsView = function(view) {
            saintsPageState.view = view;
            // We need to get the full content again to re-render
            const info = getLiturgicalInfo(currentlyLoadedDate);
            leftColumn.innerHTML = getFullSaintsContent(info);
        }

        // NEW: Function to view a single saint's details
        window.viewSaintDetail = function(saintId) {
            saintsPageState.view = 'saint_detail';
            saintsPageState.selectedSaintId = saintId;
            const info = getLiturgicalInfo(currentlyLoadedDate);
            leftColumn.innerHTML = getFullSaintsContent(info);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // NEW: Favorite Saint Logic
        function toggleFavoriteSaint(saintId) {
            if (!saintId) return;
            const index = user.favorites.saints.indexOf(saintId);
            if (index > -1) {
                user.favorites.saints.splice(index, 1);
                showToast("Removed from favorite saints.");
            } else {
                user.favorites.saints.push(saintId);
                showToast("Added to favorite saints.");
            }
            // Re-render the detail view to update the button
            const info = getLiturgicalInfo(currentlyLoadedDate);
            leftColumn.innerHTML = getFullSaintsContent(info);
        }


        // Main function to generate the saints page content
        function getFullSaintsContent(info) {
            let viewContent = '';
            // NEW: Added 'saint_detail' view and handling for it
            if (saintsPageState.view === 'buttons') {
                viewContent = getSaintsButtonView(info);
            } else if (saintsPageState.view === 'alpha') {
                viewContent = getSaintsAlphabeticalView();
            } else if (saintsPageState.view === 'saint_detail') {
                // Find the saint from the database
                const saint = saintsDB.find(s => s.id === saintsPageState.selectedSaintId);
                viewContent = getSaintDetailView(saint);
            } else if (saintsPageState.view === 'calendar') {
                viewContent = getSaintsCalendarView();
            }

            return `
            <div class="space-y-6">
                <!-- Header and Controls -->
                <div class="flex flex-col sm:flex-row items-center justify-between gap-4 saints-header-controls">
                    <h2 class="text-2xl font-bold text-gray-800">Saints</h2>
                    
                    <!-- Search Bar -->
                    <div class="relative flex-grow w-full sm:w-auto flex items-center">
                        <input id="saints-search-input" type="search" placeholder="Search for a saint..." class="w-full py-2 pl-10 pr-10 text-sm border border-gray-300 rounded-lg focus:ring-violet-500 focus:border-violet-500">
                        <div class="absolute inset-y-0 left-0 flex items-center pl-3">
                            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                        </div>
                        <button onclick="performSearch('saints-search-input')" class="absolute inset-y-0 right-0 flex items-center pr-3" aria-label="Search">
                            <svg class="w-5 h-5 text-gray-500 hover:text-violet-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path></svg>
                        </button>
                    </div>

                    <!-- View Switcher -->
                    <div class="flex items-center gap-2">
                        <button onclick="switchSaintsView('buttons')" class="saints-control-btn ${saintsPageState.view === 'buttons' ? 'active' : ''}" aria-label="Home View">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg>
                        </button>
                        <button onclick="switchSaintsView('calendar')" class="saints-control-btn ${saintsPageState.view === 'calendar' ? 'active' : ''}" aria-label="Calendar View">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path></svg>
                        </button>
                        <!-- NEW: Improved Alphabetical Icon -->
                        <button onclick="switchSaintsView('alpha')" class="saints-control-btn flex items-center gap-1 ${saintsPageState.view === 'alpha' ? 'active' : ''}" aria-label="Alphabetical View">
                            <span class="font-bold text-xs">A-Z</span>
                        </button>
                    </div>
                </div>

                <!-- Dynamic View Content -->
                <div id="saints-view-content">
                    ${viewContent}
                </div>
            </div>
            `;
        }

        // NEW: Pagination handler for the saints button view
        window.changeSaintsButtonPage = function(newPage) {
            const totalPages = Math.ceil((saintsDB.length - 1) / 10); // 10 previous saints per page
            if (newPage >= 0 && newPage < totalPages) {
                saintsPageState.buttonPage = newPage;
                switchSaintsView('buttons');
            }
        }

        function getSaintsButtonView(info) {
            const today = new Date();
            const todayMonth = today.getMonth() + 1;
            const todayDay = today.getDate();

            // Find today's saint(s) - This is now correct
            const saintsOfTheDay = saintsDB.filter(s => s.month === todayMonth && s.day === todayDay)
            const saintOfTheDay = saintsOfTheDay.length > 0 ? saintsOfTheDay[0] : saintsDB.find(s => s.id === 'no_saint_today'); // Fallback to a generic entry

            // Get all other saints and sort them by date descending
            const previousSaintsAll = saintsDB
                .filter(s => new Date(today.getFullYear(), s.month - 1, s.day) < new Date(today.getFullYear(), today.getMonth(), today.getDate()))
                .sort((a, b) => {
                    const dateA = new Date(2024, a.month - 1, a.day);
                    const dateB = new Date(2024, b.month - 1, b.day);
                    return dateB - dateA; // Sort by most recent date first
                });

            // Pagination logic
            const itemsPerPage = 10;
            const currentPage = saintsPageState.buttonPage;
            const startIndex = currentPage * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const previousSaints = previousSaintsAll.slice(startIndex, endIndex);
            const totalPages = Math.ceil(previousSaintsAll.length / itemsPerPage);

            let previousSaintsHtml = previousSaints.map(saint => `
                <div class="saint-card flex flex-col">
                    <img src="${saint.imageUrl}" alt="Image of ${saint.name}" class="saint-card-img h-32">
                    <div class="p-4 flex-grow flex flex-col">
                        <h4 class="font-bold text-base text-gray-800">${saint.name}</h4>
                        <p class="text-xs text-gray-500 mb-2">${new Date(2024, saint.month - 1, saint.day).toLocaleDateString('en-US', { month: 'long', day: 'numeric' })}</p>
                        <p class="saint-card-bio text-sm text-gray-600 flex-grow">${saint.bio}</p>
                        <a href="#" onclick="viewSaintDetail('${saint.id}')" class="text-xs font-semibold text-violet-600 hover:text-violet-700 mt-2 self-start">Read More</a>
                    </div>
                </div>
            `).join('');

            return `
                <!-- Saint of the Day Main Card -->
                <section class="mb-8">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">Saint of the Day</h3>
                    <div class="saint-card grid grid-cols-1 md:grid-cols-3 gap-0 md:gap-6">
                        <div class="md:col-span-1">
                            <img src="${saintOfTheDay.imageUrl}" alt="Image of ${saintOfTheDay.name}" class="saint-card-img h-64 md:h-full rounded-t-xl md:rounded-l-xl md:rounded-t-none">
                        </div>
                        <div class="md:col-span-2 p-6 flex flex-col justify-center">
                            <h3 class="text-2xl font-bold text-violet-700">${saintOfTheDay.name}</h3>
                            <p class="text-sm text-gray-500 mb-3">${new Date(2024, saintOfTheDay.month - 1, saintOfTheDay.day).toLocaleDateString('en-US', { month: 'long', day: 'numeric' })}</p>
                            <p class="text-base text-gray-700 leading-relaxed mb-4">
                                ${saintOfTheDay.bio.split(' ').slice(0, 30).join(' ')}...
                            </p>
                            <a href="#" onclick="viewSaintDetail('${saintOfTheDay.id}')" class="text-sm font-semibold text-violet-600 hover:text-violet-700 self-start">
                                Read Full Biography &rarr;
                            </a>
                        </div>
                    </div>
                </section>

                <!-- Previous Saints -->
                <section>
                    <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">Previous Saints</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                        ${previousSaintsHtml}
                    </div>
                </section>

                <!-- NEW: Functional Pagination -->
                ${generatePaginationControls(currentPage, totalPages, 'changeSaintsButtonPage')}
            `;
        }

        // NEW: Function to generate pagination controls dynamically
        function generatePaginationControls(currentPage, totalPages, changePageFnName) {
            let pagesHtml = '';
            // Logic to show a limited number of page links (e.g., first, last, current, and neighbors)
            const pageLinksToShow = 5;
            let startPage = Math.max(0, currentPage - Math.floor(pageLinksToShow / 2));
            let endPage = Math.min(totalPages - 1, startPage + pageLinksToShow - 1);
            if (endPage - startPage + 1 < pageLinksToShow) {
                startPage = Math.max(0, endPage - pageLinksToShow + 1);
            }

            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentPage;
                pagesHtml += `<a href="#" onclick="${changePageFnName}(${i})" class="${isActive ? 'bg-blue-50 border-blue-500 text-blue-600' : 'border-gray-300 text-gray-500 hover:bg-gray-50'} relative inline-flex items-center px-4 py-2 border text-sm font-medium"> ${i + 1} </a>`;
            }

            return `
            <nav class="flex items-center justify-between border-t border-gray-200 px-4 sm:px-0 mt-8 pt-4">
                <div class="flex-1 flex justify-start">
                    <a href="#" onclick="${changePageFnName}(${currentPage - 1})" class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 ${currentPage === 0 ? 'opacity-50 cursor-not-allowed' : ''}"> Previous </a>
                </div>
                <div class="hidden md:flex">
                    ${startPage > 0 ? `<span class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700">...</span>` : ''}
                    ${pagesHtml}
                    ${endPage < totalPages - 1 ? `<span class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700">...</span>` : ''}
                </div>
                <div class="flex-1 flex justify-end">
                    <a href="#" onclick="${changePageFnName}(${currentPage + 1})" class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 ${currentPage >= totalPages - 1 ? 'opacity-50 cursor-not-allowed' : ''}"> Next </a>
                </div>
            </nav>
            `;
        }

        // NEW: View for a single saint's details
        function getSaintDetailView(saint) {
            if (!saint) {
                return `<p class="text-center text-red-500">Could not find the requested saint. Please go back and try again.</p>`;
            }
            const isFavorite = user.favorites.saints.includes(saint.id);

            return `
                <div class="p-6 rounded-xl shadow-lg" style="background-color: var(--color-card-bg);">
                    <!-- Back Button -->
                    <div class="flex justify-between items-center mb-4">
                        <a href="#" onclick="switchSaintsView('buttons')" class="flex items-center text-sm font-semibold text-gray-600 hover:text-gray-800 transition">
                            <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                            Back to Saints List
                        </a>
                        <button onclick="toggleFavoriteSaint('${saint.id}')" class="flex items-center text-sm font-semibold ${isFavorite ? 'text-yellow-500' : 'text-gray-600'} hover:text-yellow-500 transition">
                            <svg class="w-5 h-5 mr-2" fill="${isFavorite ? 'currentColor' : 'none'}" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.539 1.118l-3.975-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.196-1.539-1.118l1.518-4.674a1 1 0 00-.363-1.118L2.05 10.1c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg>
                            ${isFavorite ? 'Favorited' : 'Add to Favorites'}
                        </button>
                    </div>

                    <div class="text-center mb-6">
                        <h2 class="text-3xl font-bold text-violet-700">${saint.name}</h2>
                        <p class="text-base text-gray-500 mt-1">${new Date(2024, saint.month - 1, saint.day).toLocaleDateString('en-US', { month: 'long', day: 'numeric' })}</p>
                        <p class="text-sm font-semibold text-gray-600 mt-1">${saint.rank}</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div class="md:col-span-1">
                            <img src="${saint.imageUrl}" alt="Image of ${saint.name}" class="w-full h-auto object-cover rounded-lg shadow-md">
                        </div>
                        <div class="md:col-span-2">
                            <h3 class="text-xl font-bold text-gray-800 mb-2">Biography</h3>
                            <p class="text-base text-gray-700 leading-relaxed whitespace-pre-line">${saint.bio}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        // NEW: Pagination handler for the alphabetical view
        window.changeSaintsAlphaPage = function(newPage) {
            const totalPages = Math.ceil(saintsDB.length / 10); // 10 saints per page
            if (newPage >= 0 && newPage < totalPages) {
                saintsPageState.alphaPage = newPage;
                switchSaintsView('alpha');
            }
        }

        function getSaintsAlphabeticalView() {
            const sortedSaints = [...saintsDB].sort((a, b) => a.name.localeCompare(b.name));

            // Pagination logic
            const itemsPerPage = 10;
            const currentPage = saintsPageState.alphaPage;
            const startIndex = currentPage * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const saintsOnPage = sortedSaints.slice(startIndex, endIndex);
            const totalPages = Math.ceil(sortedSaints.length / itemsPerPage);

            let saintsHtml = saintsOnPage.map(saint => `
                <div class="saint-card flex flex-col">
                    <img src="${saint.imageUrl}" alt="Image of ${saint.name}" class="saint-card-img h-32">
                    <div class="p-4 flex-grow flex flex-col">
                        <h4 class="font-bold text-base text-gray-800">${saint.name}</h4>
                        <p class="text-xs text-gray-500 mb-2">${new Date(2024, saint.month - 1, saint.day).toLocaleDateString('en-US', { month: 'long', day: 'numeric' })}</p>
                        <p class="saint-card-bio text-sm text-gray-600 flex-grow">${saint.bio}</p>
                        <a href="#" onclick="viewSaintDetail('${saint.id}')" class="text-xs font-semibold text-violet-600 hover:text-violet-700 mt-2 self-start">Read More</a>
                    </div>
                </div>
            `).join('');

            return `
                <section>
                    <h3 class="text-2xl font-bold text-gray-800 mb-4 text-center">Saints - Alphabetical</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                        ${saintsHtml}
                    </div>
                    ${generatePaginationControls(currentPage, totalPages, 'changeSaintsAlphaPage')}
                </section>
            `;
        }

        // NEW: Calendar month change handler
        window.changeSaintsCalendarMonth = function(offset) {
            const newDate = new Date(saintsPageState.calendarYear, saintsPageState.calendarMonth + offset, 1);
            saintsPageState.calendarMonth = newDate.getMonth();
            saintsPageState.calendarYear = newDate.getFullYear();
            switchSaintsView('calendar');
        }

        function getSaintsCalendarView() {
            const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            const { calendarYear, calendarMonth } = saintsPageState;
            const firstDay = new Date(calendarYear, calendarMonth, 1).getDay();
            const daysInMonth = new Date(calendarYear, calendarMonth + 1, 0).getDate();

            let daysHtml = '';
            // Blank days
            for (let i = 0; i < firstDay; i++) {
                daysHtml += '<div></div>';
            }
            // Calendar days
            for (let i = 1; i <= daysInMonth; i++) {
                // NEW: Find saints for this day from the database
                const saintsOnDay = saintsDB.filter(s => s.month === calendarMonth + 1 && s.day === i);
                let saintsLinks = saintsOnDay.map(saint =>
                    `<a href="#" onclick="viewSaintDetail('${saint.id}')" class="text-xs text-blue-600 hover:underline block">${saint.name}</a>`
                ).join('');

                daysHtml += `
                    <div class="border-t border-l border-gray-200 p-2 min-h-[7rem] flex flex-col">
                        <span class="font-semibold text-gray-800">${i}</span>
                        <div class="mt-1 space-y-0.5">${saintsLinks}</div>
                    </div>
                `;
            }

            return `
                <section class="p-6 rounded-xl shadow-lg" style="background-color: var(--color-card-bg);">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4 text-center">Saint of the Day Calendar</h3>
                    
                    <!-- Calendar Header -->
                    <div class="flex items-center justify-between mb-4">
                        <button onclick="changeSaintsCalendarMonth(-1)" class="p-2 rounded-full hover:bg-gray-100" aria-label="Previous Month">&lt;</button>
                        <span class="text-lg font-semibold">${monthNames[calendarMonth]} ${calendarYear}</span>
                        <button onclick="changeSaintsCalendarMonth(1)" class="p-2 rounded-full hover:bg-gray-100" aria-label="Next Month">&gt;</button>
                    </div>

                    <!-- Calendar Grid -->
                    <div class="grid grid-cols-7 text-center text-sm font-medium text-gray-500 border-b">
                        <div class="py-2">Sun</div><div class="py-2">Mon</div><div class="py-2">Tue</div><div class="py-2">Wed</div><div class="py-2">Thu</div><div class="py-2">Fri</div><div class="py-2">Sat</div>
                    </div>
                    <div class="grid grid-cols-7">
                        ${daysHtml}
                    </div>
                </section>
            `;
        }

        // NEW: Admin Dashboard Content
        function getAdminDashboardContent() {
            // This is a static mock-up
            return `
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">Administrator Dashboard</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="p-6 rounded-xl shadow-lg text-center" style="background-color: var(--color-card-bg);">
                        <h4 class="text-lg font-semibold text-gray-500">Total Users</h4>
                        <p class="text-4xl font-bold text-blue-600">1,234</p>
                    </div>
                    <div class="p-6 rounded-xl shadow-lg text-center" style="background-color: var(--color-card-bg);">
                        <h4 class="text-lg font-semibold text-gray-500">Active Subscriptions</h4>
                        <p class="text-4xl font-bold text-green-600">567</p>
                    </div>
                    <div class="p-6 rounded-xl shadow-lg text-center" style="background-color: var(--color-card-bg);">
                        <h4 class="text-lg font-semibold text-gray-500">Daily Active Users</h4>
                        <p class="text-4xl font-bold text-yellow-600">450</p>
                    </div>
                </div>
                <div class="mt-8 p-6 rounded-xl shadow-lg" style="background-color: var(--color-card-bg);">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Users by Country (Top 5)</h3>
                    <ul class="space-y-2 text-gray-700">
                        <li class="flex justify-between"><span>Uganda</span><span class="font-semibold">450</span></li>
                        <li class="flex justify-between"><span>United States</span><span class="font-semibold">210</span></li>
                        <li class="flex justify-between"><span>Philippines</span><span class="font-semibold">150</span></li>
                        <li class="flex justify-between"><span>Nigeria</span><span class="font-semibold">95</span></li>
                        <li class="flex justify-between"><span>United Kingdom</span><span class="font-semibold">88</span></li>
                    </ul>
                </div>
                <div class="mt-8 p-6 rounded-xl shadow-lg" style="background-color: var(--color-card-bg);">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Recent Sign-ups</h3>
                    <p class="text-gray-500">A table of recent users would appear here in a full implementation.</p>
                </div>
            `;
        }

        // NEW: Comprehensive Saints Database
        // The large, hardcoded saintsDB array has been removed.
        // It will now be populated from Firebase.

        // --- END SAINTS PAGE LOGIC ---

    </script>
</body>
</html>